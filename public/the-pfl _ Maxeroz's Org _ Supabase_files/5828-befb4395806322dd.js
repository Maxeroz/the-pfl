"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5828],{82366:function(e,s,t){t.d(s,{h:function(){return u}});var a=t(52322),n=t(28879),i=t.n(n),r=t(4787),l=t(31310),o=t(26198),d=t(49251),c=t(750),u=e=>{let{selectedLog:s,onClose:t}=e,{data:n}=(0,o.Sy)(),{data:u}=(0,l.tl)();return null==n||n.find(e=>e.ref===(null==s?void 0:s.target.metadata.project_ref)),null==u||u.find(e=>e.slug===(null==s?void 0:s.target.metadata.org_slug)),(0,a.jsxs)(d.ZP,{size:"large",header:'"'.concat(null==s?void 0:s.action.name,'" on ').concat(i()(null==s?void 0:s.occurred_at).format("DD MMM YYYY, HH:mm:ss")),visible:void 0!==s,onCancel:t,cancelText:"Close",children:[(0,a.jsx)(r.hj,{header:(0,a.jsx)(r.S0,{children:"General"}),children:(0,a.jsx)(r.B4,{loading:!1,children:(0,a.jsx)(c.Z,{readOnly:!0,size:"small",label:"Occurred at",value:null==s?void 0:s.occurred_at,descriptionText:i()(null==s?void 0:s.occurred_at).format("DD MMM YYYY, HH:mm:ss (ZZ)")})})}),(0,a.jsx)(d.ZP.Separator,{}),(0,a.jsx)(r.hj,{header:(0,a.jsx)(r.S0,{children:"Actor"}),children:(0,a.jsxs)(r.B4,{loading:!1,children:[(0,a.jsx)(c.Z,{readOnly:!0,size:"small",label:"Actor ID",value:null==s?void 0:s.actor.id}),(0,a.jsx)(c.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==s?void 0:s.actor.metadata,null,2)})]})}),(0,a.jsx)(d.ZP.Separator,{}),(0,a.jsx)(r.hj,{header:(0,a.jsx)(r.S0,{children:"Action"}),children:(0,a.jsxs)(r.B4,{loading:!1,children:[(0,a.jsx)(c.Z,{readOnly:!0,size:"small",label:"Name",value:null==s?void 0:s.action.name}),(0,a.jsx)(c.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==s?void 0:s.action.metadata,null,2)})]})}),(0,a.jsx)(d.ZP.Separator,{}),(0,a.jsx)(r.hj,{header:(0,a.jsx)(r.S0,{children:"Target"}),children:(0,a.jsxs)(r.B4,{loading:!1,children:[(0,a.jsx)(c.Z,{readOnly:!0,size:"small",label:"Name",value:null==s?void 0:s.target.description}),(0,a.jsx)(c.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==s?void 0:s.target.metadata,null,2)})]})})]})}},46216:function(e,s,t){var a=t(52322),n=t(39097),i=t.n(n),r=t(84605),l=t(61531),o=t(26198),d=t(93463);s.Z=e=>{var s;let{organization:t}=e,{data:n}=(0,o.Sy)({}),c=null!==(s=null==n?void 0:n.filter(e=>e.organization_id===(null==t?void 0:t.id)).length)&&void 0!==s?s:0,{data:u}=(0,d.G)({orgSlug:null==t?void 0:t.slug});return c>0||(null==u?void 0:u.plan)===void 0||"free"===u.plan.id||"enterprise"===u.plan.id?null:(0,a.jsx)(l.Z,{defaultVisibility:!0,hideCollapse:!0,title:"Your organization is on the ".concat(u.plan.name," plan with no projects running"),icon:(0,a.jsx)(r.Z,{strokeWidth:2}),description:(0,a.jsxs)("div",{children:["The monthly fees for the paid plan still apply. To cancel your subscription, head over to your"," ",(0,a.jsx)(i(),{href:"/org/".concat(null==t?void 0:t.slug,"/billing"),className:"text-sm text-green-900 transition hover:text-green-1000",children:"organization billing settings ."})]})})}},43544:function(e,s,t){t.d(s,{Z:function(){return b}});var a=t(52322),n=t(12333),i=t(66432),r=t(83765),l=t(6659),o=t(2784),d=t(62202),c=t(83690),u=t(48228),m=t(31696);async function h(e){let{slug:s,hcaptchaToken:t}=e,{data:a,error:n}=await (0,m.v_)("/platform/organizations/{slug}/payments/setup-intent",{params:{path:{slug:s}},body:{hcaptchaToken:t}});return n&&(0,m.S3)(n),a}let p=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.D)(e=>h(e),{async onSuccess(s,t,a){await (null==e?void 0:e(s,t,a))},async onError(e,t,a){void 0===s?d.Am.error("Failed to setup intent: ".concat(e.message)):s(e,t,a)},...t})};var x=t(89823),g=t(99248),j=t(30242),v=t(32079),f=e=>{let{returnUrl:s,onCancel:t,onConfirm:n}=e,r=(0,i.useStripe)(),l=(0,i.useElements)(),[u,m]=(0,o.useState)(!1),h=async e=>{if(e.preventDefault(),!r||!l){console.error("Stripe.js has not loaded");return}m(!0),void 0!==document&&document.body.classList.add("!pointer-events-auto");let{error:t}=await r.confirmSetup({elements:l,redirect:"if_required",confirmParams:{return_url:s}});if(t){var a;m(!1),d.ZP.error(null!==(a=null==t?void 0:t.message)&&void 0!==a?a:" Failed to save card details")}else m(!1),n();void 0!==document&&document.body.classList.remove("!pointer-events-auto")};return(0,a.jsxs)("form",{onSubmit:h,children:[(0,a.jsx)(c.Z.Content,{className:"transition ".concat(u?"pointer-events-none opacity-75":"opacity-100"),children:(0,a.jsx)(i.PaymentElement,{className:"[.p-LinkAutofillPrompt]:pt-0"})}),(0,a.jsx)(c.Z.Separator,{}),(0,a.jsxs)(c.Z.Content,{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.z,{htmlType:"button",size:"small",type:"default",onClick:t,block:!0,disabled:u,children:"Cancel"}),(0,a.jsx)(v.z,{block:!0,htmlType:"submit",size:"small",type:"primary",loading:u,disabled:u,children:"Add payment method"})]})]})};let y=(0,r.J)(g.Yw);var b=e=>{let{visible:s,returnUrl:t,onCancel:r,onConfirm:u}=e,{resolvedTheme:m}=(0,l.F)(),[h,g]=(0,o.useState)(),v=(0,x.l)(),b=(0,j.Y)(),[N,w]=(0,o.useState)(null),[S,_]=(0,o.useState)(null),{mutate:C}=p({onSuccess:e=>{g(e)},onError:e=>{d.ZP.error("Failed to setup intent: ".concat(e.message))}}),Z=(0,o.useCallback)(e=>{_(e)},[]);(0,o.useEffect)(()=>{let e=async e=>{let s=null==v?void 0:v.slug;return s?e?void(g(void 0),C({slug:s,hcaptchaToken:e})):console.error("HCaptcha token required"):console.error("Slug is required")};(async()=>{if(s&&S&&b){let s=N;try{if(!s){var t;let e=await S.execute({async:!0});s=null!==(t=null==e?void 0:e.response)&&void 0!==t?t:null}}catch(e){return}await e(null!=s?s:void 0),I()}})()},[s,S,b]);let I=()=>{w(null),null==S||S.resetCaptcha()},A={clientSecret:h?h.client_secret:"",appearance:{theme:(null==m?void 0:m.includes("dark"))?"night":"flat",labels:"floating"}},z=()=>(g(void 0),r());return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Z,{ref:Z,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{z(),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{w(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{w(null)}}),(0,a.jsx)(c.Z,{hideFooter:!0,size:"medium",visible:s&&void 0!==h,header:"Add new payment method",onCancel:z,className:"PAYMENT",children:(0,a.jsx)(i.Elements,{stripe:y,options:A,children:(0,a.jsx)(f,{returnUrl:t,onCancel:z,onConfirm:()=>(g(void 0),u())})})})]})}},2320:function(e,s,t){var a=t(52322),n=t(2322);s.Z=e=>{let{projectUpdateDisabled:s,projectNotActive:t=!1,children:i,tooltip:r}=e;return(0,a.jsxs)(n.u,{children:[(0,a.jsx)(n.aJ,{asChild:!0,children:i}),s&&(0,a.jsx)(n._v,{side:"bottom",className:"w-72 text-center",children:s?r||"Subscription changes are currently disabled. Our engineers are working on a fix.":t?"Unable to update subscription as project is currently not active":""})]})}},41421:function(e,s,t){var a=t(52322),n=t(59491),i=t(90488);let r=e=>{let{description:s,hasReadScope:t,hasWriteScope:n}=e;if(t||n){let e=[t?"Read":null,n?"Write":null].filter(Boolean).map(e=>(0,a.jsx)("span",{className:"font-semibold text-foreground",children:e},e)).reduce((e,s)=>(0,a.jsxs)(a.Fragment,{children:[e,(0,a.jsx)("span",{children:" and "}),s]}));return(0,a.jsxs)("div",{className:"first:border-t border-b flex flex-row space-x-1 text-sm text-foreground-light py-2 px-1",children:[(0,a.jsx)("div",{className:"pt-0.5",children:(0,a.jsx)(i.Z,{stroke:"green",height:18,width:18,strokeWidth:1.5})}),(0,a.jsxs)("div",{children:[e," ",s]})]})}return null};s.Z=e=>{let{icon:s,name:t,domain:i,scopes:l}=e;return(0,a.jsxs)("div",{className:"flex gap-y-4 flex-col",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-x-4 items-center",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-center bg-no-repeat bg-cover flex items-center justify-center rounded-md border border-control",style:{backgroundImage:s?"url('".concat(s,"')"):"none"},children:!s&&(0,a.jsx)("p",{className:"text-foreground-light text-lg",children:t[0]})})}),(0,a.jsxs)("p",{className:"text-foreground",children:[t," (",i,") is requesting API access to an organization."]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"Permissions"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following scopes will apply for the"," ",(0,a.jsx)("span",{className:"text-amber-900",children:"selected organization and all of its projects."})]}),(0,a.jsxs)("div",{className:"pt-2",children:[(0,a.jsx)(r,{description:"access to auth configurations and SSO providers.",hasReadScope:l.includes(n.YX.AUTH_READ),hasWriteScope:l.includes(n.YX.AUTH_WRITE)}),(0,a.jsx)(r,{description:"access to Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",hasReadScope:l.includes(n.YX.DATABASE_READ),hasWriteScope:l.includes(n.YX.DATABASE_WRITE)}),(0,a.jsx)(r,{description:"access to custom domains and vanity subdomains.",hasReadScope:l.includes(n.YX.DOMAINS_READ),hasWriteScope:l.includes(n.YX.DOMAINS_WRITE)}),(0,a.jsx)(r,{description:"access to edge functions.",hasReadScope:l.includes(n.YX.EDGE_FUNCTIONS_READ),hasWriteScope:l.includes(n.YX.EDGE_FUNCTIONS_WRITE)}),(0,a.jsx)(r,{description:"access to environments/branches.",hasReadScope:l.includes(n.YX.ENVIRONMENT_READ),hasWriteScope:l.includes(n.YX.ENVIRONMENT_WRITE)}),(0,a.jsx)(r,{description:"access to the organization and all its members.",hasReadScope:l.includes(n.YX.ORGANIZATIONS_READ),hasWriteScope:l.includes(n.YX.ORGANIZATIONS_WRITE)}),(0,a.jsx)(r,{description:"access to metadata, its upgrade status, network restrictions and network bans.",hasReadScope:l.includes(n.YX.PROJECTS_READ),hasWriteScope:l.includes(n.YX.PROJECTS_WRITE)}),(0,a.jsx)(r,{description:"access to PostgREST configurations.",hasReadScope:l.includes(n.YX.REST_READ),hasWriteScope:l.includes(n.YX.REST_WRITE)}),(0,a.jsx)(r,{description:"access to API keys, secrets and pgsodium configurations.",hasReadScope:l.includes(n.YX.SECRETS_READ),hasWriteScope:l.includes(n.YX.SECRETS_WRITE)}),(0,a.jsx)(r,{description:"access to storage buckets and files.",hasReadScope:l.includes(n.YX.STORAGE_READ),hasWriteScope:l.includes(n.YX.STORAGE_WRITE)})]})]})]})}},65828:function(e,s,t){t.d(s,{yV:function(){return al},IV:function(){return sW},d2:function(){return nG},q$:function(){return s2},iB:function(){return tn},ny:function(){return tx},G3:function(){return tw},ZI:function(){return aV},cN:function(){return nO},l1:function(){return t0}});var a,n,i=t(52322),r=t(99959),l=t(74178),o=t(40654),d=t(93463),c=t(59491),u=t(2784),m=t(62202),h=t(56006),p=t(6554),x=t(67873),g=t(4787),j=t(14782),v=t(41679),f=t(36492),y=t(31696),b=t(87175),N=t(91160);async function w(e,s){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:a,error:n}=await (0,y.U2)("/platform/organizations/{slug}/customer",{params:{path:{slug:t}},signal:s});return n&&(0,y.S3)(n),a}let S=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,b.Xo)(c.KA.BILLING_READ,"stripe.customer");return(0,f.a)(N.O.customerProfile(s),e=>{let{signal:t}=e;return w({slug:s},t)},{enabled:t&&n&&void 0!==s,...a})};var _=t(85945),C=t(48228);async function Z(e){let{slug:s,address:t}=e;if(!s)return console.error("Slug is required");let{data:a,error:n}=await (0,y.gz)("/platform/organizations/{slug}/customer",{params:{path:{slug:s}},body:{address:t}});if(n)throw(0,y.S3)(n);return a}let I=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>Z(e),{async onSuccess(s,t,n){let{address:i,slug:r}=t;a.setQueriesData(N.O.customerProfile(r),e=>e?{...e,address:i}:e),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update customer profile: ".concat(e.message)):s(e,t,a)},...t})};var A=t(62277),z=t(750),E=t(62284);let k=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}];var T=()=>{var e;let{slug:s}=(0,r.UO)(),t=(0,b.Xo)(c.KA.BILLING_READ,"stripe.customer"),a=(0,b.Xo)(c.KA.BILLING_WRITE,"stripe.customer"),{data:n,error:o,isLoading:d,isSuccess:f,isError:y}=S({slug:s},{enabled:t}),{mutate:N,isLoading:w}=I(),_="billing-address-form",{city:C,country:Z,line1:T,line2:P,postal_code:O,state:R}=null!==(e=null==n?void 0:n.address)&&void 0!==e?e:{},L=async(e,t)=>{let{resetForm:a}=t;if(!s)return console.error("Slug is required");N({slug:s,address:e.line1?e:null},{onSuccess:()=>{m.ZP.success("Successfully updated billing address"),a({values:e,initialValues:e})}})};return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Address"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"This will be reflected in every upcoming invoice, past invoices are not affected"})]})}),(0,i.jsx)(l.Lc,{children:t?(0,i.jsxs)(i.Fragment,{children:[d&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),y&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve organization customer profile",error:o}),f&&(0,i.jsx)(A.Z,{validateOnBlur:!0,id:_,initialValues:{city:C,country:Z,line1:T,line2:P,postal_code:O,state:R},validate:e=>{let s={};return(e.line1||e.line2||e.postal_code||e.state||e.city)&&!e.country&&(s.country="Please select a country"),(e.country||e.line2||e.postal_code||e.state||e.city)&&!e.line1&&(s.line1="Please provide an address line"),s},onSubmit:L,children:e=>{let{values:s,initialValues:t,handleReset:r,resetForm:l}=e,o=JSON.stringify(s)!==JSON.stringify(t);return(0,u.useEffect)(()=>{if(f&&void 0!==n){var e;let{city:s,country:t,line1:a,line2:i,postal_code:r,state:o}=null!==(e=null==n?void 0:n.address)&&void 0!==e?e:{},d={city:s,country:t,line1:a,line2:i,postal_code:r,state:o};l({values:d,initialValues:d})}},[f]),(0,i.jsx)(x.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(p.i,{form:_,isSubmitting:w,hasChanges:o,handleReset:r,helper:a?void 0:"You need additional permissions to manage this organization's billing address"})}),children:(0,i.jsx)(g.hj,{children:(0,i.jsxs)(g.B4,{fullWidth:!0,loading:!1,className:"!gap-2",children:[(0,i.jsx)(z.Z,{id:"line1",name:"line1",placeholder:"Address line 1",disabled:!a}),(0,i.jsx)(z.Z,{id:"line2",name:"line2",placeholder:"Address line 2",disabled:!a}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsxs)(E.Z,{className:"w-full",id:"country",name:"country",placeholder:"Country",disabled:!a,children:[(0,i.jsx)(E.Z.Option,{label:"---",value:"",children:"---"},"empty"),k.map(e=>(0,i.jsx)(E.Z.Option,{label:e.name,value:e.code,children:e.name},e.code))]}),(0,i.jsx)(z.Z,{className:"w-full",id:"postal_code",name:"postal_code",placeholder:"Postal code",disabled:!a})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)(z.Z,{className:"w-full",id:"city",name:"city",placeholder:"City",disabled:!a}),(0,i.jsx)(z.Z,{className:"w-full",id:"state",name:"state",placeholder:"State",disabled:!a})]})]})})})}})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's billing address"})})]})},P=t(28879),O=t.n(P),R=t(39097),L=t.n(R),D=t(6277),M=t(17436);async function U(e,s){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{data:a,error:n}=await (0,y.U2)("/platform/organizations/{slug}/billing/invoices/upcoming",{params:{path:{slug:t}},headers:{Version:"2"},signal:s});return n&&(0,y.S3)(n),a}let F=function(e){let{orgSlug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(M.Y.orgUpcomingPreview(s),e=>{let{signal:t}=e;return U({orgSlug:s},t)},{enabled:t&&void 0!==s,...a})};var Y=t(32079),G=t(11992),B=t(52905),V=t(84605),q=t(24990),W=t(86418);let H=[W.tk.DATABASE_SIZE,W.tk.EGRESS,W.tk.STORAGE_SIZE],X=(e,s)=>{if(s.hours)return s.usage.toLocaleString()+" ("+Math.round(s.usage/s.hours).toLocaleString()+"x"+s.hours.toLocaleString()+" hours)";if(!H.includes(e))return s.usage.toLocaleString();{let e=+(s.usage/1e9).toFixed(2).toLocaleString();return s.usage>0&&0===e?"<0.01":e}},K=e=>H.includes(e)?"GB":e.startsWith("COMPUTE_HOURS")||[W.tk.CUSTOM_DOMAIN,W.tk.IPV4,W.tk.PITR_7,W.tk.PITR_14,W.tk.PITR_28].includes(e)?"Hours":null,Q=(e,s)=>{let t=["Current plan limits are not enough for me","I want better customer support from Supabase","I am migrating from a previous project"];return void 0===e||void 0===s||("free"===e&&"pro"===s?(t.push("Need more compute"),t.push("I want access to additional features like branching, daily backups, custom domain and PITR")):"team"===s&&t.push("I want access to SOC2 and HIPAA compliance")),t.push("None of the above"),t};var J=t(82955);let $=[{identifier:"COMPUTE",text:"Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#usage-based-billing-for-compute"}],ee=e=>{let{text:s,linkRef:t}=e;return(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{children:(0,i.jsx)(V.Z,{size:12,strokeWidth:2})}),(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:(0,i.jsxs)("p",{children:[s," ",t&&(0,i.jsx)(L(),{href:t,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})})})]})})]})};var es=e=>{var s,t;let{slug:a}=e,{data:n,error:r,isLoading:l,isError:o,isSuccess:d}=F({orgSlug:a}),[c,m]=(0,u.useState)([]),p=(0,u.useMemo)(()=>((null==n?void 0:n.lines)||[]).find(e=>e.description.startsWith("Compute Credits")),[n]),x=(0,u.useMemo)(()=>((null==n?void 0:n.lines)||[]).filter(e=>e!==p&&!e.breakdown).sort((e,s)=>Number(e.proration)-Number(s.proration)),[n,p]),g=(0,u.useMemo)(()=>((null==n?void 0:n.lines)||[]).filter(e=>{var s;return null===(s=e.breakdown)||void 0===s?void 0:s.length}).sort((e,s)=>Number(e.usage_based)-Number(s.usage_based)||s.amount-e.amount),[n]),j=e=>{m([...c,e])},f=e=>{m(c.filter(s=>s!==e))},y=(0,u.useMemo)(()=>g.length===c.length,[g,c]);return(0,i.jsxs)(i.Fragment,{children:[l&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),o&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve upcoming invoice",error:r}),d&&(0,i.jsxs)("div",{children:[g.length>0&&(0,i.jsx)("div",{className:"mb-2",children:(0,i.jsx)(Y.z,{size:"tiny",type:"default",onClick:()=>{y?m([]):m(g.map(e=>e.description))},children:y?"Collapse All":"Expand All"})}),(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("th",{className:"py-2 font-medium text-left text-sm text-foreground-light max-w-[200px]",children:"Item"}),(0,i.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light pr-4",children:"Usage"}),(0,i.jsx)("th",{className:"py-2 font-medium text-left text-sm text-foreground-light",children:"Unit price"}),(0,i.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light",children:"Cost"})]})}),(0,i.jsx)("tbody",{children:x.map(e=>{var s,t;return(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("td",{className:"py-2 text-sm max-w-[200px]",colSpan:e.proration?3:1,children:null!==(t=e.description)&&void 0!==t?t:"Unknown"}),!e.proration&&(0,i.jsx)("td",{className:"py-2 text-sm text-right pr-4",children:null===(s=e.quantity)||void 0===s?void 0:s.toLocaleString()}),!e.proration&&(0,i.jsx)("td",{className:"py-2 text-sm",children:0===e.unit_price?"FREE":e.unit_price?(0,J.xG)(e.unit_price):null}),(0,i.jsx)("td",{className:"py-2 text-sm text-right",children:(0,J.xG)(e.amount)})]},e.description)})}),g.length>0&&g.map(e=>{var s,t;return(0,i.jsx)(G.ZP,{asChild:!0,open:c.includes(e.description),onOpenChange:s=>s?j(e.description):f(e.description),children:(0,i.jsxs)("tbody",{children:[(0,i.jsx)(G.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("tr",{className:c.includes(e.description)?"":"border-b",style:{WebkitAppearance:"initial"},children:[(0,i.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,i.jsx)(Y.z,{type:"text",className:"!px-1",icon:(0,i.jsx)(B.Z,{className:(0,D.default)("transition",c.includes(e.description)&&"rotate-90")})})," ",(0,i.jsxs)("span",{className:"mr-2",children:[e.description,e.usage_metric&&K(e.usage_metric)&&" (".concat(K(e.usage_metric),")")]}),(()=>{let s=$.find(s=>{var t;return null===(t=e.usage_metric)||void 0===t?void 0:t.startsWith(s.identifier)});return s?(0,i.jsx)(ee,{text:s.text,linkRef:s.linkRef}):null})()]}),(0,i.jsx)("td",{className:"py-2 pr-4 text-sm text-right tabular-nums max-w-[100px]",children:e.usage_original?"".concat(X(e.usage_metric,{usage:e.usage_original})):e.quantity?e.quantity:null}),(0,i.jsx)("td",{className:"py-2 text-sm",children:e.unit_price_desc?"".concat(e.unit_price_desc):e.unit_price?(0,J.xG)(e.unit_price):null}),(0,i.jsx)("td",{className:"py-2 text-sm text-right max-w-[70px]",children:null!==(t=(0,J.xG)(e.amount))&&void 0!==t?t:(0,J.xG)(0)})]},e.description)}),(0,i.jsx)(G.ZP.Content,{asChild:!0,children:(0,i.jsx)(i.Fragment,{children:null===(s=e.breakdown)||void 0===s?void 0:s.map(s=>(0,i.jsxs)("tr",{className:"last:border-b cursor-pointer",style:{WebkitAppearance:"initial"},children:[(0,i.jsx)("td",{className:"pb-1 text-xs pl-8 max-w-[200px]",children:s.project_name}),(0,i.jsx)("td",{className:"pb-1 text-xs tabular-nums text-right pr-4",children:X(e.usage_metric,s)}),(0,i.jsx)("td",{}),(0,i.jsx)("td",{})]},s.project_ref))})})]})},e.description)}),p&&(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,i.jsx)("span",{className:"mr-2",children:p.description}),(0,i.jsx)(ee,{text:"Paid plans come with $10 in Compute Credits to cover one Micro instance or parts of any other instance. Compute Credits are given to you every month and do not stack up while you are on a paid plan.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#compute-credits"})]}),(0,i.jsx)("td",{className:"py-2 text-sm text-right",colSpan:3,children:(0,J.xG)(p.amount)})]})}),(0,i.jsxs)("tfoot",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"py-4 text-sm font-medium",children:[(0,i.jsx)("span",{className:"mr-2",children:"Current Costs"}),(0,i.jsx)(ee,{text:"Costs accumulated from the beginning of the billing cycle up to now."})]}),(0,i.jsx)("td",{className:"py-4 text-sm text-right font-medium",colSpan:3,children:null!==(s=(0,J.xG)(null==n?void 0:n.amount_total))&&void 0!==s?s:"-"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"text-sm font-medium",children:[(0,i.jsx)("span",{className:"mr-2",children:"Projected Costs"}),(0,i.jsx)(ee,{text:"Projected costs at the end of the billing cycle. Includes predictable costs for Compute Hours, IPv4, Custom Domain and Point-In-Time-Recovery, but no costs for metrics like MAU, storage or function invocations. Final amounts may vary depending on your usage."})]}),(0,i.jsx)("td",{className:"text-sm text-right font-medium",colSpan:3,children:null!==(t=(0,J.xG)(null==n?void 0:n.amount_projected))&&void 0!==t?t:"-"})]})]})]})]})]})},et=()=>{var e,s;let{slug:t}=(0,r.UO)(),a=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:n,error:u,isLoading:m,isError:p}=(0,d.G)({orgSlug:t},{enabled:a}),x=(0,o.N)("billing:invoices"),g=O().unix(null!==(e=null==n?void 0:n.current_period_start)&&void 0!==e?e:0).utc(),f=O().unix(null!==(s=null==n?void 0:n.current_period_end)&&void 0!==s?s:0).utc();return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Breakdown"}),(0,i.jsxs)("p",{className:"text-sm text-foreground-light m-0",children:["Current billing cycle: ",g.format("MMM DD")," -"," ",f.format("MMM DD")]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"It may take up to an hour for addon changes or new projects to show up."})]})}),(0,i.jsx)(l.Lc,{children:a?(0,i.jsxs)(i.Fragment,{children:[m&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),p&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:u}),x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["The table shows your upcoming invoice, excluding credits. This invoice will continue updating until the end of your billing period on"," ",f.format("MMMM DD"),". See"," ",(0,i.jsx)(L(),{className:"text-green-900 transition hover:text-green-1000",href:"/org/".concat(t,"/usage"),children:"usage page"})," ","for a more detailed usage breakdown."]}),(0,i.jsx)(es,{slug:t})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's billing breakdown"})})]})};async function ea(e){let{slug:s,name:t,billing_email:a,opt_in_tags:n}=e,i={};t&&(i.name=t),a&&(i.billing_email=a),n&&(i.opt_in_tags=n);let{data:r,error:l}=await (0,y.r$)("/platform/organizations/{slug}",{params:{path:{slug:s}},body:i});return l&&(0,y.S3)(l),r}let en=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>ea(e),{async onSuccess(s,t,n){await a.invalidateQueries(N.O.list()),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update organization: ".concat(e.message)):s(e,t,a)},...t})};var ei=t(31310),er=t(89823),el=()=>{let{slug:e}=(0,r.UO)(),s=(0,_.NL)(),t=(0,er.l)(),{name:a,billing_email:n}=null!=t?t:{},o="org-billing-email",d=(0,b.Xo)(c.KA.UPDATE,"organizations"),h=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{mutate:j,isLoading:v}=en(),f=async(t,n)=>{let{resetForm:i}=n;return d?e?a?void j({slug:e,name:a,billing_email:t.billing_email},{onSuccess:e=>{let{billing_email:t}=e;i({values:{billing_email:t},initialValues:{billing_email:t}}),(0,ei.aL)(s),m.ZP.success("Successfully saved settings")}}):console.error("Organization name is required"):console.error("Slug is required"):m.ZP.error("You do not have the required permissions to update this organization")};return h?(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Email Recipient"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"All billing correspondence will go to this email"})]})}),(0,i.jsx)(l.Lc,{children:(0,i.jsx)(A.Z,{id:o,initialValues:{billing_email:null!=n?n:""},onSubmit:f,children:s=>{let{handleReset:t,values:a,initialValues:r,resetForm:l}=s,c=JSON.stringify(a)!==JSON.stringify(r);return(0,u.useEffect)(()=>{let e={billing_email:null!=n?n:""};l({values:e,initialValues:e})},[e]),(0,i.jsx)(x.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(p.i,{form:o,isSubmitting:v,hasChanges:c,handleReset:t,helper:d?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,i.jsx)(g.hj,{children:(0,i.jsx)(g.B4,{fullWidth:!0,loading:!1,children:(0,i.jsx)(z.Z,{id:"billing_email",size:"small",label:"Email address",type:"text",disabled:!d})})})})}})})]}):null},eo=t(17172),ed=t(46529),ec=t(6659),eu=t(96577),em=t.n(eu),eh=t(94896);async function ep(e){let{slug:s}=e,{data:t,error:a}=await (0,y.IV)("/platform/organizations/{slug}/billing/subscription/schedule",{params:{path:{slug:s}}});return a&&(0,y.S3)(a),t}let ex=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>ep(e),{async onSuccess(s,t,n){await a.invalidateQueries(eh.U.orgSubscription(t.slug)),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to cancel subscription schedule: ".concat(e.message)):s(e,t,a)},...t})};var eg=t(75939),ej=t(99248),ev=t(11774),ef=t(48869),ey=t(95492),eb=t(2320),eN=t(15735),ew=t(99445);async function eS(e){let{slug:s,tier:t,paymentMethod:a}=e;if(!s)throw Error("slug is required");if(!t)throw Error("tier is required");let n={tier:t};void 0!==a&&(n.payment_method=a);let{error:i,data:r}=await (0,y.gz)("/platform/organizations/{slug}/billing/subscription",{body:{payment_method:n.payment_method,tier:n.tier},params:{path:{slug:s}}});return i&&(0,y.S3)(i),r}let e_=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>eS(e),{async onSuccess(s,t,n){let{slug:i}=t;await new Promise(e=>setTimeout(e,2e3)),await Promise.all([a.invalidateQueries(eh.U.orgSubscription(i)),a.invalidateQueries(eh.U.orgPlans(i)),a.invalidateQueries(ew.Z.orgUsage(i)),a.invalidateQueries(M.Y.orgUpcomingPreview(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update subscription: ".concat(e.message)):s(e,t,a)},...t})};var eC=t(11682),eZ=t(49251),eI=t(32830),eA=t(54383);let ez=[{name:"Spend cap enabled",value:"on",imageUrl:"".concat(ej.GW,"/img/spend-cap-on.png"),imageUrlLight:"".concat(ej.GW,"/img/spend-cap-on--light.png")},{name:"Spend cap disabled",value:"off",imageUrl:"".concat(ej.GW,"/img/spend-cap-off.png"),imageUrlLight:"".concat(ej.GW,"/img/spend-cap-off--light.png")}];var eE=()=>{var e;let{slug:s}=(0,r.UO)(),{resolvedTheme:t}=(0,ec.F)(),[a,n]=(0,u.useState)(!1),[l,o]=(0,u.useState)(),h=(0,b.Xo)(c.KA.BILLING_WRITE,"stripe.subscriptions"),p=(0,ev.Wu)(),x="costControl"===p.panelKey,g=()=>p.setPanelKey(void 0),{data:j,isLoading:v}=(0,d.G)({orgSlug:s}),{mutate:f,isLoading:y}=e_({onSuccess:()=>{m.ZP.success("Successfully ".concat(S?"enabled":"disabled"," spend cap")),g()},onError:e=>{m.ZP.error("Failed to toggle spend cap: ".concat(e.message))}}),N=(null==j?void 0:null===(e=j.plan)||void 0===e?void 0:e.id)==="free",w=!(null==j?void 0:j.usage_billing_enabled),S=!w&&"on"===l,_=l!==(w?"on":"off");(0,u.useEffect)(()=>{x&&void 0!==j&&o(w?"on":"off")},[x,v,j,w]);let C=async()=>{if(!s)return console.error("Org slug is required");f({slug:s,tier:"on"===l?ej.ev.PRO:ej.ev.PAYG})};return(0,i.jsx)(eZ.ZP,{size:"large",loading:v||y,disabled:N||v||!_||y||!h,visible:x,onCancel:g,onConfirm:C,header:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h4",{children:"Spend cap"}),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eI.Z,{strokeWidth:1.5}),children:(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:"About spend cap"})})]}),tooltip:h?void 0:"You do not have permission to update spend cap",children:(0,i.jsx)(eZ.ZP.Content,{children:(0,i.jsxs)("div",{className:"py-6 space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Use the spend cap to manage project usage and costs, and control whether the project can exceed the included quota allowance of any billed line item in a billing cycle"}),(0,i.jsxs)(G.ZP,{open:a,onOpenChange:n,children:[(0,i.jsx)(G.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,i.jsx)(B.Z,{strokeWidth:1.5,size:16,className:a?"rotate-90":""}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"How are each resource charged after exceeding the included quota?"})]})}),(0,i.jsx)(G.ZP.Content,{asChild:!0,children:(0,i.jsx)(eN.Z,{className:"mt-4",head:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eN.Z.th,{children:(0,i.jsx)("p",{className:"text-xs",children:"Item"})}),(0,i.jsx)(eN.Z.th,{children:(0,i.jsx)("p",{className:"text-xs",children:"Rate"})})]}),body:["database","auth","storage","realtime","edge_functions"].map(e=>{let s=eC.D[e],t=s.features.filter(e=>e.usage_based);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{className:"text-xs text-foreground",children:s.title})}),(0,i.jsx)(eN.Z.td,{children:null})]},e),t.map(e=>(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{className:"text-xs pl-4",children:e.title})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{className:"text-xs pl-4",children:e.plans.pro})})]},e.title))]})})})})]}),N&&(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"Toggling of the spend cap is only available on the Pro Plan",actions:(0,i.jsx)(Y.z,{type:"default",onClick:()=>p.setPanelKey("subscriptionPlan"),children:"View available plans"}),children:"Upgrade your plan to disable the spend cap"}),(0,i.jsx)("div",{className:"!mt-8 pb-4",children:(0,i.jsx)("div",{className:"flex gap-3",children:ez.map(e=>{let s=l===e.value;return(0,i.jsxs)("div",{className:(0,eA.cn)("col-span-4 group space-y-1",N&&"opacity-75"),onClick:()=>!N&&o(e.value),children:[(0,i.jsx)(em(),{alt:"Spend Cap",className:(0,eA.cn)("relative rounded-xl transition border bg-no-repeat bg-center bg-cover w-[160px] h-[96px]",s?"border-foreground":"border-foreground-muted opacity-50 group-hover:border-foreground-lighter group-hover:opacity-100",!N&&"cursor-pointer",!N&&!s&&"group-hover:border-foreground-light"),width:160,height:96,src:(null==t?void 0:t.includes("dark"))?e.imageUrl:e.imageUrlLight}),(0,i.jsx)("p",{className:(0,eA.cn)("text-sm transition",!N&&"group-hover:text-foreground",s?"text-foreground":"text-foreground-light"),children:e.name})]},e.value)})})}),"on"===l?(0,i.jsx)(ef.b,{withIcon:!0,variant:"warning",title:"Your projects could become unresponsive or enter read only mode",children:"Exceeding the included quota allowance with spend cap enabled can cause your projects to become unresponsive or enter read only mode."}):(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"Charges apply for usage beyond included quota allowance",children:"Your projects will always remain responsive and active, and charges only apply when exceeding the included quota limit."}),_&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("p",{className:"text-sm",children:"on"===l?"Upon clicking confirm, spend cap will be enabled for your organization and you will no longer be charged any extra for usage.":"Upon clicking confirm, spend cap will be disabled for your organization and you will be charged for any usage beyond the included quota."})})]})})})},ek=e=>{var s,t,a,n;let{}=e,{slug:o}=(0,r.UO)(),{resolvedTheme:u}=(0,ec.F)(),m=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),p=(0,ev.Wu)(),x=(0,eg.P)("disableProjectCreationAndUpdate"),{data:g,error:f,isLoading:y,isSuccess:N,isError:w}=(0,d.G)({orgSlug:o},{enabled:m}),S=null==g?void 0:g.plan,_=null!==(n=null==g?void 0:g.usage_billing_enabled)&&void 0!==n&&n,C=!x&&!["team","enterprise"].includes((null==S?void 0:S.id)||""),{mutate:Z,isLoading:I}=ex();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Cost Control"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Control whether to use beyond your plans included quota"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,i.jsx)("div",{children:(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm m-0",children:"Spend cap"}),(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,i.jsx)(l.Lc,{children:m?(0,i.jsxs)(i.Fragment,{children:[y&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),w&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:f}),N&&(0,i.jsxs)("div",{className:"space-y-6",children:[["team","enterprise"].includes((null==S?void 0:S.id)||"")?(0,i.jsxs)(ef.b,{withIcon:!0,variant:"info",title:"You will be charged for any additional usage on the ".concat((null==S?void 0:S.name)||""," plan"),children:[(null==S?void 0:S.name)||""," plan requires you to have spend cap off at all times. Your projects will never become unresponsive. Only when your"," ",(0,i.jsx)(L(),{href:"/org/".concat(o,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included usage"})," ","is exceeded will you be charged for any additional usage."]}):(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["You can control whether your organization is charged for additional usage beyond the"," ",(0,i.jsx)(L(),{href:"/org/".concat(o,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included quota"})," ","of your subscription plan. If you need to go beyond the included quota, simply switch off your spend cap to pay for additional usage."]}),(null==g?void 0:null===(s=g.scheduled_plan_change)||void 0===s?void 0:s.target_plan)==="pro"&&(null==g?void 0:null===(t=g.scheduled_plan_change)||void 0===t?void 0:t.usage_billing_enabled)===!1&&(null==g?void 0:g.plan.id)==="pro"&&(0,i.jsxs)(ey.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,i.jsx)(ed.Z,{className:"h-4 w-4"}),(0,i.jsx)(ey.Cd,{children:"Scheduled change"}),(0,i.jsxs)(ey.X,{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{children:["Your spend cap will be enabled on"," ",O()(null==g?void 0:null===(a=g.scheduled_plan_change)||void 0===a?void 0:a.at).format("MMMM D, YYYY"),". You will not be charged for any over-usage moving on. If you would like to keep the spend cap disabled and scale as you go, you may still cancel the scheduled change."]}),(0,i.jsx)("div",{children:(0,i.jsx)(Y.z,{type:"default",loading:I,onClick:()=>Z({slug:o}),children:"Cancel"})})]})]}),(0,i.jsxs)("div",{className:"flex space-x-6",children:[(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"rounded-md bg-surface-200 w-[160px] h-[96px] shadow",children:(0,i.jsx)(em(),{alt:"Spend Cap",width:160,height:96,src:_?"".concat(ej.GW,"/img/spend-cap-off").concat((null==u?void 0:u.includes("dark"))?"":"--light",".png?v=3"):"".concat(ej.GW,"/img/spend-cap-on").concat((null==u?void 0:u.includes("dark"))?"":"--light",".png?v=3")})})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"mb-1",children:["Spend cap is ",_?"disabled":"enabled"]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:_?(0,i.jsx)("span",{children:"You will be charged for any usage above the included quota."}):(0,i.jsx)("span",{children:"You won't be charged any extra for usage. However, your projects could become unresponsive or enter read only mode if you exceed the included quota."})}),_&&(0,i.jsx)("p",{className:"text-sm text-foreground-light mt-1",children:"Your projects will never become unresponsive. Only when your usage reaches the quota limit will you be charged for any excess usage."}),(0,i.jsx)(eb.Z,{projectUpdateDisabled:x,children:(0,i.jsx)(Y.z,{type:"default",className:"mt-4 pointer-events-auto",disabled:!C,onClick:()=>p.setPanelKey("costControl"),children:"Change spend cap"})})]})]})]})]}):(0,i.jsx)(j.Z,{resourceText:"update this organization's cost control"})})]}),(0,i.jsx)(eE,{})]})},eT=t(81076),eP=()=>{var e;let{slug:s}=(0,r.UO)(),t=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:a,error:n,isLoading:o,isError:u,isSuccess:m}=(0,d.G)({orgSlug:s},{enabled:t}),p=(null!==(e=null==a?void 0:a.customer_balance)&&void 0!==e?e:0)/100,x=p<0,g=p>0,f=x&&0!==p?p.toFixed(2).toString().replace("-",""):p.toFixed(2);return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Credit Balance"}),x&&(0,i.jsx)(eT.C,{children:"You have credits available"}),g&&(0,i.jsx)(eT.C,{variant:"destructive",children:"Outstanding payments"})]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Charges will be deducted from your balance first"})]})}),(0,i.jsx)(l.Lc,{children:t?(0,i.jsxs)(i.Fragment,{children:[o&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),u&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve organization customer profile",error:n}),m&&(0,i.jsxs)("div",{className:"flex items-end space-x-1",children:[g&&(0,i.jsx)("h4",{className:"opacity-50",children:"-"}),(0,i.jsx)("h4",{className:"opacity-50",children:"$"}),(0,i.jsx)("h2",{className:"text-4xl relative top-[2px]",children:f}),x&&(0,i.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's credits"})})]})},eO=t(43544);async function eR(e,s){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:a,error:n}=await (0,y.U2)("/platform/organizations/{slug}/payments",{params:{path:{slug:t}},headers:{Version:"2"},signal:s});return n&&(0,y.S3)(n),a}let eL=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(N.O.paymentMethods(s),e=>{let{signal:t}=e;return eR({slug:s},t)},{enabled:t,...a})};var eD=t(31654),eM=t(151),eU=t(59073),eF=function(e){return(0,i.jsx)(eU.Z,{icon:eM.Z,...e})},eY=t(34503),eG=t(82),eB=t(83690);async function eV(e){let{slug:s,paymentMethodId:t}=e;if(!s)throw Error("Slug is required");let{data:a,error:n}=await (0,y.gz)("/platform/organizations/{slug}/payments/default",{body:{payment_method_id:t},params:{path:{slug:s}}});if(n)throw(0,y.S3)(n);return a}let eq=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>eV(e),{async onSuccess(s,t,n){let{slug:i,paymentMethodId:r}=t;a.setQueriesData(N.O.paymentMethods(i),e=>e?{...e,defaultPaymentMethodId:r,data:e.data.map(e=>({...e,is_default:e.id===r}))}:e),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to mark payment method as default: ".concat(e.message)):s(e,t,a)},...t})};var eW=e=>{var s,t;let{selectedPaymentMethod:a,onClose:n}=e,{slug:l}=(0,r.UO)(),{mutate:o,isLoading:d}=eq({onSuccess:()=>{m.ZP.success("Successfully changed payment method to the card ending with ".concat(a.card.last4)),n()},onError:e=>{m.ZP.error("Failed to change payment method: ".concat(e.message))}}),c=async()=>l?a?void o({slug:l,paymentMethodId:a.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,i.jsx)(eB.Z,{visible:void 0!==a,size:"medium",header:"Confirm to use payment method ending with ".concat(null==a?void 0:null===(s=a.card)||void 0===s?void 0:s.last4),onCancel:()=>n(),customFooter:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(Y.z,{type:"default",disabled:d,onClick:()=>n(),children:"Cancel"}),(0,i.jsx)(Y.z,{type:"primary",disabled:d,loading:d,onClick:c,children:"Confirm"})]}),children:(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)("p",{className:"text-sm",children:["Upon clicking confirm, all future charges will be deducted from the card ending with"," ",null==a?void 0:null===(t=a.card)||void 0===t?void 0:t.last4,". There are no immediate charges."]})})})};async function eH(e){let{slug:s,cardId:t}=e,{data:a,error:n}=await (0,y.IV)("/platform/organizations/{slug}/payments",{body:{card_id:t},params:{path:{slug:s}}});return n&&(0,y.S3)(n),a}let eX=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>eH(e),{async onSuccess(s,t,n){let{slug:i}=t;await a.invalidateQueries(N.O.paymentMethods(i)),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to delete payment method: ".concat(e.message)):s(e,t,a)},...t})};var eK=e=>{var s;let{selectedPaymentMethod:t,onClose:a}=e,{slug:n}=(0,r.UO)(),{mutate:l,isLoading:o}=eX({onSuccess:()=>{var e;m.ZP.success("Successfully removed payment method ending with ".concat(null==t?void 0:null===(e=t.card)||void 0===e?void 0:e.last4)),a()}}),d=async()=>n?t?void l({slug:n,cardId:t.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,i.jsx)(eB.Z,{visible:void 0!==t,size:"medium",header:"Confirm to delete payment method ending with ".concat(null==t?void 0:null===(s=t.card)||void 0===s?void 0:s.last4),onCancel:()=>a(),customFooter:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(Y.z,{type:"default",disabled:o,onClick:()=>a(),children:"Cancel"}),(0,i.jsx)(Y.z,{type:"primary",disabled:o,loading:o,onClick:d,children:"Confirm"})]}),children:(0,i.jsx)(eB.Z.Content,{children:(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"This will permanently delete your payment method.",children:(0,i.jsx)("p",{children:"You can re-add the payment method any time."})})})})},eQ=()=>{var e,s,t;let{slug:a}=(0,r.UO)(),n=(0,_.NL)(),[o,p]=(0,u.useState)(),[f,y]=(0,u.useState)(),[w,S]=(0,u.useState)(!1),{data:C}=(0,d.G)({orgSlug:a}),{data:Z,error:I,isLoading:A,isError:z,isSuccess:E}=eL({slug:a}),k=(0,b.Xo)(c.KA.BILLING_READ,"stripe.payment_methods"),T=(0,b.Xo)(c.KA.BILLING_WRITE,"stripe.payment_methods");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Payment Methods"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light mb-2 pr-4 m-0",children:"After adding a payment method, make sure to mark it as active to use it for billing. You can remove unused cards."})]})}),(0,i.jsx)(l.Lc,{children:k?(0,i.jsxs)(i.Fragment,{children:[A&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),z&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve payment methods",error:I}),E&&(0,i.jsxs)(i.Fragment,{children:[(null==C?void 0:C.payment_method_type)==="invoice"&&(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"Payment is currently by invoice",actions:[(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"/support/new?category=billing&subject=Request%20to%20change%20payment%20method",target:"_blank",rel:"noreferrer",className:"ml-3",children:"Contact support"})},"payment-method-support")],children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}),(0,i.jsx)(x.by,{footer:(0,i.jsxs)("div",{className:"flex items-center justify-between py-4 px-8",children:[T?(0,i.jsx)("div",{}):(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to manage payment methods"}),(0,i.jsx)(Y.z,{type:"default",icon:(0,i.jsx)(eD.Z,{}),disabled:!T,onClick:()=>S(!0),children:"Add new card"})]}),children:(0,i.jsx)(g.hj,{children:(0,i.jsx)(g.B4,{fullWidth:!0,loading:!1,children:(null!==(t=null==Z?void 0:null===(e=Z.data)||void 0===e?void 0:e.length)&&void 0!==t?t:0)===0?(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50",children:[(0,i.jsx)(eF,{}),(0,i.jsx)("p",{className:"text-sm",children:"No payment methods"})]}):(0,i.jsx)("div",{className:"space-y-3",children:null==Z?void 0:null===(s=Z.data)||void 0===s?void 0:s.map(e=>{let s=e.is_default;return e.card?(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,i.jsx)("img",{alt:"Credit card brand",src:"".concat(ej.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,i.jsxs)("p",{className:"prose text-sm font-mono",children:["**** **** **** ",e.card.last4]}),(0,i.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",e.card.exp_month,"/",e.card.exp_year]})]}),s&&(0,i.jsx)(eT.C,{variant:"brand",children:"Active"}),T&&!s?(0,i.jsxs)(eY.h_,{children:[(0,i.jsx)(eY.$F,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"outline",className:"hover:border-muted px-1",children:(0,i.jsx)(eG.Z,{})})}),(0,i.jsxs)(eY.AW,{align:"end",children:[(null==C?void 0:C.payment_method_type)==="card"&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eY.Xi,{onClick:()=>p(e),children:(0,i.jsx)("p",{children:"Use this card"})},"make-default"),(0,i.jsx)(eY.VD,{})]}),(0,i.jsx)(eY.Xi,{onClick:()=>y(e),children:(0,i.jsx)("p",{children:"Delete card"})},"delete-method")]})]}):null]},e.id):null})})})})})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's payment methods"})})]}),(0,i.jsx)(eO.Z,{visible:w,returnUrl:"".concat((0,J.Ax)(),"/org/").concat(a,"/billing"),onCancel:()=>S(!1),onConfirm:async()=>{S(!1),m.ZP.success("Successfully added new payment method"),await n.invalidateQueries(N.O.paymentMethods(a))}}),(0,i.jsx)(eW,{selectedPaymentMethod:o,onClose:()=>p(void 0)}),(0,i.jsx)(eK,{selectedPaymentMethod:f,onClose:()=>y(void 0)})]})},eJ=t(48699),e$=t(82718),e0=t(37970);let e2=()=>{let e=(0,er.l)(),{data:s,isSuccess:t}=(0,e$.v)({orgSlug:null==e?void 0:e.slug}),{data:a,isSuccess:n}=(0,d.G)({orgSlug:null==e?void 0:e.slug}),r=!!(null==s?void 0:s.usages.find(e=>{var s;return!e.unlimited&&e.capped&&e.usage>(null!==(s=null==e?void 0:e.pricing_free_units)&&void 0!==s?s:0)}));if(!t||!n||!e)return null;let l=null;return(a&&r&&!(null==e?void 0:e.restriction_status)?l="exceededLimits":(null==e?void 0:e.restriction_status)==="grace_period"?l="gracePeriod":(null==e?void 0:e.restriction_status)==="grace_period_over"?l="gracePeriodOver":(null==e?void 0:e.restriction_status)==="restricted"&&(l="restricted"),null===l)?null:(0,i.jsxs)(i.Fragment,{children:["exceededLimits"===l&&(0,i.jsxs)(ey.bZ,{variant:"destructive",children:[(0,i.jsx)(e0.ku,{}),(0,i.jsx)(ey.Cd,{children:"Your organization's usage has exceeded its included quota"}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{children:["Your projects can become unresponsive or enter read-only mode."," ","free"===a.plan.id?"Please upgrade to the Pro Plan to ensure that your projects remain available.":"Please disable spend cap to ensure that your projects remain available."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=").concat("free"===a.plan.id?"subscriptionPlan":"costControl"),children:"free"===a.plan.id?"Upgrade plan":"Change spend cap"})},"upgrade-button"),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{size:14}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/spend-cap",children:"About spend cap"})})]})]})]}),"gracePeriod"===l&&(0,i.jsxs)(ey.bZ,{variant:"warning",children:[(0,i.jsx)(e0.aN,{}),(0,i.jsx)(ey.Cd,{children:"Your grace period has started."}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{className:"leading-tight",children:["Your organization is over its quota. You can continue with your projects until your grace period ends on"," ",(0,i.jsx)("span",{className:"text-foreground",children:O()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". After that, the Fair Use Policy will apply. If you plan to maintain this level of usage, upgrade your plan to avoid any restrictions. If restrictions are applied, requests to your projects will return a 402 status code."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{size:14}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"gracePeriodOver"===l&&(0,i.jsxs)(ey.bZ,{variant:"warning",children:[(0,i.jsx)(e0.aN,{}),(0,i.jsx)(ey.Cd,{children:"Your grace period is over."}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{children:["Your grace period ended on"," ",(0,i.jsx)("span",{className:"text-foreground",children:O()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Fair Use Policy applies now. Stay below your plan’s quota or upgrade your plan if you expect to exceed it. If you exceed your quota, requests will respond with a 402 status code."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{size:14}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"restricted"===l&&(0,i.jsxs)(ey.bZ,{variant:"destructive",children:[(0,i.jsx)(e0.ku,{}),(0,i.jsx)(ey.Cd,{children:"All services are restricted."}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{children:["Fair Use Policy applies and your service is restricted. Your projects are not able to serve requests and will respond with a 402 status code. You have exceeded your plan’s quota and your grace period ended on"," ",(0,i.jsx)("span",{className:"text-foreground",children:O()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Upgrade to lift restrictions or wait until your quota refills."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{size:14}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]})]})};var e1=t(86152),e4=t.n(e1),e3=t(91179),e5=t(5632),e6=t(34750),e8=t(44778),e7=t(61531),e9=t(28119);async function se(e){let{organizationSlug:s,tier:t}=e;if(!s)throw Error("organizationSlug is required");if(!t)throw Error("tier is required");let{data:a,error:n}=await (0,y.v_)("/platform/organizations/{slug}/billing/subscription/preview",{params:{path:{slug:s}},body:{tier:t},headers:{Version:"2"}});return n&&(0,y.S3)(n),a}let ss=function(e){let{organizationSlug:s,tier:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(N.O.subscriptionPreview(s,t),()=>se({organizationSlug:s,tier:t}),{enabled:a&&void 0!==s&&void 0!==t,...n,retry:(e,s)=>("object"!=typeof s||null===s||!("code"in s)||400!==s.code)&&e<3})};var st=t(26198);async function sa(e,s){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{error:a,data:n}=await (0,y.U2)("/platform/organizations/{slug}/billing/plans",{params:{path:{slug:t}},signal:s});return a&&(0,y.S3)(a),n}let sn=function(e){let{orgSlug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(eh.U.orgPlans(s),e=>{let{signal:t}=e;return sa({orgSlug:s},t)},{enabled:t&&void 0!==s,...a})};var si=t(46988),sr=t(90488),sl=t(25633),so=t(70913),sd=function(e){return(0,i.jsx)(eU.Z,{icon:so.Z,...e})},sc=t(53605);let su=e=>{let{projectAddon:s}=e,t=s.addons.find(e=>"compute_instance"===e.type),a=s.addons.map(e=>"compute_instance"===e.type?"".concat(e.variant.name," Compute Instance"):e.variant.name);return(0,i.jsxs)("li",{className:"list-disc ml-6",children:[s.name,": ",a.join(", ")," will be removed.",t?(0,i.jsxs)(i.Fragment,{children:[" ","Project will also ",(0,i.jsx)("span",{className:"font-bold",children:"need to be restarted"})," due to change in compute instance"]}):""]})};var sm=e=>{var s;let{visible:t,selectedPlan:a,subscription:n,onClose:r,onConfirm:l,projects:o}=e,d=(null==n?void 0:n.project_addons.flatMap(e=>{let s=e.addons.filter(e=>"ci_micro"!==e.variant.identifier);return s.length?{...e,addons:s}:[]}))||[],c=o.some(e=>"micro"===e.infra_compute_size),u=(null==n?void 0:n.nano_enabled)===!0;return(0,i.jsx)(eB.Z,{size:"large",alignFooter:"right",visible:t,onCancel:r,onConfirm:l,header:"Confirm to downgrade to ".concat(null==a?void 0:a.name," plan"),children:(0,i.jsxs)(eB.Z.Content,{children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(ef.b,{withIcon:!0,variant:"warning",title:"Downgrading to the Free Plan will lead to reductions in your organization's quota",children:(0,i.jsx)("p",{children:"If you're already past the limits of the Free Plan, your projects could become unresponsive or enter read only mode."})}),((null!==(s=d.length)&&void 0!==s?s:0)>0||c&&u)&&(0,i.jsx)(ef.b,{title:"Projects affected by the downgrade",variant:"warning",withIcon:!0,children:(0,i.jsxs)("ul",{className:"space-y-1 max-h-[100px] overflow-y-auto",children:[d.map(e=>(0,i.jsx)(su,{projectAddon:e},e.ref)),o.filter(e=>"micro"===e.infra_compute_size).map(e=>(0,i.jsxs)("li",{className:"list-disc ml-6",children:[e.name,": Compute will be downgraded. Project will also"," ",(0,i.jsx)("span",{className:"font-bold",children:"need to be restarted"}),"."]},e.ref))]})})]}),(0,i.jsxs)("ul",{className:"mt-4 space-y-5 text-sm",children:[(0,i.jsxs)("li",{className:"flex gap-3",children:[(0,i.jsx)("div",{children:(0,i.jsx)(sl.Z,{})}),(0,i.jsx)("span",{children:"Projects will be paused after a week of inactivity"})]}),(0,i.jsx)("li",{children:(0,i.jsxs)("div",{className:"flex gap-3 mb-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)(sd,{})}),(0,i.jsx)("span",{children:"Add ons from all projects under this organization will be removed."})]})}),(0,i.jsxs)("li",{className:"flex gap-3",children:[(0,i.jsx)(sc.Z,{w:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Before you downgrade to the ",null==a?void 0:a.name," plan, consider:"]}),(0,i.jsxs)("ul",{className:"space-y-2 mt-2",children:[(0,i.jsx)("li",{className:"list-disc ml-4",children:"Your projects no longer require their respective add ons."}),(0,i.jsxs)("li",{className:"list-disc ml-4",children:["Your resource consumption are well within the ",null==a?void 0:a.name," plan's quota."]}),(0,i.jsx)("li",{className:"list-disc ml-4",children:"Alternatively, you may also transfer projects across organizations."})]})]})]})]}),(null==n?void 0:n.billing_via_partner)===!0&&"fly"===n.billing_partner&&(0,i.jsx)("p",{className:"mt-4 text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})})},sh=e=>{let{plan:s,isCurrentPlan:t,billingPartner:a}=e,n=(0,si.g_)(s,a);return(0,i.jsxs)("div",{className:(0,D.default)("grid grid-cols-1 md:grid-cols-3 border rounded-md bg-studio","py-4 col-span-12 justify-between gap-x-8"),children:[(0,i.jsxs)("div",{className:"flex flex-col justify-center px-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:(0,D.default)("text-brand text-sm uppercase"),children:s.name}),t?(0,i.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):s.nameBadge?(0,i.jsx)("div",{className:"text-xs bg-surface-200 text-brand rounded px-2 py-0.5",children:s.nameBadge}):null]}),(0,i.jsx)("p",{className:"text-sm mt-2 mb-4",children:s.description}),(0,i.jsx)("a",{href:s.href,className:"hidden md:block",target:"_blank",children:(0,i.jsx)(Y.z,{block:!0,type:"default",size:"tiny",children:s.cta})})]}),(0,i.jsxs)("div",{className:"flex flex-col justify-center col-span-2 px-4 md:px-0",children:[(0,i.jsx)("ul",{role:"list",className:"text-xs text-foreground-light md:grid md:grid-cols-2 md:gap-x-10",children:n.map(e=>(0,i.jsxs)("li",{className:"flex items-center py-2 first:mt-0",children:[(0,i.jsx)(sr.Z,{className:"text-brand h-4 w-4","aria-hidden":"true",strokeWidth:3}),(0,i.jsx)("span",{className:"text-foreground mb-0 ml-3 ",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))}),(0,i.jsx)("a",{href:s.href,className:"visible md:hidden mt-8",target:"_blank",children:(0,i.jsx)(Y.z,{block:!0,type:"default",size:"tiny",children:s.cta})})]})]},s.id)},sp=t(12333),sx=t(11886),sg=t.n(sx),sj=t(67304),sv=t.n(sj),sf=t(29887);let sy=["Pricing","My project isn't getting traction","Poor customer service","Missing feature","I didn't see the value","Supabase didn't meet my needs","Dashboard is too complicated","Postgres is too complicated","Problem not solved","Too many bugs/issues","I decided to use something else","My work has finished/discontinued","I’m migrating to/starting a new project","None of the above"];var sb=e=>{let{visible:s,subscription:t,projects:a,onClose:n}=e,{slug:l}=(0,r.UO)(),o=(0,u.useRef)(null),[d,c]=(0,u.useState)(""),[h,p]=(0,u.useState)(null),[x,g]=(0,u.useReducer)(function(e,s){return sg()(e,s.target.value)?sv()(e,s.target.value):[...e,s.target.value]},[]),j=(0,eg.P)("disableProjectCreationAndUpdate"),{mutate:v,isLoading:f}=e_({onError:e=>{C(),m.ZP.error("Failed to downgrade project: ".concat(e.message))}}),{mutateAsync:y,isLoading:b}=(0,sf.S)(),N=f||b,w=a.filter(e=>{let s=["nano"];return(null==t?void 0:t.nano_enabled)===!1&&s.push("micro"),!s.includes(e.infra_compute_size)}),S=w.length>0,_=(null==t?void 0:t.billing_via_partner)===!1||(null==t?void 0:t.billing_partner)!=="fly",C=()=>{var e;p(null),null===(e=o.current)||void 0===e||e.resetCaptcha()},Z=async()=>{if(0===x.length)return m.ZP.error("Please select at least one reason for canceling your subscription");let e=h;if(!e){var s,t;let a=await (null===(s=o.current)||void 0===s?void 0:s.execute({async:!0}));e=null!==(t=null==a?void 0:a.response)&&void 0!==t?t:null,await I()}},I=async()=>{if(!l)return console.error("Slug is required");v({slug:l,tier:"tier_free"},{onSuccess:async()=>{C();try{await y({orgSlug:l,reasons:x.reduce((e,s)=>"".concat(e,"- ").concat(s,"\n"),""),message:d,exitAction:"downgrade"})}catch(e){}finally{m.ZP.success(_?S?"Successfully downgraded organization to the Free Plan. Your projects are currently restarting to update their compute instances.":"Successfully downgraded organization to the Free Plan":"Your organization is scheduled for the downgrade at the end of your current billing cycle",{duration:S?8e3:4e3}),n(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"self-center",children:(0,i.jsx)(sp.Z,{ref:o,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onVerify:e=>{p(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>p(null),onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{void 0!==document&&document.body.classList.remove("!pointer-events-auto")}})}),(0,i.jsxs)(eB.Z,{hideFooter:!0,size:"xlarge",visible:s,onCancel:n,header:"We're sad that you're leaving",children:[(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"We always strive to improve Supabase as much as we can. Please let us know the reasons you are canceling your subscription so that we can improve in the future."}),(0,i.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:sy.map(e=>{let s=x.find(s=>s===e);return(0,i.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(s?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,i.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:g}),(0,i.jsx)("div",{children:e})]},e)})}),(0,i.jsx)("div",{className:"text-area-text-sm",children:(0,i.jsx)(z.Z.TextArea,{id:"message",name:"message",value:d,onChange:e=>c(e.target.value),label:"Anything else that we can improve on?"})})]}),S&&(0,i.jsxs)(ef.b,{withIcon:!0,variant:"warning",title:"".concat(w.length," of your projects will be restarted ").concat(_?"upon clicking confirm":"once the downgrade takes effect at the end of your current billing cycle"),children:["This is due to changes in compute instances from the downgrade. Affected projects include ",w.map(e=>e.name).join(", "),"."]})]})}),(0,i.jsxs)("div",{className:"flex items-center justify-between border-t px-4 py-4",children:[_&&(0,i.jsx)("p",{className:"text-xs text-foreground-lighter",children:"The unused amount for the remaining of your billing cycle will be refunded as credits"}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(Y.z,{type:"default",onClick:()=>n(),children:"Cancel"}),(0,i.jsx)(eb.Z,{projectUpdateDisabled:j,children:(0,i.jsx)(Y.z,{type:"danger",className:"pointer-events-auto",loading:N,disabled:j||N,onClick:Z,children:"Confirm downgrade"})})]})]})]})]})},sN=e=>{let{visible:s,onClose:t}=e,a=(0,er.l)(),n=null==a?void 0:a.slug,{data:r}=(0,e9.u)({slug:n});return(0,i.jsxs)(eB.Z,{hideFooter:!0,visible:s,size:"medium",header:"Your organization has members who have exceeded their free project limits",onCancel:t,children:[(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"The following members have reached their maximum limits for the number of active free plan projects within organizations where they are an administrator or owner:"}),(0,i.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(r||[]).map((e,s)=>(0,i.jsxs)("li",{children:[e.username||e.primary_email," (Limit: ",e.free_project_limit," free projects)"]},"member-".concat(s)))}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of these projects before you're able to downgrade this project."})]})}),(0,i.jsx)(eB.Z.Separator,{}),(0,i.jsx)(eB.Z.Content,{className:"flex items-center gap-2",children:(0,i.jsx)(Y.z,{htmlType:"button",type:"default",onClick:t,block:!0,children:"Understood"})})]})},sw=t(84447),sS=t(39459),s_=e=>{let{selectedPaymentMethod:s,onSelectPaymentMethod:t,layout:a="vertical"}=e,n=(0,er.l)(),r=null==n?void 0:n.slug,[l,o]=(0,u.useState)(!1),{data:d,isLoading:h,refetch:p}=eL({slug:r}),x=(0,b.Xo)(c.KA.BILLING_WRITE,"stripe.payment_methods");return(0,u.useEffect)(()=>{if((null==d?void 0:d.data)&&d.data.length>0){let e=d.data.some(e=>e.id===s);if(!s||!e){let e=d.data.find(e=>e.is_default);void 0!==e?t(e.id):t(d.data[0].id)}}},[s,d,t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:h?(0,i.jsxs)("div",{className:"flex items-center px-4 py-2 space-x-4 border rounded-md border-strong bg-surface-200",children:[(0,i.jsx)(sw.Z,{className:"animate-spin",size:14}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Retrieving payment methods"})]}):(null==d?void 0:d.data.length)===0?(0,i.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border border-dashed rounded-md bg-alternative",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-foreground-light",children:[(0,i.jsx)(sS.Z,{size:16,strokeWidth:1.5}),(0,i.jsx)("p",{className:"text-sm",children:"No saved payment methods"})]}),(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"default",disabled:!x,icon:(0,i.jsx)(eF,{}),onClick:()=>o(!0),htmlType:"button",children:"Add new"})}),!x&&(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-48 border border-background text-center",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to add new payment methods to this organization"})})]})})]})]}):(0,i.jsxs)(E.Z,{layout:a,label:"Payment method",value:s,onChange:t,className:"flex items-center",children:[null==d?void 0:d.data.map(e=>{let s="•••• •••• •••• ".concat(e.card.last4);return(0,i.jsx)(E.Z.Option,{label:s,value:e.id,addOnBefore:()=>(0,i.jsx)("img",{alt:"Credit Card Brand",src:"".concat(ej.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),children:(0,i.jsx)("div",{children:s})},e.id)}),(0,i.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-2 transition cursor-pointer group hover:bg-surface-300",onClick:()=>o(!0),children:[(0,i.jsx)(eD.Z,{size:16}),(0,i.jsx)("p",{className:"transition text-foreground-light group-hover:text-foreground",children:"Add new payment method"})]})]})}),(0,i.jsx)(eO.Z,{visible:l,returnUrl:"".concat((0,J.Ax)(),"/org/").concat(null==n?void 0:n.slug,"/billing?panel=subscriptionPlan"),onCancel:()=>o(!1),onConfirm:async()=>{var e;o(!1),m.ZP.success("Successfully added new payment method");let{data:s}=await p();(null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.length)&&t((null==s?void 0:s.data.reduce((e,s)=>e.created>s.created?e:s,s.data[0])).id)}})]})};async function sC(e){let{orgSlug:s,prevPlan:t,currentPlan:a,reasons:n,message:i}=e,{data:r,error:l}=await (0,y.v_)("/platform/feedback/upgrade",{body:{...void 0!==s&&{orgSlug:s},...void 0!==t&&{prevPlan:t},...void 0!==a&&{currentPlan:a},reasons:n,...void 0!==i&&{additionalFeedback:i}}});return l&&(0,y.S3)(l),r}let sZ=function(){let{onError:e,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.D)(e=>sC(e),{async onError(s,t,a){void 0===e?m.ZP.error("Failed to submit upgrade survey: ".concat(s.message)):e(s,t,a)},...s})};var sI=e=>{let{visible:s,originalPlan:t,subscription:a,onClose:n}=e,{slug:l}=(0,r.UO)(),[o,d]=(0,u.useState)(""),[c,h]=(0,u.useReducer)(function(e,s){return sg()(e,s.target.value)?sv()(e,s.target.value):[...e,s.target.value]},[]),p=Q(t,null==a?void 0:a.plan.id),{mutate:x,isLoading:g}=sZ({onError:e=>{m.ZP.error("Failed to submit survey: ".concat(e.message))},onSuccess:()=>{n(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}),j=async()=>{var e;if(0===c.length)return m.ZP.error("Please select at least one reason for upgrading your subscription");x({orgSlug:l,prevPlan:t,currentPlan:null==a?void 0:null===(e=a.plan)||void 0===e?void 0:e.id,reasons:c,message:o.trim()||void 0})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(eB.Z,{alignFooter:"right",size:"xlarge",loading:g,visible:s,onCancel:n,onConfirm:j,cancelText:"Skip",header:"We're excited for your upgrade",children:(0,i.jsxs)(eB.Z.Content,{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"What reasons motivated your decision to upgrade? Your feedback helps us improve Supabase as much as we can."}),(0,i.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:p.map(e=>{let s=c.find(s=>s===e);return(0,i.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(s?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,i.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:h}),(0,i.jsx)("div",{children:e})]},e)})}),(0,i.jsx)("div",{className:"text-area-text-sm",children:(0,i.jsx)(z.Z.TextArea,{id:"message",name:"message",value:o,onChange:e=>d(e.target.value),label:"Anything else that we can improve on?"})})]})]})})})},sA=()=>{var e,s,t,a;let n=(0,e5.useRouter)(),r=(0,er.l)(),l=null==r?void 0:r.slug,o=(0,u.useRef)(),[p,x]=(0,u.useState)(!1),[g,j]=(0,u.useState)(!1),[f,y]=(0,u.useState)(),[N,w]=(0,u.useState)(!1),[S,_]=(0,u.useState)(),[C,Z]=(0,u.useState)([]),I=(0,b.Xo)(c.KA.BILLING_WRITE,"stripe.subscriptions"),{data:A}=(0,st.Sy)(),z=(A||[]).filter(e=>e.organization_id===(null==r?void 0:r.id)),E=(0,ev.Wu)(),k="subscriptionPlan"===E.panelKey,T=()=>{let{panel:e,...s}=n.query;n.push({pathname:n.pathname,query:s},void 0,{shallow:!0}),E.setPanelKey(void 0)},{data:P,isSuccess:O}=(0,d.G)({orgSlug:l}),{data:R,isLoading:D}=sn({orgSlug:l}),{data:M}=(0,e9.u)({slug:l}),{mutate:U,isLoading:F}=e_({onSuccess:()=>{m.ZP.success("Successfully updated subscription to ".concat(null==ee?void 0:ee.name,"!")),_(void 0),T(),window.scrollTo({top:0,left:0,behavior:"smooth"}),j(!0)},onError:e=>{m.ZP.error("Unable to update subscription: ".concat(e.message))}}),G=(null==P?void 0:P.billing_via_partner)===!0,B=null==P?void 0:P.billing_partner,q=(null==P?void 0:P.payment_method_type)==="invoice",{data:W,error:H,isLoading:X,isSuccess:K}=ss({tier:S,organizationSlug:l}),Q=null!==(t=null==R?void 0:R.plans)&&void 0!==t?t:[],$=(M||[]).length>0,ee=si.z5.find(e=>e.id===S),es=e=>{Z([...C,e])},et=e=>{Z(C.filter(s=>s!==e))};(0,u.useEffect)(()=>{k&&_(void 0)},[k]),(0,u.useEffect)(()=>{k&&O&&(o.current=P.plan.id)},[k,O]);let ea=async()=>{var e;return l?S?f||q?void U({slug:l,tier:(null==P?void 0:null===(e=P.plan)||void 0===e?void 0:e.id)==="team"&&S===ej.ev.PRO?ej.ev.PAYG:S,paymentMethod:f}):m.ZP.error("Please select a payment method"):console.error("Selected plan is required"):console.error("org slug is required")},en=S?Q.find(e=>e.id===S.split("tier_")[1]):null;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eZ.ZP,{hideFooter:!0,size:"xxlarge",visible:k,onCancel:()=>T(),header:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("h4",{children:["Change subscription plan for ",null==r?void 0:r.name]}),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(L(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:"Pricing"})})]}),children:(0,i.jsx)(eZ.ZP.Content,{children:(0,i.jsx)("div",{className:"py-6 grid grid-cols-12 gap-3",children:si.z5.map(e=>{var s,t,a,n;let r=Q.find(s=>s.id===e.id.split("tier_")[1]),l=null!==(n=null==r?void 0:r.price)&&void 0!==n?n:0,o=(null==r?void 0:r.change_type)==="downgrade",d=(null==r?void 0:r.id)===(null==P?void 0:null===(s=P.plan)||void 0===s?void 0:s.id),c=(0,si.g_)(e,B),u=(0,si.nq)(e,B);return"tier_enterprise"===e.id?(0,i.jsx)(sh,{plan:e,isCurrentPlan:d,billingPartner:B},e.id):(0,i.jsxs)("div",{className:"border rounded-md px-4 py-4 flex flex-col items-start justify-between col-span-12 md:col-span-4 bg-surface-200",children:[(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:(0,eA.cn)("text-brand text-sm uppercase"),children:e.name}),d?(0,i.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):e.nameBadge?(0,i.jsx)("div",{className:"text-xs bg-brand-400 text-brand-600 rounded px-2 py-0.5",children:e.nameBadge}):(0,i.jsx)(i.Fragment,{})]}),(0,i.jsxs)("div",{className:"mt-4 flex items-center space-x-1 mb-4",children:[(null!=l?l:0)>0&&(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"From"}),D?(0,i.jsx)("div",{className:"h-[28px] flex items-center justify-center",children:(0,i.jsx)(v.Z,{className:"w-[30px] h-[24px]"})}):(0,i.jsx)("p",{className:"text-foreground text-lg",children:(0,J.xG)(l)}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:e.costUnit})]}),d?(0,i.jsx)(Y.z,{block:!0,disabled:!0,type:"default",children:"Current plan"}):(0,i.jsxs)(e8.u,{block:!0,type:o?"default":"primary",disabled:(null==P?void 0:null===(t=P.plan)||void 0===t?void 0:t.id)==="enterprise"||!I,onClick:()=>_(e.id),tooltip:{content:{side:"bottom",text:(null==P?void 0:null===(a=P.plan)||void 0===a?void 0:a.id)==="enterprise"?"Reach out to us via support to update your plan from Enterprise":I?void 0:"You do not have permission to change the subscription plan"}},children:[o?"Downgrade":"Upgrade"," to ",e.name]}),(0,i.jsx)("div",{className:"border-t my-4"}),(0,i.jsx)("ul",{role:"list",children:c.map(e=>(0,i.jsxs)("li",{className:"flex py-2",children:[(0,i.jsx)("div",{className:"w-[12px]",children:(0,i.jsx)(sr.Z,{className:"h-3 w-3 text-brand translate-y-[2.5px]","aria-hidden":"true",strokeWidth:3})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"ml-3 text-xs text-foreground-light",children:"string"==typeof e?e:e[0]}),e4()(e)&&(0,i.jsx)("p",{className:"ml-3 text-xs text-foreground-lighter",children:e[1]})]})]},"string"==typeof e?e:e[0]))})]}),u&&(0,i.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,i.jsx)("p",{className:"text-foreground-light text-xs",children:u})})]},e.id)})})})}),(0,i.jsx)(sm,{visible:"tier_free"===S,selectedPlan:ee,subscription:P,onClose:()=>_(void 0),onConfirm:()=>{_(void 0),$?w(!0):x(!0)},projects:z}),(0,i.jsxs)(eB.Z,{loading:F,alignFooter:"right",size:"xlarge",visible:void 0!==S&&"tier_free"!==S,onCancel:()=>_(void 0),onConfirm:ea,dialogOverlayProps:{className:"pointer-events-none"},header:"Confirm ".concat((null==en?void 0:en.change_type)==="downgrade"?"downgrade":"upgrade"," to ").concat(null==ee?void 0:ee.name),children:[(0,i.jsxs)(eB.Z.Content,{children:[H&&(0,i.jsx)(h.Z,{error:H,subject:"Failed to preview subscription."}),X&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("span",{className:"text-sm",children:"Estimating monthly costs..."}),(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),K&&(0,i.jsxs)("div",{children:[(0,i.jsx)(eN.Z,{className:"mt-2",borderless:!0,head:[(0,i.jsx)(eN.Z.th,{children:"Item"},"header-item"),(0,i.jsx)(eN.Z.th,{className:"text-right pr-4",children:"Usage"},"header-count"),(0,i.jsx)(eN.Z.th,{children:"Unit Price"},"header-unit-price"),(0,i.jsx)(eN.Z.th,{className:"text-right",children:"Cost"},"header-price")],body:(0,i.jsxs)(i.Fragment,{children:[W.breakdown.map(e=>{var s,t;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsxs)(eN.Z.td,{children:[e.breakdown&&e.breakdown.length>0&&(0,i.jsx)(Y.z,{type:"text",className:"!pl-0 !pr-1",icon:(0,i.jsx)(e3.Z,{className:(0,eA.cn)("transition",C.includes(e.description)&&"rotate-90")}),onClick:()=>C.includes(e.description)?et(e.description):es(e.description)}),null!==(t=e.description)&&void 0!==t?t:"Unknown"," ",e.description.endsWith("Compute")&&" (Hours)"]}),(0,i.jsx)(eN.Z.td,{className:"text-right pr-4 tabular-nums",children:null===(s=e.quantity)||void 0===s?void 0:s.toLocaleString()}),(0,i.jsx)(eN.Z.td,{children:e.unit_price_desc?e.unit_price_desc:0===e.unit_price?"FREE":e.unit_price?"".concat((0,J.xG)(e.unit_price)):""}),(0,i.jsx)(eN.Z.td,{className:"text-right",children:(0,J.xG)(e.total_price)})]},e.description),C.includes(e.description)&&e.breakdown&&e.breakdown.length>0&&e.breakdown.map(e=>(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{className:"!pl-12",children:e.project_name}),(0,i.jsx)(eN.Z.td,{className:"text-right pr-4 tabular-nums",children:e.usage}),(0,i.jsx)(eN.Z.td,{}),(0,i.jsx)(eN.Z.td,{})]},e.project_ref))]})}),(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{className:"font-medium",children:"Monthly Costs (excluding over-usage and credits)"}),(0,i.jsx)(eN.Z.td,{}),(0,i.jsx)(eN.Z.td,{}),(0,i.jsx)(eN.Z.td,{className:"text-right font-medium",children:(0,J.xG)(null!==(a=Math.round(W.breakdown.reduce((e,s)=>e+s.total_price,0)))&&void 0!==a?a:0)})]})]})}),(0,i.jsx)(e7.Z,{className:"mt-4",title:"Usage-billing for Compute",icon:(0,i.jsx)(V.Z,{}),defaultVisibility:!0,hideCollapse:!0,description:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm mt-2",children:"Each project is a dedicated server and database. Paid plans come with $10 of Compute Credits to cover one project on the default Micro Compute size or parts of any compute addon. Additional unpaused projects on paid plans will incur compute usage costs starting at $10 per month, billed hourly."}),(null==P?void 0:null===(e=P.plan)||void 0===e?void 0:e.id)==="free"&&(0,i.jsx)("p",{className:"text-sm mt-2",children:"Mixing paid and non-paid projects in a single organization is not possible. If you want projects to be on the Free Plan, use self-serve project transfers."}),(0,i.jsxs)("div",{className:"space-x-3 mt-2",children:[(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"How billing works"})}),(null==P?void 0:null===(s=P.plan)||void 0===s?void 0:s.id)==="free"&&(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/project-transfer",target:"_blank",rel:"noreferrer",children:"Project transfers"})})]})]})})]})]}),(0,i.jsx)(eB.Z.Content,{children:G?(0,i.jsxs)("div",{className:"py-4 space-y-2",children:[(0,i.jsxs)("p",{className:"text-sm",children:["This organization is billed through our partner"," ",(0,e6.Gh)(B),"."," ","aws"===B?(0,i.jsx)(i.Fragment,{children:"The organization's credit balance will be decreased accordingly."}):(0,i.jsx)(i.Fragment,{children:"You will be charged by them directly."})]}),G&&"fly"===B&&(null==W?void 0:W.plan_change_type)==="downgrade"&&(0,i.jsx)("p",{className:"text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]}):(0,i.jsxs)("div",{className:"py-4 space-y-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Upon clicking confirm, your monthly invoice will be adjusted and your credit card will be charged immediately. Changing the plan resets your billing cycle and may result in a prorated charge for previous usage."}),(0,i.jsx)("div",{className:"!mt-4",children:(0,i.jsx)(s_,{selectedPaymentMethod:f,onSelectPaymentMethod:y})})]})})]}),(0,i.jsx)(sN,{visible:N,onClose:()=>w(!1)}),(0,i.jsx)(sb,{visible:p,subscription:P,projects:z,onClose:e=>{x(!1),e&&T()}}),(0,i.jsx)(sI,{visible:g,originalPlan:o.current,subscription:P,onClose:e=>{j(!1),e&&T()}})]})},sz=()=>{var e,s,t,a,n,o,u,m;let{slug:p}=(0,r.UO)(),x=(0,ev.Wu)(),g=(0,eg.P)("disableProjectCreationAndUpdate"),f=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:y,error:N,isLoading:w,isError:S,isSuccess:_}=(0,d.G)({orgSlug:p},{enabled:f}),{mutate:C,isLoading:Z}=ex(),I=null==y?void 0:y.plan,A=null!==(a=null==I?void 0:I.name)&&void 0!==a?a:"Unknown",z=O().unix(null!==(n=null==y?void 0:y.current_period_start)&&void 0!==n?n:0).utc(),E=O().unix(null!==(o=null==y?void 0:y.current_period_end)&&void 0!==o?o:0).utc(),k=E.diff(O()(),"days"),T=E.diff(z,"days"),P=!g&&!["enterprise"].includes(null!==(u=null==I?void 0:I.id)&&void 0!==u?u:"");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.jX,{children:[(0,i.jsx)("div",{className:"col-span-12 pb-2",children:(0,i.jsx)(e2,{})}),(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Subscription Plan"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,i.jsx)("div",{children:(0,i.jsx)(L(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm m-0",children:"Pricing"}),(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,i.jsx)(l.Lc,{children:f?(0,i.jsxs)(i.Fragment,{children:[w&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),S&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:N}),_&&(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm",children:"This organization is currently on the plan:"}),(0,i.jsx)("p",{className:"text-2xl text-brand uppercase",children:null!==(m=null==I?void 0:I.name)&&void 0!==m?m:"Unknown"})]}),(null==y?void 0:y.scheduled_plan_change)&&(null==y?void 0:null===(e=y.scheduled_plan_change)||void 0===e?void 0:e.target_plan)!==y.plan.id&&(0,i.jsxs)(ey.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,i.jsx)(ed.Z,{className:"h-4 w-4"}),(0,i.jsx)(ey.Cd,{children:"Scheduled downgrade"}),(0,i.jsxs)(ey.X,{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{children:["Your organization will automatically be downgraded from the"," ",(0,i.jsx)("span",{children:y.plan.name})," plan to the"," ",(0,i.jsx)("span",{className:"capitalize",children:null==y?void 0:null===(s=y.scheduled_plan_change)||void 0===s?void 0:s.target_plan})," ","plan on"," ",O()(null==y?void 0:null===(t=y.scheduled_plan_change)||void 0===t?void 0:t.at).format("MMMM D, YYYY"),". If you would like to stay on the ",(0,i.jsx)("span",{children:y.plan.name})," ","plan, cancel the scheduled downgrade."]}),(0,i.jsx)("div",{children:(0,i.jsx)(Y.z,{type:"default",loading:Z,onClick:()=>C({slug:p}),children:"Cancel downgrade"})})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eb.Z,{projectUpdateDisabled:g,children:(0,i.jsx)(Y.z,{type:"default",className:"pointer-events-auto",disabled:!P,onClick:()=>x.setPanelKey("subscriptionPlan"),children:"Change subscription plan"})}),!P&&(g?(0,i.jsx)(ef.b,{className:"mt-2",withIcon:!0,variant:"info",title:"Unable to update plan from ".concat(A),children:"We have temporarily disabled project and subscription changes - our engineers are working on a fix."}):(0,i.jsx)(ef.b,{withIcon:!0,className:"mt-2",variant:"info",title:"Unable to update plan from ".concat(A),actions:[(0,i.jsx)("div",{children:(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"/support/new?category=sales&subject=Change%20plan%20away%20from%20".concat(A),children:"Contact support"})})},"contact-support")],children:"Please contact us if you'd like to change your plan."}))]}),!(null==y?void 0:y.usage_billing_enabled)&&(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"This organization is limited by the included usage",actions:(null==I?void 0:I.id)==="free"?(0,i.jsx)(Y.z,{type:"default",onClick:()=>x.setPanelKey("subscriptionPlan"),children:"Upgrade Plan"}):(0,i.jsx)(Y.z,{type:"default",onClick:()=>x.setPanelKey("costControl"),children:"Adjust Spend Cap"}),children:(0,i.jsxs)("div",{className:"text-sm text-foreground-light mr-2",children:["When this organization exceeds its"," ",(0,i.jsx)(L(),{href:"/org/".concat(p,"/usage"),className:"text-sm text-green-900 transition hover:text-green-1000",children:"included usage quotas"}),", its projects may become unresponsive."," ",(null==I?void 0:I.id)==="free"?(0,i.jsx)("p",{className:"pr-4 mt-1",children:"If you wish to exceed the included usage, you should upgrade to a paid plan."}):(0,i.jsx)("p",{className:"pr-4 mt-1",children:"You currently have Spend Cap enabled - when you exceed your plan's limit, you will experience restrictions. To scale seamlessly and pay for over-usage, you can adjust your Cost Control settings."})]})}),(0,i.jsx)(eJ.Z,{type:"horizontal",value:T-k,max:T,barClass:"bg-foreground",labelBottom:"Current billing cycle (".concat(z.format("MMM DD")," - ").concat(E.format("MMM DD"),")"),bgClass:"bg-surface-300",labelBottomClass:"!text-foreground-light pb-1",labelTop:"".concat(k," days remaining")})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's subscription"})})]}),(0,i.jsx)(sA,{})]})},sE=t(88883),sk=t(8609),sT=t(63955),sP=t(30195),sO=t(64306);async function sR(e,s){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:a,error:n}=await (0,y.U2)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:t}},signal:s,headers:{Version:"2"}});if(n)throw(0,y.S3)(n);return a.tax_id}let sL=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(N.O.taxId(s),e=>{let{signal:t}=e;return sR({slug:s},t)},{enabled:t&&void 0!==s,...a})};async function sD(e){let{slug:s,taxId:t}=e;if(!s)throw Error("Slug is required");if(null!=t){let{data:e,error:a}=await (0,y.gz)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:s}},body:{type:t.type,value:t.value,country:t.country}});return a&&(0,y.S3)(a),e}{let{data:e,error:t}=await (0,y.IV)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:s}},headers:{Version:"2"}});return t&&(0,y.S3)(t),e}}let sM=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>sD(e),{async onSuccess(s,t,n){let{slug:i}=t;a.setQueryData(N.O.taxId(i),s.tax_id),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update tax id: ".concat(e.message)):s(e,t,a)},...t})};var sU=t(22574),sF=t(62949),sY=t(42070);let sG=[{name:"AE TRN",type:"ae_trn",country:"United Arab Emirates",placeholder:"123456789012345",countryIso2:"AE"},{name:"AT VAT",type:"eu_vat",country:"Austria",placeholder:"ATU12345678",vatPrefix:"ATU",countryIso2:"AT"},{name:"AD NRT",type:"ad_nrt",country:"Andorra",placeholder:"A-123456-Z",countryIso2:"AD"},{name:"AR CUIT",type:"ar_cuit",country:"Argentina",placeholder:"12-3456789-01",countryIso2:"AR"},{name:"AU ABN",type:"au_abn",country:"Australia",placeholder:"12345678912",countryIso2:"AU"},{name:"AU ARN",type:"au_arn",country:"Australia",placeholder:"123456789123",countryIso2:"AU"},{name:"BE VAT",type:"eu_vat",country:"Belgium",placeholder:"BE0123456789",vatPrefix:"BE",countryIso2:"BE"},{name:"BO TIN",type:"bo_tin",country:"Bolivia",placeholder:"123456789",countryIso2:"BO"},{name:"BG VAT",type:"eu_vat",country:"Bulgaria",placeholder:"BG0123456789",vatPrefix:"BG",countryIso2:"BG"},{name:"BR CNPJ",type:"br_cnpj",country:"Brazil",placeholder:"01.234.456/5432-10",countryIso2:"BR"},{name:"BR CPF",type:"br_cpf",country:"Brazil",placeholder:"123.456.789-87",countryIso2:"BR"},{name:"CA BN",type:"ca_bn",country:"Canada",placeholder:"123456789",countryIso2:"CA"},{name:"CA GST/HST",type:"ca_gst_hst",country:"Canada",placeholder:"123456789RT0002",countryIso2:"CA"},{name:"CA PST-BC",type:"ca_pst_bc",country:"Canada",placeholder:"PST-1234-5678",countryIso2:"CA"},{name:"CA PST-MB",type:"ca_pst_mb",country:"Canada",placeholder:"123456-7",countryIso2:"CA"},{name:"CA PST-SK",type:"ca_pst_mb",country:"Canada",placeholder:"1234567",countryIso2:"CA"},{name:"CA QST",type:"ca_qst",country:"Canada",placeholder:"1234567890TQ1234",countryIso2:"CA"},{name:"CH VAT",type:"ch_vat",country:"Switzerland",placeholder:"CHE-123.456.789 MWST",vatPrefix:"CHE",countryIso2:"CH"},{name:"CL TIN",type:"cl_tin",country:"Chile",placeholder:"12.345.678-K",countryIso2:"CL"},{name:"CN TIN",type:"cn_tin",country:"China",placeholder:"123456789012345678",countryIso2:"CN"},{name:"CO NIT",type:"co_nit",country:"Colombia",placeholder:"123.456.789-0",countryIso2:"CO"},{name:"CR TIN",type:"cr_tin",country:"Costa Rica",placeholder:"1-234-567890",countryIso2:"CR"},{name:"CY VAT",type:"eu_vat",country:"Cyprus",placeholder:"CY12345678Z",vatPrefix:"CY",countryIso2:"CY"},{name:"CZ VAT",type:"eu_vat",country:"Czech Republic",placeholder:"CZ1234567890",vatPrefix:"CZ",countryIso2:"CZ"},{name:"DE VAT",type:"eu_vat",country:"Germany",placeholder:"DE123456789",vatPrefix:"DE",countryIso2:"DE"},{name:"DK VAT",type:"eu_vat",country:"Denmark",placeholder:"DK12345678",vatPrefix:"DK",countryIso2:"DK"},{name:"DO RCN",type:"do_rcn",country:"Dominican Republic",placeholder:"123-4567890-1",countryIso2:"DO"},{name:"EE VAT",type:"eu_vat",country:"Estonia",placeholder:"EE123456789",vatPrefix:"EE",countryIso2:"EE"},{name:"ES CIF",type:"es_cif",country:"Spain",placeholder:"A12345678",countryIso2:"ES"},{name:"ES VAT",type:"eu_vat",country:"Spain",placeholder:"ESX1234567Z",vatPrefix:"ES",countryIso2:"ES"},{name:"FI VAT",type:"eu_vat",country:"Finland",placeholder:"FI12345678",vatPrefix:"FI",countryIso2:"FI"},{name:"FR VAT",type:"eu_vat",country:"France",placeholder:"FRAB123456789",vatPrefix:"FR",countryIso2:"FR"},{name:"GB VAT",type:"eu_vat",country:"United Kingdom",placeholder:"GB123456789",vatPrefix:"GB",countryIso2:"GB"},{name:"GE VAT",type:"ge_vat",country:"Georgia",placeholder:"123456789",countryIso2:"GE"},{name:"EL VAT",type:"eu_vat",country:"Greece",countryIso2:"GR",placeholder:"EL123456789",vatPrefix:"EL"},{name:"HK BR",type:"hk_br",country:"Hong Kong SAR China",placeholder:"12345678",countryIso2:"HK"},{name:"HR VAT",type:"eu_vat",country:"Croatia",placeholder:"HR12345678912",vatPrefix:"HR",countryIso2:"HR"},{name:"HU VAT",type:"eu_vat",country:"Hungary",placeholder:"HU12345678912",vatPrefix:"HU",countryIso2:"HU"},{name:"ID NPWP",type:"id_npwp",country:"Indonesia",placeholder:"12.345.678.9-012.345",countryIso2:"ID"},{name:"IE VAT",type:"eu_vat",country:"Ireland",placeholder:"IE1234567AB",vatPrefix:"IE",countryIso2:"IE"},{name:"IL VAT",type:"il_vat",country:"Israel",placeholder:"000012345",countryIso2:"IL"},{name:"IN GST",type:"in_gst",country:"India",placeholder:"12ABCDE3456FGZH",countryIso2:"IN"},{name:"IS VAT",type:"is_vat",country:"Iceland",placeholder:"123456",countryIso2:"IS"},{name:"IT VAT",type:"eu_vat",country:"Italy",placeholder:"IT12345678912",vatPrefix:"IT",countryIso2:"IT"},{name:"JP CN",type:"jp_cn",country:"Japan",placeholder:"1234567891234",countryIso2:"JP"},{name:"KE PIN",type:"ke_pin",country:"Kenya",placeholder:"P000111111A",countryIso2:"KE"},{name:"JP RN",type:"jp_rn",country:"Japan",placeholder:"12345",countryIso2:"JP"},{name:"KR BRN",type:"kr_brn",country:"Korea",placeholder:"123-45-67890",countryIso2:"Kr"},{name:"LI UID",type:"li_uid",country:"Liechtenstein",placeholder:"CHE123456789",countryIso2:"LI"},{name:"LT VAT",type:"eu_vat",country:"Lithuania",placeholder:"LT123456789123",vatPrefix:"LT",countryIso2:"LT"},{name:"LU VAT",type:"eu_vat",country:"Luxembourg",placeholder:"LU12345678",vatPrefix:"LU",countryIso2:"LU"},{name:"LV VAT",type:"eu_vat",country:"Latvia",placeholder:"LV12345678912",vatPrefix:"LV",countryIso2:"LV"},{name:"MT VAT",type:"eu_vat",country:"Malta",placeholder:"MT12345678",vatPrefix:"MT",countryIso2:"MT"},{name:"MX RFC",type:"mx_rfc",country:"Mexico",placeholder:"ABC010203AB9",countryIso2:"MX"},{name:"MY FRP",type:"my_frp",country:"Malaysia",placeholder:"12345678",countryIso2:"MY"},{name:"MY ITN",type:"my_itn",country:"Malaysia",placeholder:"C 1234567890",countryIso2:"MY"},{name:"MY SST",type:"my_sst",country:"Malaysia",placeholder:"A12-3456-78912345",countryIso2:"MY"},{name:"NL VAT",type:"eu_vat",country:"Netherlands",placeholder:"NL123456789B12",vatPrefix:"NL",countryIso2:"NL"},{name:"NO VAT",type:"no_vat",country:"Norway",placeholder:"123456789MVA",countryIso2:"NO"},{name:"PE RUC",type:"pe_ruc",country:"Peru",placeholder:"12345678901",countryIso2:"PE"},{name:"PH TIN",type:"ph_tin",country:"Philippines",placeholder:"123456789012",countryIso2:"PH"},{name:"NZ GST",type:"nz_gst",country:"New Zealand",placeholder:"123456789",countryIso2:"NZ"},{name:"PL VAT",type:"eu_vat",country:"Poland",placeholder:"PL1234567890",vatPrefix:"PL",countryIso2:"PL"},{name:"PT VAT",type:"eu_vat",country:"Portugal",placeholder:"PT123456789",vatPrefix:"PT",countryIso2:"PT"},{name:"RO VAT",type:"eu_vat",country:"Romania",placeholder:"RO1234567891",vatPrefix:"RO",countryIso2:"RO"},{name:"RU INN",type:"ru_inn",country:"Russia",placeholder:"1234567891",countryIso2:"RU"},{name:"RU KPP",type:"ru_kpp",country:"Russia",placeholder:"123456789",countryIso2:"RU"},{name:"SA VAT",type:"sa_vat",country:"Saudi Arabia",placeholder:"123456789012345",countryIso2:"SA"},{name:"RS PIB",type:"rs_pib",country:"Serbia",placeholder:"123456789",countryIso2:"RS"},{name:"SE VAT",type:"eu_vat",country:"Sweden",placeholder:"SE123456789123",vatPrefix:"SE",countryIso2:"SE"},{name:"SG GST",type:"sg_gst",country:"Singapore",placeholder:"M12345678X",countryIso2:"SG"},{name:"SG UEN",type:"sg_uen",country:"Singapore",placeholder:"123456789F",countryIso2:"SG"},{name:"SI VAT",type:"eu_vat",country:"Slovenia",placeholder:"SI12345678",vatPrefix:"SI",countryIso2:"SI"},{name:"SK VAT",type:"eu_vat",country:"Slovakia",placeholder:"SK1234567891",vatPrefix:"SK",countryIso2:"SK"},{name:"TH VAT",type:"th_vat",country:"Thailand",placeholder:"1234567891234",countryIso2:"TH"},{name:"TR TIN",type:"tr_tin",country:"Turkey",placeholder:"0123456789",countryIso2:"TR"},{name:"TW VAT",type:"tw_vat",country:"Taiwan",placeholder:"12345678",countryIso2:"TW"},{name:"UA VAT",type:"ua_vat",country:"Ukraine",placeholder:"123456789",countryIso2:"UA"},{name:"US EIN",type:"us_ein",country:"United States",placeholder:"12-3456789",countryIso2:"US"},{name:"XI VAT",type:"eu_vat",country:"United Kingdom (Northern Ireland)",placeholder:"XI123456789",vatPrefix:"XI",countryIso2:"GB"},{name:"ZA VAT",type:"za_vat",country:"South Africa",placeholder:"4123456789",countryIso2:"ZA"},{name:"UY RUC",type:"uy_ruc",country:"Uruguay",placeholder:"123456789012",countryIso2:"UY"},{name:"VE RIF",type:"ve_rif",country:"Venezuela",placeholder:"A-12345678-9",countryIso2:"VE"},{name:"VN TIN",type:"vn_tin",country:"Vietnam",placeholder:"1234567890",countryIso2:"VN"}],sB=e=>{let s=sG.find(s=>s.name===e.name),t=null==s?void 0:s.vatPrefix;return t&&!e.value.startsWith(t)?"".concat(t).concat(e.value):e.value},sV=(e,s)=>(null==e?void 0:e.type)===(null==s?void 0:s.type)&&(null==e?void 0:e.value)===(null==s?void 0:s.value);var sq=()=>{var e,s;let{slug:t}=(0,r.UO)(),{data:a,error:n,isLoading:o,isSuccess:d,isError:x}=sL({slug:t}),{mutate:g,isLoading:f}=sM({onSuccess:()=>{m.ZP.success("Successfully updated tax id")}}),y=sP.Ry({type:sP.Z_(),value:sP.Z_(),name:sP.Z_()}),N=(0,sT.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,sE.F)(y),defaultValues:{type:"",value:"",name:""}}),w=a?{type:a.type,value:a.value,name:null!==(s=null===(e=sG.find(e=>e.type===a.type&&e.countryIso2===a.country))||void 0===e?void 0:e.name)&&void 0!==s?s:""}:{type:"",value:"",name:""},S=!sV(N.getValues(),w),_=(0,b.Xo)(c.KA.BILLING_READ,"stripe.tax_ids"),C=(0,b.Xo)(c.KA.BILLING_WRITE,"stripe.tax_ids");(0,u.useEffect)(()=>{d&&w&&(N.setValue("type",w.type),N.setValue("value",w.value),N.setValue("name",w.name))},[d]);let Z=async()=>{if(!t)return console.error("Slug is required");let{type:e,value:s}=N.getValues();if((null==e?void 0:e.length)&&!(null==s?void 0:s.length)){N.setError("value",{message:"Value is required"});return}g({slug:t,taxId:(null==e?void 0:e.length)&&(null==s?void 0:s.length)?{type:e,value:sB({value:s,name:N.getValues().name}),country:null==k?void 0:k.countryIso2}:null})},I=()=>{N.setValue("type",w.type),N.setValue("value",w.value),N.setValue("name",w.name)},A=e=>{let s=sG.find(s=>s.name===e);s&&(N.setValue("type",s.type),N.setValue("value",""),N.setValue("name",e))},z=()=>{N.reset()},{name:E}=N.watch(),k=sG.find(e=>e.name===E);return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Tax ID"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light pr-4 m-0",children:"Add a tax ID to your invoices. Changes only apply to future invoices."}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Make sure the tax ID looks exactly like the placeholder text."})]})}),(0,i.jsx)(l.Lc,{children:_?(0,i.jsxs)(i.Fragment,{children:[o&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),x&&(0,i.jsx)(h.Z,{error:n,subject:"Failed to retrieve organization tax Id"}),d&&(0,i.jsx)(sO.Z,{className:"mb-8",footer:(0,i.jsx)(p.i,{form:"tax-id-form",isSubmitting:f,hasChanges:S,handleReset:()=>I(),helper:C?void 0:"You need additional permissions to manage this organization's tax ID"}),children:(0,i.jsx)(sU.l0,{...N,children:(0,i.jsxs)("form",{id:"tax-id-form",className:"grid grid-cols-2 gap-2 w-full py-8 px-8 items-center",onSubmit:N.handleSubmit(()=>Z()),children:[(0,i.jsx)(sU.Wi,{name:"name",control:N.control,render:e=>{let{field:s}=e;return(0,i.jsx)(sU.xJ,{children:(0,i.jsx)(sU.NI,{children:(0,i.jsxs)(sF.Ph,{...s,disabled:!C,value:s.value,onValueChange:e=>A(e),children:[(0,i.jsx)(sF.i4,{children:(0,i.jsx)(sF.ki,{placeholder:"None"})}),(0,i.jsx)(sF.Bw,{children:(0,i.jsx)(sF.DI,{children:sG.sort((e,s)=>e.country.localeCompare(s.country)).map(e=>(0,i.jsxs)(sF.Ql,{value:e.name,children:[e.country," - ",e.name]},e.name))})})]})})})}}),k&&(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(sU.Wi,{name:"value",control:N.control,render:e=>{let{field:s}=e;return(0,i.jsx)(sU.xJ,{className:"w-full",children:(0,i.jsx)(sU.NI,{children:(0,i.jsx)(sY.I,{...s,placeholder:null==k?void 0:k.placeholder,disabled:!C})})})}}),(0,i.jsx)(Y.z,{type:"text",className:"px-1",icon:(0,i.jsx)(sk.Z,{}),onClick:()=>z()})]})]})})})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's tax ID"})})]})},sW=()=>{var e;let{billingAccountData:s,billingPaymentMethods:t,billingCredits:a}=(0,o.N)(["billing:account_data","billing:payment_methods","billing:credits"]),{slug:n}=(0,r.UO)(),{data:c}=(0,d.G)({orgSlug:n}),u=!(null==c?void 0:c.billing_via_partner),m=s&&u,h=t&&u;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{id:"subscription",children:(0,i.jsx)(sz,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"cost-control",children:(0,i.jsx)(ek,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"breakdown",children:(0,i.jsx)(et,{})}),a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"credits-balance",children:(0,i.jsx)(eP,{})})]}),h&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"payment-methods",children:(0,i.jsx)(eQ,{})})]}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"email",children:(0,i.jsx)(el,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"address",children:(0,i.jsx)(T,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"taxId",children:(0,i.jsx)(sq,{})})]})]})},sH=t(46216),sX=t(22854),sK=t(28414);async function sQ(e){let{slug:s}=e,{data:t,error:a}=await (0,y.IV)("/platform/organizations/{slug}",{params:{path:{slug:s}}});return a&&(0,y.S3)(a),t}let sJ=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>sQ(e),{async onSuccess(s,t,n){await Promise.all([a.invalidateQueries(N.O.list()),a.invalidateQueries(sK.F.list())]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to delete organization: ".concat(e.message)):s(e,t,a)},...t})};var s$=()=>{let e=(0,e5.useRouter)(),s=(0,er.l)(),{slug:t,name:a}=null!=s?s:{},[n,r]=(0,u.useState)(!1),[l,o]=(0,u.useState)(""),d=(0,b.Xo)(c.KA.UPDATE,"organizations"),{mutate:h,isLoading:p}=sJ({onSuccess:()=>{m.ZP.success("Successfully deleted ".concat(a)),e.push("/projects")}}),x=async e=>d?t?void h({slug:t}):console.error("Org slug is required"):m.ZP.error("You do not have the required permissions to delete this organization");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(Y.z,{loading:!t,onClick:()=>r(!0),type:"danger",children:"Delete organization"})}),(0,i.jsx)(eB.Z,{closable:!0,hideFooter:!0,size:"small",visible:n,onCancel:()=>r(!1),header:(0,i.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,i.jsx)("span",{children:"Delete organization"}),(0,i.jsx)("span",{className:"text-xs text-foreground-lighter",children:"Are you sure?"})]}),children:(0,i.jsx)(A.Z,{validateOnBlur:!0,initialValues:{orgName:""},onSubmit:x,validate:e=>{let s={};return e.orgName||(s.orgName="Enter the name of the organization."),e.orgName!==t&&(s.orgName="Value entered does not match the value above."),s},children:()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["This action ",(0,i.jsx)("span",{className:"text-foreground",children:"cannot"})," be undone. This will permanently delete the ",(0,i.jsx)("span",{className:"text-foreground",children:a})," ","organization and remove all of its projects."]})}),(0,i.jsx)(eB.Z.Separator,{}),(0,i.jsx)(eB.Z.Content,{children:(0,i.jsx)(z.Z,{id:"orgName",label:(0,i.jsxs)("span",{children:["Please type ",(0,i.jsx)("span",{className:"font-bold",children:t})," to confirm"]}),onChange:e=>o(e.target.value),value:l,placeholder:"Enter the string above",className:"w-full"})}),(0,i.jsx)(eB.Z.Separator,{}),(0,i.jsx)(eB.Z.Content,{children:(0,i.jsx)(Y.z,{block:!0,size:"small",type:"danger",htmlType:"submit",loading:p,disabled:p,children:"I understand, delete this organization"})})]})})})]})},s0=()=>(0,i.jsx)(sO.Z,{title:(0,i.jsx)("p",{className:"uppercase",children:"Danger Zone"},"panel-title"),children:(0,i.jsx)(sO.Z.Content,{children:(0,i.jsxs)(ey.bZ,{variant:"destructive",children:[(0,i.jsx)(e0.ku,{}),(0,i.jsx)(ey.Cd,{children:"Deleting this organization will also remove its projects"}),(0,i.jsx)(ey.X,{children:"Make sure you have made a backup if you want to keep your data"}),(0,i.jsx)(s$,{})]})})}),s2=()=>{let{slug:e}=(0,r.UO)(),s=(0,_.NL)(),[t,a]=(0,u.useState)(!1),n=(0,er.l)(),{name:d,opt_in_tags:h}=null!=n?n:{},j="org-general-settings",v=null==h?void 0:h.includes(ej.PV.AI_SQL),f=(0,o.N)("organizations:delete"),y=(0,b.Xo)(c.KA.UPDATE,"organizations"),N=(0,b.Xo)(c.KA.UPDATE,"organizations"),{mutate:w,isLoading:S}=en(),C=async(t,a)=>{var i;let{resetForm:r}=a;if(!y)return m.ZP.error("You do not have the required permissions to update this organization");if(!e)return console.error("Slug is required");let l=null!==(i=null==n?void 0:n.opt_in_tags)&&void 0!==i?i:[],o=t.isOptedIntoAi&&!l.includes(ej.PV.AI_SQL)?l.concat([ej.PV.AI_SQL]):!t.isOptedIntoAi&&l.includes(ej.PV.AI_SQL)?l.filter(e=>e!==ej.PV.AI_SQL):l;w({slug:e,name:t.name,opt_in_tags:o},{onSuccess:()=>{r({values:t,initialValues:t}),(0,ei.aL)(s),m.ZP.success("Successfully saved settings")}})};return(0,i.jsxs)(l.gW,{children:[(0,i.jsx)(sH.Z,{organization:n}),(0,i.jsx)(A.Z,{id:j,initialValues:{name:null!=d?d:"",isOptedIntoAi:v},onSubmit:C,children:e=>{let{handleReset:s,values:r,initialValues:l,resetForm:o}=e,c=JSON.stringify(r)!==JSON.stringify(l);return(0,u.useEffect)(()=>{let e={name:null!=d?d:"",isOptedIntoAi:v};o({values:e,initialValues:e})},[null==n?void 0:n.slug]),(0,i.jsx)(x.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(p.i,{form:j,isSubmitting:S,hasChanges:c,handleReset:s,helper:y?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,i.jsx)(g.hj,{header:(0,i.jsx)(g.S0,{children:"General settings"}),children:(0,i.jsxs)(g.B4,{loading:!1,children:[(0,i.jsx)(z.Z,{id:"name",size:"small",label:"Organization name",disabled:!y}),(0,i.jsx)(z.Z,{copy:!0,disabled:!0,id:"slug",size:"small",label:"Organization slug",value:null==n?void 0:n.slug}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)(sX.Z,{id:"isOptedIntoAi",name:"isOptedIntoAi",disabled:!y,size:"small",label:"Opt-in to sending anonymous data to OpenAI",descriptionText:"By opting into sending anonymous data, Supabase AI can improve the answers it shows you"}),(0,i.jsxs)(G.ZP,{open:t,onOpenChange:a,children:[(0,i.jsx)(G.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 ml-16 cursor-pointer",children:[(0,i.jsx)(B.Z,{strokeWidth:2,size:16,className:(0,eA.cn)("transition-all",t?"rotate-90":"")}),(0,i.jsx)("p",{className:"text-sm text-foreground-light underline",children:"Important information regarding opting in"})]})}),(0,i.jsx)(G.ZP.Content,{children:(0,i.jsxs)("div",{className:"space-y-2 py-4 ml-16 text-sm text-foreground-light",children:[(0,i.jsx)("p",{children:"Supabase AI is a chatbot support tool powered by OpenAI. Supabase will share the query you submit and information about the databases you manage through Supabase with OpenAI, L.L.C. and its affiliates in order to provide the Supabase AI tool."}),(0,i.jsx)("p",{children:"OpenAI will only access information about the structure of your databases, such as table names, column and row headings. OpenAI will not access the contents of the database itself."}),(0,i.jsx)("p",{children:"OpenAI uses this information to generate responses to your query, and does not retain or use the information to train its algorithms or otherwise improve its products and services."}),(0,i.jsx)("p",{children:"If you have your own individual account on Supabase, we will use any personal information collected through [Supabase AI] to provide you with the [Supabase AI] tool. If you are in the UK, EEA or Switzerland, the processing of this personal information is necessary for the performance of a contract between you and us."}),(0,i.jsx)("p",{children:"Supabase collects information about the queries you submit through Supabase AI and the responses you receive to assess the performance of the Supabase AI tool and improve our services. If you are in the UK, EEA or Switzerland, the processing is necessary for our legitimate interests, namely informing our product development and improvement."}),(0,i.jsxs)("p",{children:["For more information about how we use personal information, please see our"," ",(0,i.jsx)(L(),{href:"https://supabase.com/privacy",target:"_blank",rel:"noreferrer",className:"text-brand border-b border-brand",children:"privacy policy"}),"."]})]})})]})]})]})})})}}),f&&N&&(0,i.jsx)(s0,{})]})},s1=t(84247),s4=t(80435),s3=t(55579),s5=t(40624),s6=t(16014),s8=t(61660),s7=t(11881),s9=t(26205),te=t(47342),ts=t(36660),tt=t(78855);let ta=e=>{let{title:s}=e;return(0,i.jsx)("img",{className:"border rounded-lg shadow w-48 mt-6 border-body",src:"".concat(ej.GW,"/img/integrations/covers/").concat(s,"-cover.png"),alt:"".concat(s," cover")})};var tn=()=>{let e=(0,er.l)(),s=(0,eg.P)("branchManagement"),t=(0,b.Xo)(c.KA.READ,"integrations.github_connections"),a=(0,b.Xo)(c.KA.CREATE,"integrations.github_connections"),n=(0,b.Xo)(c.KA.UPDATE,"integrations.github_connections"),{data:r}=(0,s5.x)(),{data:o}=(0,s8.q)({organizationId:null==e?void 0:e.id}),{mutate:d}=(0,s6.n)({onSuccess:()=>{m.ZP.success("Successfully deleted Github connection")}}),h=(0,s9.x5)(),p=(0,u.useCallback)(()=>{h.setGithubConnectionsOpen(!0)},[h]),x=(0,u.useCallback)(async s=>{if(!(null==e?void 0:e.id)){m.ZP.error("Organization not found");return}d({connectionId:s.id,organizationId:e.id})},[d,null==e?void 0:e.id]),g=r?"You are authorized with Supabase GitHub App. You can configure your GitHub App installations and repository access [here](".concat(s7.Xw,"). You can revoke your authorization [here](").concat(s7.H4,")."):"";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(()=>(0,i.jsx)(l._S,{children:(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{title:"GitHub Connections",children:[(0,i.jsx)(s4.U,{content:"\nConnect any of your GitHub repositories to a project.\n"}),(0,i.jsx)(ta,{title:"github"})]}),(0,i.jsx)(l.Lc,{children:t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s4.U,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),(0,i.jsx)("ul",{className:"flex flex-col gap-y-2",children:null==o?void 0:o.map(e=>{var s,t,a,r,l;return(0,i.jsx)(te.z,{disabled:!n,connection:{id:String(e.id),added_by:{id:String(null===(s=e.user)||void 0===s?void 0:s.id),primary_email:null!==(r=null===(t=e.user)||void 0===t?void 0:t.primary_email)&&void 0!==r?r:"",username:null!==(l=null===(a=e.user)||void 0===a?void 0:a.username)&&void 0!==l?l:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:x},e.id)})}),s?(0,i.jsx)(s1.FP,{onClick:p,orgSlug:null==e?void 0:e.slug,showNode:!1,disabled:!a,children:"Add new project connection"}):(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["Access to"," ",(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/branching",target:"_blank",rel:"noreferrer",className:"text-foreground",children:"branching"})," ","is required to add GitHub connections."]}),g&&(0,i.jsx)(s4.U,{extLinks:!0,content:g,className:"text-foreground-lighter"})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's GitHub connections"})})]})}),{}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(s3.Z,{isProjectScoped:!1}),(0,i.jsx)(tt.Z,{}),(0,i.jsx)(ts.Z,{})]})};(a=n||(n={})).DRAFT="draft",a.PAID="paid",a.VOID="void",a.UNCOLLECTIBLE="uncollectible",a.OPEN="open",a.ISSUED="issued";let ti={[n.DRAFT]:{label:"Upcoming",badgeVariant:"warning"},[n.PAID]:{label:"Paid",badgeVariant:"brand"},[n.VOID]:{label:"Forgiven",badgeVariant:"brand"},[n.UNCOLLECTIBLE]:{label:"Outstanding",badgeVariant:"destructive"},[n.OPEN]:{label:"Outstanding",badgeVariant:"destructive"},[n.ISSUED]:{label:"Outstanding",badgeVariant:"destructive"}};var tr=e=>{let{status:s}=e,t=ti[s];return(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{children:(0,i.jsx)(eT.C,{size:"small",className:"capitalize",variant:(null==t?void 0:t.badgeVariant)||"default",children:(null==t?void 0:t.label)||s})}),(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:[[n.OPEN,n.UNCOLLECTIBLE].includes(s)&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:'We were not able to collect the money. Make sure you have a valid payment method and enough funds. Outstanding invoices may cause restrictions. You can manually pay the using the "Pay Now" button.'}),s===n.DRAFT&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"The invoice will soon be finalized and charged for."}),s===n.PAID&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"The invoice has been paid successfully. No action is required on your side."}),s===n.VOID&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"This invoice has been forgiven. No action is required on your side."})]})]})})]})};async function tl(e,s){let{invoiceId:t,slug:a}=e;if(!t)throw Error("Invoice ID is required");if(!a)throw Error("Slug is required");let{data:n,error:i}=await (0,y.U2)("/platform/organizations/{slug}/billing/invoices/{invoiceId}",{params:{path:{invoiceId:t,slug:a}},signal:s});return i&&(0,y.S3)(i),n}async function to(e,s){let{slug:t}=e;if(!t)throw Error("Slug is required");let a=await (0,y.YM)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:t}},signal:s,parseAs:"text"});if(a.error)throw a.error;return Number(a.response.headers.get("X-Total-Count"))}let td=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(M.Y.count(s),e=>{let{signal:t}=e;return to({slug:s},t)},{enabled:t&&void 0!==s,...a})};async function tc(e,s){let{slug:t,offset:a=0,limit:n=10}=e;if(!t)throw Error("Org slug is required");let{data:i,error:r}=await (0,y.U2)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:t},query:{offset:a.toString(),limit:n.toString()}},signal:s});return r&&(0,y.S3)(r),i}let tu=function(e){let{slug:s,offset:t,limit:a}=e,{enabled:n=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(M.Y.list(s,t),e=>{let{signal:n}=e;return tc({slug:s,offset:t,limit:a},n)},{enabled:n&&void 0!==s,...i})};var tm=t(49639),th=t(23418),tp=t(52253),tx=()=>{let[e,s]=(0,u.useState)(1),t=(0,er.l)(),{slug:a}=null!=t?t:{},r=(e-1)*10,o=(0,b.Xo)(c.KA.READ,"invoices"),{data:d,isError:p}=td({slug:a}),{data:x,error:g,isLoading:f,isError:y,isSuccess:N}=tu({slug:a,offset:r,limit:10}),w=x||[];(0,u.useEffect)(()=>{s(1)},[a]);let S=async e=>{try{let s=await tl({invoiceId:e,slug:a});(null==s?void 0:s.invoice_pdf)&&window.open(s.invoice_pdf,"_blank")}catch(e){m.ZP.error("Failed to fetch the selected invoice: ".concat(e.message))}};return o?(0,i.jsxs)(l.gW,{children:[f&&(0,i.jsx)(v.A,{}),y&&(0,i.jsx)(h.Z,{error:g,subject:"Failed to retrieve invoices"}),N&&(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{},"header-icon"),(0,i.jsx)(eN.Z.th,{children:"Date"},"header-date"),(0,i.jsx)(eN.Z.th,{children:"Amount"},"header-amount"),(0,i.jsx)(eN.Z.th,{children:"Invoice number"},"header-invoice"),(0,i.jsx)(eN.Z.th,{className:"flex items-center",children:"Status"},"header-status"),(0,i.jsx)(eN.Z.th,{className:"text-right"},"header-download")],body:0===w.length?(0,i.jsx)(eN.Z.tr,{children:(0,i.jsx)(eN.Z.td,{colSpan:6,className:"p-3 py-12 text-center",children:(0,i.jsx)("p",{className:"text-foreground-light",children:f?"Checking for invoices":"No invoices for this organization yet"})})}):(0,i.jsxs)(i.Fragment,{children:[w.map(e=>(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)(tm.Z,{size:"xxl"})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{children:O()(1e3*e.period_end).format("MMM DD, YYYY")})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{children:(0,J.xG)(e.subtotal/100)})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{children:e.number})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)(tr,{status:e.status})}),(0,i.jsx)(eN.Z.td,{className:"align-right",children:(0,i.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[e.subtotal>0&&[n.UNCOLLECTIBLE,n.OPEN,n.ISSUED].includes(e.status)&&(0,i.jsx)(Y.z,{asChild:!0,children:(0,i.jsx)(L(),{href:"https://redirect.revops.supabase.com/pay-invoice/".concat(e.id),target:"_blank",rel:"noreferrer",children:"Pay Now"})}),(0,i.jsx)(Y.z,{type:"outline",icon:(0,i.jsx)(th.Z,{size:16,strokeWidth:1.5}),onClick:()=>S(e.id)})]})})]},e.id)),(0,i.jsx)(eN.Z.tr,{children:(0,i.jsx)(eN.Z.td,{colSpan:6,children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"text-sm opacity-50",children:p?"Failed to retrieve total number of invoices":"Showing ".concat(r+1," to ").concat(r+w.length," out of ").concat(d," invoices")}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(Y.z,{icon:(0,i.jsx)(tp.Z,{}),type:"default",size:"tiny",disabled:1===e,onClick:async()=>s(e-1)}),(0,i.jsx)(Y.z,{icon:(0,i.jsx)(B.Z,{}),type:"default",size:"tiny",disabled:10*e>=(null!=d?d:0),onClick:async()=>s(e+1)})]})]})})},"navigation")]})})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view invoices"})})},tg=t(66432),tj=t(66855),tv=e=>{let{visible:s,onHide:t}=e;return(0,i.jsxs)(eB.Z,{hideFooter:!0,visible:s,size:"xlarge",header:"Spend cap",onCancel:()=>t(),children:[(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Enabling the spend cap sets a limit on your usage to stay within your plan's quota, which controls costs but can limit service. Disabling the spend cap removes these limits, but any extra usage beyond the plan's limit will be charged per usage."}),(0,i.jsx)("p",{className:"text-sm",children:"Take a look at the following table to see which resources are chargeable and how they are charged:"}),(0,i.jsxs)("div",{className:"border rounded border-control bg-overlay-hover",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm text-foreground-light",children:"Item"}),(0,i.jsx)("p",{className:"w-[25%] text-sm text-foreground-light",children:"Limit"}),(0,i.jsx)("p",{className:"w-[25%] text-sm text-foreground-light",children:"Rate"})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Database size"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"8GB"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.125 per GB"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Egress"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"250GB"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.09 per GB"})]})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsxs)("div",{className:"flex w-[50%] items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Auth MAUs"}),(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{children:(0,i.jsx)(tj.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100"})}),(0,i.jsx)(q.h_,{children:(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"Monthly Active Users: A user that has made an API request in the last month"})})]})})})]})]}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"100,000"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.00325 per user"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsxs)("div",{className:"flex w-[50%] items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Single Sign-On (SAML 2.0) MAUs"}),(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{children:(0,i.jsx)(tj.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100"})}),(0,i.jsx)(q.h_,{children:(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"Single Sign-On Monthly Active Users: A user that has made an API request in the last month"})})]})})})]})]}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"50"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.015 per user"})]})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Storage size"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"100GB"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.021 per GB"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Storage Image Transformations"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"100 origin images"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$5 per 1000 origin images"})]})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Realtime concurrent peak connections"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"500"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$10 per 1000"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Realtime messages"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"5 Million"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$2.50 per Million"})]})]}),(0,i.jsx)("div",{className:"py-2",children:(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Function invocations"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"2 Million"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$2 per Million"})]})})]}),(0,i.jsxs)("p",{className:"text-sm",children:["See"," ",(0,i.jsx)(L(),{href:"https://supabase.com/pricing",className:"text-brand",target:"_blank",rel:"noreferrer",children:(0,i.jsx)("span",{children:"pricing page"})})," ","for a full overview."]})]})}),(0,i.jsx)(eB.Z.Separator,{}),(0,i.jsx)(eB.Z.Content,{children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(Y.z,{block:!0,type:"primary",onClick:()=>t(),children:"Understood"})})})]})},tf=t(78388),ty=t(62795);let tb={PERSONAL:"Personal",EDUCATIONAL:"Educational",STARTUP:"Startup",AGENCY:"Agency",COMPANY:"Company",UNDISCLOSED:"N/A"},tN={1:"1 - 10",10:"10 - 49",50:"50 - 99",100:"100 - 299",300:"More than 300"};var tw=e=>{let{onPaymentMethodReset:s}=e,t=(0,e5.useRouter)(),a=(0,tg.useStripe)(),n=(0,tg.useElements)(),l=(0,_.NL)(),{plan:o,name:d,kind:c,size:h,spend_cap:p}=(0,r.UO)(),[x,g]=(0,u.useState)(d||""),[j,v]=(0,u.useState)(c&&Object.keys(tb).includes(c)?c:"PERSONAL"),[f,y]=(0,u.useState)(h||"1"),[b,N]=(0,u.useState)(!1),[w,S]=(0,u.useState)(),[C,Z]=(0,u.useState)(o&&["free","team","pro"].includes(o)?o.toUpperCase():"FREE"),[I,A]=(0,u.useState)(!1),[k,T]=(0,u.useState)(!p||!!p);(0,u.useEffect)(()=>{let e={};e.plan=C.toLowerCase(),x&&(e.name=x),j&&(e.kind=j),f&&(e.size=f),k&&(e.spend_cap=k.toString()),t.push({query:e})},[C,x,j,f,k]);let{mutate:P}=(0,tf.T)({onSuccess:async e=>{await (0,ei.aL)(l),t.push("/new/".concat(e.slug))},onError:()=>{L(),N(!1)}});async function O(e){P({name:x,kind:j,tier:"tier_"+("PRO"!==C||k?C:"PAYG").toLowerCase(),..."COMPANY"==j?{size:f}:{},payment_method:e})}let R=async e=>{var s;if(e.preventDefault(),!((x?x.trim():"").length>=1))return m.ZP.error("Organization name is empty");if(!a||!n)return console.error("Stripe.js has not loaded");if(N(!0),"FREE"===C)await O();else if(w)O(w.id);else{let{error:e,setupIntent:t}=await a.confirmSetup({elements:n,redirect:"if_required",confirmParams:{return_url:"".concat((0,J.Ax)(),"/new"),expand:["payment_method"]}});if(e||!t.payment_method){m.ZP.error(null!==(s=null==e?void 0:e.message)&&void 0!==s?s:" Failed to save card details"),N(!1);return}let i=t.payment_method;S(i),O(i.id)}},L=()=>(S(void 0),s());return(0,i.jsx)("form",{onSubmit:R,children:(0,i.jsxs)(sO.Z,{title:(0,i.jsx)("div",{children:(0,i.jsx)("h4",{children:"Create a new organization"})},"panel-title"),footer:(0,i.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,i.jsx)(Y.z,{type:"default",disabled:b,onClick:()=>t.push("/projects"),children:"Cancel"}),(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("p",{className:"text-xs text-foreground-lighter",children:"You can rename your organization later"}),(0,i.jsx)(Y.z,{htmlType:"submit",type:"primary",loading:b,disabled:b,children:"Create organization"})]})]},"panel-footer"),children:[(0,i.jsxs)(sO.Z.Content,{children:[(0,i.jsx)("p",{className:"text-sm",children:"This is your organization within Supabase."}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"For example, you can use the name of your company or department."})]}),(0,i.jsx)(sO.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(z.Z,{autoFocus:!0,label:"Name",type:"text",layout:"horizontal",placeholder:"Organization name",descriptionText:"What's the name of your company or team?",value:x,onChange:function(e){g(e.target.value)}})}),(0,i.jsx)(sO.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(E.Z,{label:"Type of organization",layout:"horizontal",value:j,onChange:function(e){v(e)},descriptionText:"What would best describe your organization?",children:Object.entries(tb).map(e=>{let[s,t]=e;return(0,i.jsx)(E.Z.Option,{label:t,value:s,children:t},s)})})}),"COMPANY"==j?(0,i.jsx)(sO.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(E.Z,{label:"Company size",layout:"horizontal",value:f,onChange:function(e){y(e)},descriptionText:"How many people are in your company?",children:Object.entries(tN).map(e=>{let[s,t]=e;return(0,i.jsx)(E.Z.Option,{label:t,value:s,children:t},s)})})}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)(sO.Z.Content,{children:(0,i.jsx)(E.Z,{label:"Pricing Plan",layout:"horizontal",value:C,onChange:function(e){Z(e)},descriptionText:(0,i.jsxs)(i.Fragment,{children:["Select a plan that suits your needs.\xa0",(0,i.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:"https://supabase.com/pricing",children:"More details"})]}),children:Object.entries(ej.f6).map(e=>{let[s,t]=e;return(0,i.jsx)(E.Z.Option,{label:t,value:s,children:t},s)})})}),"PRO"===C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sO.Z.Content,{className:"border-b border-panel-border-interior-light dark:border-panel-border-interior-dark",children:(0,i.jsx)(sX.Z,{id:"spend-cap",layout:"horizontal",label:(0,i.jsxs)("div",{className:"flex space-x-4",children:[(0,i.jsx)("span",{children:"Spend Cap"}),(0,i.jsx)(tj.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100",onClick:()=>A(!0)})]}),checked:k,onChange:()=>T(!k),descriptionText:(0,i.jsx)("div",{children:(0,i.jsx)("p",{children:"By default, Pro Plan organizations have a spend cap to control costs. When enabled, usage is limited to the plan's quota, with restrictions when limits are exceeded. To scale beyond Pro limits without restrictions, disable the spend cap and pay for over-usage beyond the quota."})})})}),(0,i.jsx)(tv,{visible:I,onHide:()=>A(!1)})]}),"FREE"!==C&&(0,i.jsx)(sO.Z.Content,{children:(null==w?void 0:w.card)!==void 0?(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,i.jsx)("img",{alt:"Card",src:"".concat(ej.GW,"/img/payment-methods/").concat(w.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,i.jsx)(z.Z,{readOnly:!0,className:"w-64",size:"small",value:"•••• •••• •••• ".concat(w.card.last4)}),(0,i.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",w.card.exp_month,"/",w.card.exp_year]})]}),(0,i.jsx)("div",{children:(0,i.jsx)(Y.z,{type:"outline",icon:(0,i.jsx)(ty.Z,{}),onClick:()=>L(),disabled:b,className:"hover:border-muted"})})]},w.id):(0,i.jsx)(tg.PaymentElement,{})})]})})},tS=t(48472),t_=t(58995),tC=e=>{let{title:s,description:t}=e;return(0,i.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-14",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-xl",children:s}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:t})]})})},tZ=t(97072),tI=t(78804),tA=t(20758),tz=e=>{let{section:s,includedInPlan:t,children:a}=e,{name:n,description:r,links:o}=s;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{children:(0,i.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-16",children:(0,i.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,i.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,i.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-base capitalize",children:n}),!1===t&&(0,i.jsx)(eT.C,{children:"Not included"})]}),(0,i.jsx)("div",{className:"grid gap-4",children:r.split("\n").map((e,s)=>(0,i.jsx)("p",{className:"text-sm text-foreground-light pr-8",children:e},"desc-".concat(s)))})]}),o&&o.length>0&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground mb-2",children:"More information"}),o.map(e=>(0,i.jsx)("div",{children:(0,i.jsx)(L(),{href:e.url,target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm",children:e.name}),(0,i.jsx)(eI.Z,{size:16,strokeWidth:1.5})]})})},e.url))]})]})}),(0,i.jsx)("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:a})]})})}),(0,i.jsx)(l.I7,{})]})};let tE=(e,s)=>{var t;return s?(null==s?void 0:null===(t=s.plan)||void 0===t?void 0:t.id)==="pro"&&(null==s?void 0:s.usage_billing_enabled)===!1?"/org/".concat(e,"/billing#cost-control"):"/org/".concat(e,"/billing?panel=subscriptionPlan"):"/org/".concat(e,"/billing")},tk=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}),tT=(e,s)=>{if("string"==typeof e)return e;if("bytes"===s){let s=tR(e).replace(/\s/g,"");return"0bytes"===s?"0":s}return"gigabytes"===s?tk.format(e)+"GB":tk.format(e)},tP=(e,s)=>{if("string"==typeof e)return e;if("bytes"===s){let s=tL(e).replace(/\s/g,"");return"0bytes"===s?"0":s}return"gigabytes"===s?tk.format(e)+"GB":tk.format(e)},tO=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],tR=e=>{if(0===e||void 0===e)return"0 bytes";let s=Math.floor(Math.log(e)/Math.log(1024)),t=tO[s],a=2;return["bytes","KB","MB"].includes(t)?a=0:["GB"].includes(t)&&(a=1),parseFloat((e/Math.pow(1024,s)).toFixed(a))+" "+t},tL=e=>{if(0===e||void 0===e)return"0 bytes";let s=Math.floor(Math.log(e)/Math.log(1024)),t=tO[s];return parseFloat((e/Math.pow(1024,s)).toFixed(3))+" "+t};var tD=t(52683),tM=e=>{var s,t,a,n,r,l,o,d,c,m,p,x,g;let{slug:j,projectRef:f,attribute:y,usage:b,usageMeta:N,chartMeta:w,subscription:S,error:_,isLoading:C,isError:Z,isSuccess:I,currentBillingCycleSelected:A}=e,z=tE(null!=j?j:"",S),E=(null!==(a=null==N?void 0:N.usage)&&void 0!==a?a:0)/(null!==(n=null==N?void 0:N.pricing_free_units)&&void 0!==n?n:0),k=(null!==(r=null==N?void 0:N.usage)&&void 0!==r?r:0)-(null!==(l=null==N?void 0:N.pricing_free_units)&&void 0!==l?l:0),T=null==S?void 0:S.usage_billing_enabled,P=T?"text-amber-900":"text-red-900",O=(0,u.useMemo)(()=>{var e,s;return null!==(s=null===(e=w[y.key])||void 0===e?void 0:e.data)&&void 0!==s?s:[]},[y.key,w]),R=void 0===f&&A&&!1===T&&E>=ej.wc,M=(0,u.useMemo)(()=>{var e,s;return null!==(s=null===(e=y.attributes)||void 0===e?void 0:e.map(e=>O.some(s=>0!==Number(s[e.key]))).some(e=>!!e))&&void 0!==s&&s},[y.attributes,O]);return(0,i.jsx)("div",{id:y.anchor,className:"scroll-my-12",children:(0,i.jsxs)(tz,{section:y,children:[C&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),Z&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve usage data",error:_}),I&&(0,i.jsx)(i.Fragment,{children:!N||(null==N?void 0:N.available_in_plan)?(0,i.jsxs)(i.Fragment,{children:[!f&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)("p",{className:"text-sm",children:[y.name," usage"]}),R&&(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{asChild:!0,children:E>=1?(0,i.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,i.jsx)(tI.Z,{size:14,strokeWidth:2,className:P}),(0,i.jsx)("p",{className:"text-sm ".concat(P),children:"Exceeded limit"})]}):E>=ej.wc&&(0,i.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,i.jsx)(tI.Z,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,i.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]})}),(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:[(0,i.jsx)("p",{className:"text-xs text-foreground",children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,i.jsx)("p",{className:"text-xs text-foreground",children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})})]})]})}),A&&N&&!N.unlimited&&(0,i.jsx)(eJ.Z,{type:"horizontal",barClass:(0,D.default)(E>=1?T?"bg-foreground-light":"bg-red-900":!1===T&&E>=ej.wc?"bg-amber-900":"bg-foreground-light"),bgClass:"bg-surface-300",value:null!==(o=null==N?void 0:N.usage)&&void 0!==o?o:0,max:(null==N?void 0:N.pricing_free_units)||1}),(0,i.jsxs)("div",{children:[N&&(0,i.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,i.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==S?void 0:null===(s=S.plan)||void 0===s?void 0:s.name.toLowerCase()," plan"]}),N.unlimited?(0,i.jsx)("p",{className:"text-xs",children:"Unlimited"}):(0,i.jsx)("p",{className:"text-xs",children:"bytes"===y.unit||"gigabytes"===y.unit?"".concat(null!==(d=N.pricing_free_units)&&void 0!==d?d:0," GB"):(null!==(c=N.pricing_free_units)&&void 0!==c?c:0).toLocaleString()})]}),A&&N&&(0,i.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,i.jsxs)("p",{className:"text-xs text-foreground-light",children:[y.chartPrefix||"Used "," in period"]}),(0,i.jsx)("p",{className:"text-xs",children:"bytes"===y.unit||"gigabytes"===y.unit?"".concat((null!==(m=null==N?void 0:N.usage)&&void 0!==m?m:0).toFixed(2)," GB"):(null!==(p=null==N?void 0:N.usage)&&void 0!==p?p:0).toLocaleString()})]}),A&&(null!==(x=null==N?void 0:N.pricing_free_units)&&void 0!==x?x:0)>0&&(0,i.jsxs)("div",{className:"flex items-center justify-between border-t py-1",children:[(0,i.jsx)("p",{className:"text-xs text-foreground-light",children:"Overage in period"}),(0,i.jsx)("p",{className:"text-xs",children:(null!==(g=null==N?void 0:N.pricing_free_units)&&void 0!==g?g:0)===-1||k<0?"0".concat("bytes"===y.unit||"gigabytes"===y.unit?" GB":""):"bytes"===y.unit||"gigabytes"===y.unit?"".concat(k.toFixed(2)," GB"):k.toLocaleString()})]})]})]}),null===(t=y.additionalInfo)||void 0===t?void 0:t.call(y,b),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("p",{className:"text-sm",children:[y.chartPrefix||""," ",y.name," ",y.chartSuffix||"per day"]}),y.chartDescription.split("\n").map((e,s)=>(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:e},"para-".concat(s)))]}),w[y.key].isLoading?(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}):O.length>0&&M?(0,i.jsx)(tD.Z,{name:"".concat(y.chartPrefix||"").concat(y.name),unit:y.unit,attributes:y.attributes,data:O,yLeftMargin:w[y.key].margin,yFormatter:e=>tT(e,y.unit),tooltipFormatter:e=>tP(e,y.unit)}):(0,i.jsx)(sO.Z,{children:(0,i.jsx)(sO.Z.Content,{children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(tA.Z,{className:"text-foreground-light mb-2"}),(0,i.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to 24 hours to show"})]})})})]}):(0,i.jsx)(sO.Z,{children:(0,i.jsx)(sO.Z.Content,{children:(0,i.jsxs)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm",children:"Not included in plan"}),(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"You need to be on a higher plan in order to use this feature."})})]}),(0,i.jsx)(Y.z,{type:"primary",asChild:!0,children:(0,i.jsx)(L(),{href:z,children:"Upgrade plan"})})]})})})})]})})},tU=e=>{let{orgSlug:s,projectRef:t,categoryKey:a,chartMeta:n,subscription:r,currentBillingCycleSelected:o}=e,{data:d,error:c,isLoading:u,isError:m,isSuccess:h}=(0,e$.v)({orgSlug:s}),p=(0,tZ.ty)(r).find(e=>e.key===a);return p?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{children:(0,i.jsx)(tC,{title:p.name,description:p.description})}),(0,i.jsx)(l.I7,{}),p.attributes.map(e=>(0,i.jsx)(tM,{slug:s,projectRef:t,attribute:e,usage:d,usageMeta:null==d?void 0:d.usages.find(s=>s.metric===e.key),chartMeta:n,subscription:r,error:c,isLoading:u,isError:m,isSuccess:h,currentBillingCycleSelected:o},e.name))]}):null},tF=e=>{var s,t,a,n,r,l;let{orgSlug:o,projectRef:d,subscription:c,startDate:u,endDate:m,currentBillingCycleSelected:h}=e,{data:p,isLoading:x}=(0,W.L6)({orgSlug:o,projectRef:d,metric:W.tk.MONTHLY_ACTIVE_USERS,interval:"1d",startDate:u,endDate:m}),{data:g,isLoading:j}=(0,W.L6)({orgSlug:o,projectRef:d,metric:W.tk.MONTHLY_ACTIVE_SSO_USERS,interval:"1d",startDate:u,endDate:m}),{data:v,isLoading:f}=(0,W.L6)({orgSlug:o,projectRef:d,metric:W.tk.STORAGE_IMAGES_TRANSFORMED,interval:"1d",startDate:u,endDate:m}),{data:y,isLoading:b}=(0,W.L6)({orgSlug:o,projectRef:d,metric:W.tk.FUNCTION_INVOCATIONS,interval:"1d",startDate:u,endDate:m}),{data:N,isLoading:w}=(0,W.L6)({orgSlug:o,projectRef:d,metric:W.tk.REALTIME_MESSAGE_COUNT,interval:"1d",startDate:u,endDate:m}),{data:S,isLoading:_}=(0,W.L6)({orgSlug:o,projectRef:d,metric:W.tk.REALTIME_PEAK_CONNECTIONS,interval:"1d",startDate:u,endDate:m}),C={[W.tk.MONTHLY_ACTIVE_USERS]:{data:null!==(s=null==p?void 0:p.data)&&void 0!==s?s:[],margin:18,isLoading:x},[W.tk.MONTHLY_ACTIVE_SSO_USERS]:{data:null!==(t=null==g?void 0:g.data)&&void 0!==t?t:[],margin:20,isLoading:j},[W.tk.STORAGE_IMAGES_TRANSFORMED]:{data:null!==(a=null==v?void 0:v.data)&&void 0!==a?a:[],margin:0,isLoading:f},[W.tk.FUNCTION_INVOCATIONS]:{data:null!==(n=null==y?void 0:y.data)&&void 0!==n?n:[],margin:26,isLoading:b},[W.tk.REALTIME_MESSAGE_COUNT]:{data:null!==(r=null==N?void 0:N.data)&&void 0!==r?r:[],margin:38,isLoading:w},[W.tk.REALTIME_PEAK_CONNECTIONS]:{data:null!==(l=null==S?void 0:S.data)&&void 0!==l?l:[],margin:0,isLoading:_}};return(0,i.jsx)(tU,{orgSlug:o,projectRef:d,categoryKey:"activity",chartMeta:C,subscription:c,currentBillingCycleSelected:h})},tY=e=>{var s;let{orgSlug:t,projectRef:a,subscription:n,startDate:r,endDate:l,currentBillingCycleSelected:o}=e,{data:d,isLoading:c}=(0,W.L6)({orgSlug:t,projectRef:a,metric:W.tk.EGRESS,interval:"1d",startDate:r,endDate:l}),u={[W.tk.EGRESS]:{data:null!==(s=null==d?void 0:d.data)&&void 0!==s?s:[],margin:16,isLoading:c}};return(0,i.jsx)(tU,{orgSlug:t,projectRef:a,categoryKey:"bandwidth",chartMeta:u,subscription:n,currentBillingCycleSelected:o})},tG=t(64883);async function tB(e,s){let{orgSlug:t,startDate:a,endDate:n,projectRef:i}=e;if(!t)throw Error("Org slug is required");if(!a)throw Error("Start date is required");if(!n)throw Error("End date is required");"/platform/organizations/{slug}/daily-stats/compute?&startDate=".concat(encodeURIComponent(a),"&endDate=").concat(encodeURIComponent(n));let{data:r,error:l}=await (0,y.U2)("/platform/organizations/{slug}/daily-stats/compute",{params:{path:{slug:t},query:{projectRef:i,startDate:a,endDate:n}},signal:s});return l&&(0,y.S3)(l),r}let tV=function(e){let{orgSlug:s,startDate:t,endDate:a,projectRef:n,dateFormat:i="DD MMM"}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(tG.d.orgDailyComputeStats(s,{startDate:t,endDate:a,projectRef:n}),e=>{let{signal:i}=e;return tB({orgSlug:s,startDate:t,endDate:a,projectRef:n},i)},{enabled:r&&void 0!==s&&void 0!==t&&void 0!==a,select:e=>({...e,data:e.data.map(e=>({...e,periodStartFormatted:O()(e.period_start).format(i)}))}),staleTime:36e5,...l})};var tq=e=>{var s;let{orgSlug:t,projectRef:a,startDate:n,endDate:r}=e,l=Object.values(W.Hz).map(e=>e.toLowerCase()),{data:o,isLoading:d,error:c,isSuccess:m}=tV({orgSlug:t,projectRef:a,startDate:n,endDate:r}),p=null!==(s=null==o?void 0:o.data)&&void 0!==s?s:[],x={[W.Hz.COMPUTE_HOURS_BRANCH]:"blue",[W.Hz.COMPUTE_HOURS_XS]:"white",[W.Hz.COMPUTE_HOURS_SM]:"green",[W.Hz.COMPUTE_HOURS_MD]:"dark-green",[W.Hz.COMPUTE_HOURS_L]:"yellow",[W.Hz.COMPUTE_HOURS_XL]:"dark-yellow",[W.Hz.COMPUTE_HOURS_2XL]:"orange",[W.Hz.COMPUTE_HOURS_4XL]:"dark-orange",[W.Hz.COMPUTE_HOURS_8XL]:"red",[W.Hz.COMPUTE_HOURS_12XL]:"dark-red",[W.Hz.COMPUTE_HOURS_16XL]:"purple"},g=Object.keys(W.Hz).map(e=>({key:e.toLowerCase(),color:x[e]||"white",name:(0,W.p5)(e)})),j=(0,u.useMemo)(()=>l.filter(e=>p.some(s=>s[e])),[p]),f=(0,u.useMemo)(()=>j.length>0,[j]);return(0,i.jsx)("div",{id:"compute",className:"scroll-my-12",children:(0,i.jsxs)(tz,{section:{name:"Compute Hours",description:"Amount of hours your projects were active. Each project is a dedicated server and database.\nPaid plans come with $10 in Compute Credits to cover one project running on Micro Compute or parts of any compute add-on.\nBilling is based on the sum of Compute Hours used. Paused projects do not count towards usage.",links:[{name:"Compute Add-ons",url:"https://supabase.com/docs/guides/platform/compute-add-ons"},{name:"Usage-billing for Compute",url:"https://supabase.com/docs/guides/platform/org-based-billing#usage-based-billing-for-compute"}]},children:[d&&(0,i.jsx)(v.A,{}),null!=c&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve usage data",error:c}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-1",children:[p.length>0&&(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsx)("div",{className:"flex items-center space-x-4",children:(0,i.jsx)("p",{className:"text-sm",children:"Compute Hours usage"})})}),j.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0 py-1 last:py-0",children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,i.jsx)("span",{className:"font-medium",children:(0,W.p5)(e.toUpperCase())})," ","Compute Hours usage in period"]}),(0,i.jsxs)("p",{className:"text-sm",children:[p.reduce((s,t)=>{var a;return s+(null!==(a=t[e])&&void 0!==a?a:0)},0)," hours"]})]},e))]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm",children:"Compute Hours usage per day"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"The data refreshes every hour."})]}),d?(0,i.jsx)(v.A,{}):p.length>0&&f?(0,i.jsx)(tD.Z,{name:"Compute Hours usage",unit:"hours",attributes:g,data:p,yMin:24}):(0,i.jsx)(sO.Z,{children:(0,i.jsx)(sO.Z.Content,{children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(tA.Z,{className:"text-foreground-light mb-2"}),(0,i.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to one hour to show"})]})})})]})]})})},tW=e=>{var s,t;let{orgSlug:a,projectRef:n,startDate:r,endDate:l,subscription:o,currentBillingCycleSelected:d}=e,{data:c,isLoading:u}=(0,W.L6)({orgSlug:a,projectRef:n,metric:W.tk.DATABASE_SIZE,interval:"1d",startDate:r,endDate:l}),{data:m,isLoading:h}=(0,W.L6)({orgSlug:a,projectRef:n,metric:W.tk.STORAGE_SIZE,interval:"1d",startDate:r,endDate:l}),p={[W.tk.DATABASE_SIZE]:{isLoading:u,margin:14,data:null!==(s=null==c?void 0:c.data)&&void 0!==s?s:[]},[W.tk.STORAGE_SIZE]:{isLoading:h,margin:14,data:null!==(t=null==m?void 0:m.data)&&void 0!==t?t:[]}};return(0,i.jsx)(tU,{orgSlug:a,projectRef:n,categoryKey:"sizeCount",chartMeta:p,subscription:o,currentBillingCycleSelected:d})},tH=t(44145),tX=function(e){return(0,i.jsx)(eU.Z,{icon:tH.Z,...e})};let tK=[{key:W.tk.DATABASE_SIZE,name:"Database Size",units:"bytes",anchor:"dbSize",category:"Database",unitName:"GB"},{key:W.tk.EGRESS,name:"Egress",units:"bytes",anchor:"egress",category:"Database",unitName:"GB"},{key:W.tk.MONTHLY_ACTIVE_USERS,name:"Monthly Active Users",units:"absolute",anchor:"mau",category:"Authentication",unitName:"MAU"},{key:W.tk.MONTHLY_ACTIVE_SSO_USERS,name:"Monthly Active SSO Users",units:"absolute",anchor:"mauSso",category:"Authentication",unitName:"MAU"},{key:W.tk.STORAGE_SIZE,name:"Storage Size",units:"bytes",anchor:"storageSize",category:"Storage",unitName:"GB"},{key:W.tk.STORAGE_IMAGES_TRANSFORMED,name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",category:"Storage"},{key:W.tk.REALTIME_PEAK_CONNECTIONS,name:"Realtime Peak Connections",units:"absolute",anchor:"realtimePeakConnections",category:"Realtime"},{key:W.tk.REALTIME_MESSAGE_COUNT,name:"Realtime Messages",units:"absolute",anchor:"realtimeMessageCount",category:"Realtime"},{key:W.tk.FUNCTION_INVOCATIONS,name:"Edge Function Invocations",units:"absolute",anchor:"funcInvocations",category:"Edge Functions"},{key:W.tk.DISK_SIZE_GB_HOURS,name:"Disk Size",units:"absolute",unitName:"GB-Hrs",category:"Database",tip:"Each project gets provisioned with 8 GB of disk. When you get close to the disk size limit, we autoscale your disk by 1.5x. The first 8 GB of disk is free for every single project."}];var tQ=e=>{var s;let{slug:t,metric:a,usage:n,subscription:r,relativeToSubscription:l}=e,o=n.usages.find(e=>e.metric===a.key),d=(0,u.useMemo)(()=>{var e,s,t,n;return o?l&&!1===o.available_in_plan?"Unavailable in plan":o.cost&&o.cost>0||!l||o.unlimited||0===o.pricing_free_units?"bytes"===a.units||"gigabytes"===a.units?"".concat(null!==(e=o.usage.toLocaleString())&&void 0!==e?e:0," GB"):o.usage.toLocaleString()+(a.unitName?" ".concat(a.unitName):""):"bytes"===a.units||"gigabytes"===a.units?"".concat(null!==(t=o.usage.toLocaleString())&&void 0!==t?t:0," / ").concat(null!==(n=o.pricing_free_units)&&void 0!==n?n:0," GB"):"".concat(o.usage.toLocaleString()," / ").concat(null===(s=o.pricing_free_units)||void 0===s?void 0:s.toLocaleString())+(a.unitName?" ".concat(a.unitName):""):""},[o,l,a]),c=(0,u.useMemo)(()=>o&&o.project_allocations?o.project_allocations.sort((e,s)=>s.usage-e.usage):[],[o]);if(!o)return null;let m=0===o.usage?0:o.usage/(null!==(s=o.pricing_free_units)&&void 0!==s?s:0),h=(null==r?void 0:r.usage_billing_enabled)===!0,p=!1==!!o.unlimited,x=p&&m>=.8,g=l&&p&&m>=1,j=K(o.metric),v=0===o.usage||0===o.pricing_free_units?"":m<.01?"(<1%)":"(".concat((+(100*m).toFixed(0)).toLocaleString(),"%)");return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[a.anchor?(0,i.jsx)(L(),{href:"/org/".concat(t,"/usage#").concat(a.anchor),children:(0,i.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:a.name}),(0,i.jsx)(B.Z,{strokeWidth:1.5,size:16,className:"transition"})]})}):(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:a.name}),(0,i.jsx)("span",{className:"text-sm",children:d}),"\xa0",l&&o.cost&&o.cost>0?(0,i.jsxs)("span",{className:"text-sm",children:["(",(0,J.xG)(o.cost),")"]}):o.available_in_plan&&!o.unlimited&&l?(0,i.jsx)("span",{className:"text-sm",children:v}):null]}),o.available_in_plan?(0,i.jsx)("div",{children:(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{children:l&&!o.unlimited?(0,i.jsxs)("svg",{className:"h-8 w-8 -rotate-90 transform",children:[(0,i.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeWidth:4,className:"text-background-surface-300"}),(0,i.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeDasharray:75.398,strokeDashoffset:"calc(75.39822 - ".concat(m<1?100*m:100," / 100 * 75.39822)"),strokeWidth:4,className:h?"text-gray-dark-800":g?"text-red-900":x?"text-yellow-1000":"text-gray-dark-800"})]}):(0,i.jsx)(tX,{className:"h-8 w-8 p-1"})}),(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsxs)("div",{className:"text-xs text-foreground space-y-2",children:[(0,i.jsx)("p",{className:"font-medium",children:o.unit_price_desc}),a.tip&&(0,i.jsx)("div",{className:"my-2",children:(0,i.jsx)("p",{className:"text-xs",children:a.tip})}),!1===r.usage_billing_enabled&&l&&(x||g)&&(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)("p",{className:"text-xs",children:"Exceeding your plans included usage will lead to restrictions to your project. Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})}),c&&c.length>0&&(0,i.jsxs)("table",{className:"list-disc w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"text-left",children:"Project"}),(0,i.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,i.jsxs)("tbody",{children:[c.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{className:"text-right",children:X(o.metric,e)})]},"".concat(o.metric,"_").concat(e.ref))),(0,i.jsx)("tr",{})]}),(0,i.jsx)("tfoot",{children:(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"py-2 border-t text-left",children:["Total",j&&(0,i.jsxs)("span",{children:[" (",j,")"]})]}),(0,i.jsxs)("td",{className:"py-2 border-t text-right",children:[X(o.metric,{usage:o.usage_original})," "]})]})})]})]})})]})})]})}):(0,i.jsx)("div",{children:(0,i.jsx)(Y.z,{type:"default",asChild:!0,children:(0,i.jsx)(L(),{href:"/org/".concat(t,"/billing?panel=subscriptionPlan"),children:"Upgrade"})})})]})},tJ=e=>{let{slug:s,metric:t,usage:a,relativeToSubscription:n}=e,r=a.usages.find(e=>e.metric===t.key),l=(0,u.useMemo)(()=>{var e,s,t,a,n;return(null==r?void 0:r.pricing_free_units)?"".concat(null!==(s=null==r?void 0:null===(e=r.usage)||void 0===e?void 0:e.toLocaleString())&&void 0!==s?s:0," / ").concat(null!==(t=null==r?void 0:r.pricing_free_units)&&void 0!==t?t:0," hours"):"".concat(null!==(n=null==r?void 0:null===(a=r.usage)||void 0===a?void 0:a.toLocaleString())&&void 0!==n?n:0," hours")},[r]),o=(0,u.useMemo)(()=>r&&r.project_allocations?r.project_allocations.sort((e,s)=>s.usage-e.usage):[],[r]);return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(L(),{href:"/org/".concat(s,"/usage#").concat(t.anchor),children:(0,i.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:t.name}),(0,i.jsx)(B.Z,{strokeWidth:1.5,size:16,className:"transition"})]})}),(0,i.jsx)("span",{className:"text-sm",children:l}),"\xa0",n&&(null==r?void 0:r.cost)&&r.cost>0?(0,i.jsxs)("span",{className:"text-sm",children:["(",(0,J.xG)(null==r?void 0:r.cost),")"]}):null]}),(0,i.jsx)("div",{children:(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{children:(0,i.jsx)(tX,{className:"h-8 w-8 p-1"})}),(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"bottom",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsxs)("div",{className:"text-xs text-foreground space-y-2",children:[(0,i.jsx)("p",{className:"font-medium",children:null==r?void 0:r.unit_price_desc}),(0,i.jsx)("div",{className:"my-2",children:(0,i.jsxs)("p",{className:"text-xs",children:["Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs."," ",(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/org-based-billing#usage-based-billing-for-compute",target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})}),r&&o.length>0&&(0,i.jsxs)("table",{className:"list-disc w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"text-left",children:"Project"}),(0,i.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,i.jsxs)("tbody",{children:[o.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{className:"text-right",children:X(r.metric,e)})]},"".concat(r.metric,"_").concat(e.ref))),(0,i.jsx)("tr",{})]}),(0,i.jsx)("tfoot",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"py-2 border-t text-left",children:"Total (Hours)"}),(0,i.jsx)("td",{className:"py-2 border-t text-right",children:X(r.metric,{usage:r.usage_original})})]})})]})]})})]})})]})})]})},t$=e=>{var s,t;let{orgSlug:a,projectRef:n,subscription:r,startDate:l,endDate:o,currentBillingCycleSelected:d}=e,c=null==r?void 0:r.usage_billing_enabled,{data:m,error:p,isLoading:x,isError:g,isSuccess:j}=(0,e$.v)({orgSlug:a,projectRef:n,start:!d&&l?new Date(l):void 0,end:!d&&o?new Date(o):void 0}),f=d&&!n,y=f&&!!(null==m?void 0:m.usages.find(e=>{var s;return!e.metric.startsWith("COMPUTE_")&&!e.unlimited&&e.usage>(null!==(s=null==e?void 0:e.pricing_free_units)&&void 0!==s?s:0)})),b=(0,u.useMemo)(()=>m?tK.filter(e=>m.usages.some(s=>!s.available_in_plan||s.metric===e.key)).slice().sort((e,s)=>{var t,a,n,i;let r=m.usages.find(s=>s.metric===e.key),l="number"!=typeof r?(null!==(t=null==r?void 0:r.usage)&&void 0!==t?t:0)/(null!==(a=null==r?void 0:r.pricing_free_units)&&void 0!==a?a:0):0,o=m.usages.find(e=>e.metric===s.key),d="number"!=typeof o?(null!==(n=null==o?void 0:o.usage)&&void 0!==n?n:0)/(null!==(i=null==o?void 0:o.pricing_free_units)&&void 0!==i?i:0):0;return Number(null==o?void 0:o.available_in_plan)-Number(null==r?void 0:r.available_in_plan)||d-l}):[],[m]),N=((null==m?void 0:m.usages)||[]).filter(e=>e.metric.startsWith("COMPUTE")).map(e=>e.metric);return(0,i.jsx)("div",{id:"summary",children:(0,i.jsxs)(tz,{section:{name:"Usage Summary",description:c?"Your plan includes a limited amount of usage. If the usage on your organization exceeds these quotas, your subscription will be charged for the overages. It may take up to ".concat((null==r?void 0:r.usage_based_billing_project_addons)?"1 hour":"24 hours"," for usage stats to update."):"Your plan includes a limited amount of usage. If the usage on your organization exceeds these quotas, you may experience restrictions, as you are currently not billed for overages. It may take up to ".concat((null==r?void 0:r.usage_based_billing_project_addons)?"1 hour":"24 hours"," for usage stats to update."),links:[{name:"How billing works",url:"https://supabase.com/docs/guides/platform/org-based-billing"},{name:"Supabase Plans",url:"https://supabase.com/pricing"}]},children:[x&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),g&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve usage data",error:p}),j&&r&&(0,i.jsxs)("div",{children:[f&&(0,i.jsx)("p",{className:"text-sm",children:y?y&&(null==r?void 0:null===(s=r.plan)||void 0===s?void 0:s.id)==="free"?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle. Upgrade your plan to continue using Supabase without restrictions."]}):y&&(null==r?void 0:r.usage_billing_enabled)===!1&&(null==r?void 0:null===(t=r.plan)||void 0===t?void 0:t.id)==="pro"?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle. Disable your spend cap to continue using Supabase without restrictions."]}):y&&(null==r?void 0:r.usage_billing_enabled)===!0?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle and will be charged for over-usage."]}):(0,i.jsxs)("span",{children:["You have not exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle."]}):(0,i.jsxs)("span",{children:["You have not exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle."]})}),(0,i.jsxs)("div",{className:"grid grid-cols-12 mt-3",children:[b.map((e,s)=>(0,i.jsx)("div",{className:(0,D.default)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",s%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,i.jsx)(tQ,{idx:s,slug:a,metric:e,usage:m,subscription:r,relativeToSubscription:f})},e.key)),N.map((e,s)=>(0,i.jsx)("div",{className:(0,D.default)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",(s+b.length)%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,i.jsx)(tJ,{slug:a,metric:{key:e,name:(0,W.p5)(e)+" Compute Hours",units:"hours",anchor:"compute",category:"Compute",unitName:"GB"},relativeToSubscription:f,usage:m})},e))]})]})]})})},t0=()=>{var e,s;let{slug:t,projectRef:a}=(0,r.UO)(),[n,o]=(0,u.useState)(),[m,p]=(0,u.useState)(),x=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),g=(0,er.l)(),{data:f,isSuccess:y}=(0,st.Sy)(),{data:N,error:w,isLoading:S,isError:_,isSuccess:C}=(0,d.G)({orgSlug:t}),Z=null==f?void 0:f.filter(e=>e.organization_id===(null==g?void 0:g.id));(0,u.useEffect)(()=>{a&&y&&void 0!==Z&&Z.find(e=>e.ref===a)&&p(a)},[a,y]);let I=O().unix(null!==(e=null==N?void 0:N.current_period_start)&&void 0!==e?e:0).utc(),A=O().unix(null!==(s=null==N?void 0:N.current_period_end)&&void 0!==s?s:0).utc(),z=(0,u.useMemo)(()=>{if(!(null==n?void 0:n.period_start)||!(null==n?void 0:n.period_end)||!N)return!0;let{current_period_start:e,current_period_end:s}=N;return O()(n.period_start.date).isSame(new Date(1e3*e))&&O()(n.period_end.date).isSame(new Date(1e3*s))},[n,N]),k=(0,u.useMemo)(()=>{var e,s;if(null==n?void 0:null===(e=n.period_start)||void 0===e?void 0:e.date)return new Date(null==n?void 0:null===(s=n.period_start)||void 0===s?void 0:s.date).toISOString().slice(0,-5)+"Z"},[n,N]),T=(0,u.useMemo)(()=>{var e,s;return(null==n?void 0:null===(e=n.period_end)||void 0===e?void 0:e.date)&&O()(n.period_end.date).isAfter(O()())?O()().endOf("day").toISOString().slice(0,-5)+"Z":(null==n?void 0:null===(s=n.period_end)||void 0===s?void 0:s.date)?new Date(n.period_end.date).toISOString().slice(0,-5)+"Z":void 0},[n,N]),P=m?null==Z?void 0:Z.find(e=>e.ref===m):void 0;return x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{className:"sticky top-0 border-b bg-studio z-10 overflow-hidden",children:(0,i.jsxs)("div",{className:"py-4 flex items-center space-x-4",children:[S&&(0,i.jsx)(v.Z,{className:"w-[250px]"}),_&&(0,i.jsx)(h.Z,{className:"w-full",subject:"Failed to retrieve usage data",error:w}),C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tS.Z,{onChange:o,value:t_.eB[0].key,options:[...t_.eB,...t_._T],loading:S,currentBillingPeriodStart:null==N?void 0:N.current_period_start,currentBillingPeriodEnd:null==N?void 0:N.current_period_end}),(0,i.jsxs)(E.Z,{size:"tiny",name:"schema",className:"w-[180px]",value:m,onChange:e=>{"all-projects"===e?p(void 0):p(e)},children:[(0,i.jsx)(E.Z.Option,{id:"all-projects",label:"All projects",value:"all-projects",children:"All projects"},"all-projects"),null==Z?void 0:Z.map(e=>(0,i.jsx)(E.Z.Option,{id:e.ref,value:e.ref,label:e.name,children:e.name},e.ref))]}),(0,i.jsxs)("div",{className:"flex flex-col xl:flex-row xl:gap-3",children:[(0,i.jsxs)("p",{className:(0,D.default)("text-sm transition",S&&"opacity-50"),children:["Organization is on the ",N.plan.name," plan"]}),(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:[I.format("DD MMM YYYY")," -"," ",A.format("DD MMM YYYY")]})]})]})]})}),m?(0,i.jsx)(l._S,{className:"mt-5",children:(0,i.jsx)(e7.Z,{title:"Usage filtered by project",description:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("p",{children:['You are currently viewing usage for the "',(null==P?void 0:P.name)||m,'" project. Since your organization is using the new organization-based billing, the included quota is for your whole organization and not just this project. For billing purposes, we sum up usage from all your projects. To view your usage quota, set the project filter above back to "All Projects".']}),(0,i.jsx)("div",{children:(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"Documentation"})})})]}),defaultVisibility:!0,hideCollapse:!0,icon:(0,i.jsx)(V.Z,{})})}):(0,i.jsx)(l._S,{id:"restriction",className:"mt-5",children:(0,i.jsx)(e2,{})}),(0,i.jsx)(t$,{orgSlug:t,projectRef:m,subscription:N,startDate:k,endDate:T,currentBillingCycleSelected:z}),(0,i.jsx)(tq,{orgSlug:t,projectRef:m,subscription:N,startDate:k,endDate:T}),(0,i.jsx)(tY,{orgSlug:t,projectRef:m,subscription:N,startDate:k,endDate:T,currentBillingCycleSelected:z}),(0,i.jsx)(tW,{orgSlug:t,projectRef:m,subscription:N,startDate:k,endDate:T,currentBillingCycleSelected:z}),(0,i.jsx)(tF,{orgSlug:t,projectRef:m,subscription:N,startDate:k,endDate:T,currentBillingCycleSelected:z})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view organization usage"})})},t2=t(44446),t1=t(52649),t4=t(54813),t3=t(24334),t5=t(38421),t6=t.n(t5),t8=t(82366),t7=t(13252),t9=t(46666),ae=t(88354);async function as(e,s){let{slug:t,iso_timestamp_start:a,iso_timestamp_end:n,project_refs:i}=e;if(!t)throw Error("slug is required");let r=await (0,ae.U2)("".concat(ej.T5,"/organizations/").concat(t,"/audit?iso_timestamp_start=").concat(a,"&iso_timestamp_end=").concat(n),{signal:s});if(r.error)throw r.error;return r}let at=function(e){let{enabled:s=!0,...t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{slug:a,iso_timestamp_start:n,iso_timestamp_end:i}=e,r=O()(n).utc().format("YYYY-MM-DD"),l=O()(i).utc().format("YYYY-MM-DD");return(0,f.a)(N.O.auditLogs(a,{date_start:r,date_end:l}),s=>{let{signal:t}=s;return as(e,t)},{enabled:s&&void 0!==a,...t})};async function aa(e,s){let{slug:t}=e;if(!t)throw Error("slug is required");let[a,n]=await Promise.all([(0,y.U2)("/platform/organizations/{slug}/members",{params:{path:{slug:t}},signal:s}),(0,y.U2)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:t}},signal:s})]),{data:i,error:r}=a,{data:l,error:o}=n;return r&&(0,y.S3)(r),o&&(0,y.S3)(o),[...i,...l.invitations.map(e=>({invited_at:e.invited_at,invited_id:e.id,mfa_enabled:!1,username:e.invited_email.slice(0,1),primary_email:e.invited_email,role_ids:[e.role_id]}))]}let an=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(N.O.members(s),e=>{let{signal:t}=e;return aa({slug:s},t)},{enabled:t&&void 0!==s,...a})};async function ai(e,s){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:a,error:n}=await (0,y.U2)("/platform/organizations/{slug}/roles",{params:{path:{slug:t}},signal:s});return n&&(0,y.S3)(n),{roles:a}}let ar=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(N.O.roles(s),e=>{let{signal:t}=e;return ai({slug:s},t)},{enabled:t&&void 0!==s,...a})};var al=()=>{var e,s,t,a,n,o,d;let{slug:m}=(0,r.UO)(),p=O()().utc().set("millisecond",0),[x,g]=(0,u.useState)(!0),[f,y]=(0,u.useState)({from:p.subtract(1,"day").toISOString(),to:p.toISOString()}),[N,w]=(0,u.useState)(),[S,_]=(0,u.useState)({users:[],projects:[]}),C=(0,b.Xo)(c.KA.READ,"notifications"),{data:Z}=(0,st.Sy)(),{data:I}=(0,ei.tl)(),{data:A}=an({slug:m}),{data:z}=ar({slug:m}),{data:E,error:k,isLoading:T,isSuccess:P,isError:R,isRefetching:D,refetch:M}=at({slug:m,iso_timestamp_start:f.from,iso_timestamp_end:f.to},{enabled:C,retry:(e,s)=>!s.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs."),retryOnMount:!1,refetchOnWindowFocus:!1});(0,u.useEffect)(()=>{let e=O()(f.from).diff(O()(f.to)),s=setInterval(()=>{let s=O()().utc().set("millisecond",0);y({from:s.add(e).toISOString(),to:s.toISOString()})},3e5);return()=>clearInterval(s)},[f.from,f.to]);let U=null!==(t=null==z?void 0:z.roles)&&void 0!==t?t:[],F=null!==(a=null==E?void 0:E.retention_period)&&void 0!==a?a:0,G=null!==(n=null==E?void 0:E.result)&&void 0!==n?n:[],B=null==G?void 0:null===(s=G.sort((e,s)=>x?Number(new Date(s.occurred_at))-Number(new Date(e.occurred_at)):Number(new Date(e.occurred_at))-Number(new Date(s.occurred_at))))||void 0===s?void 0:null===(e=s.filter(e=>S.users.length>0?S.users.includes(e.actor.id):e))||void 0===e?void 0:e.filter(e=>S.projects.length>0?S.projects.includes(e.target.metadata.project_ref||""):e),V=null==I?void 0:I.find(e=>e.slug===m);return C?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.gW,{children:(0,i.jsxs)("div",{className:"space-y-4 flex flex-col",children:[T&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),R?k.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs.")?(0,i.jsxs)(ey.bZ,{variant:"default",title:"Organization Audit Logs are not available on Free or Pro plans",children:[(0,i.jsx)(e0.aN,{}),(0,i.jsxs)("div",{className:"flex flex-row pt-1",children:[(0,i.jsxs)("div",{className:"grow",children:[(0,i.jsx)(ey.Cd,{children:"Organization Audit Logs are not available on Free or Pro plans"}),(0,i.jsx)(ey.X,{className:"flex flex-row justify-between gap-3",children:(0,i.jsx)("p",{children:"Upgrade to Team or Enterprise to view up to 28 days of Audit Logs for your organization."})})]}),(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsx)(Y.z,{type:"primary",asChild:!0,children:(0,i.jsx)(L(),{href:"/org/".concat(m,"/billing?panel=subscriptionPlan"),children:"Upgrade subscription"})})})]})]}):(0,i.jsx)(h.Z,{error:k,subject:"Failed to retrieve audit logs"}):null,P&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-xs prose",children:"Filter by"}),(0,i.jsx)(t9.E,{name:"Users",options:null!=A?A:[],labelKey:"username",valueKey:"gotrue_id",activeOptions:S.users,onSaveFilters:e=>_({...S,users:e})}),(0,i.jsx)(t9.E,{name:"Projects",options:null!==(o=null==Z?void 0:Z.filter(e=>e.organization_id===(null==V?void 0:V.id)))&&void 0!==o?o:[],labelKey:"name",valueKey:"ref",activeOptions:S.projects,onSaveFilters:e=>_({...S,projects:e})}),(0,i.jsx)(t7.M,{hideTime:!0,hideClear:!0,triggerButtonType:"dashed",triggerButtonTitle:"",from:f.from,to:f.to,minDate:O()().subtract(F,"days").toDate(),maxDate:O()().toDate(),onChange:e=>{if(null!==e.from&&null!==e.to){let s=O()().utc();y({from:O()(e.from).utc().hour(s.hour()).minute(s.minute()).second(s.second()).toISOString(),to:O()(e.to).utc().hour(s.hour()).minute(s.minute()).second(s.second()).toISOString()})}},renderFooter:()=>(0,i.jsxs)(ef.b,{title:"",variant:"info",className:"mx-3 pl-2 pr-2 pt-1 pb-2",children:["Your organization has a log retention period of"," ",(0,i.jsxs)("span",{className:"text-brand",children:[F," day",F>1?"s":""]}),". You may only view logs from"," ",O()().subtract(F,"days").format("DD MMM YYYY")," as the earliest date."]})}),P&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"h-[20px] border-r border-strong !ml-4 !mr-2"}),(0,i.jsxs)("p",{className:"prose text-xs",children:["Viewing ",B.length," logs in total"]})]})]}),(0,i.jsx)(Y.z,{type:"default",disabled:T||D,icon:(0,i.jsx)(t2.Z,{className:D?"animate-spin":""}),onClick:()=>M(),children:D?"Refreshing":"Refresh"})]}),0===G.length?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"Your organization does not have any audit logs available yet"})}):G.length>0&&0===B.length?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"No audit logs found based on the filters applied"})}):(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{className:"py-2",children:"User"},"user"),(0,i.jsx)(eN.Z.th,{className:"py-2",children:"Action"},"action"),(0,i.jsx)(eN.Z.th,{className:"py-2",children:"Target"},"target"),(0,i.jsx)(eN.Z.th,{className:"py-2",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{children:"Date"}),(0,i.jsxs)(q.fC,{delayDuration:0,children:[(0,i.jsx)(q.xz,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"text",className:"px-1",icon:x?(0,i.jsx)(t1.Z,{strokeWidth:1.5,size:14}):(0,i.jsx)(t4.Z,{strokeWidth:1.5,size:14}),onClick:()=>g(!x)})}),(0,i.jsx)(q.h_,{children:(0,i.jsxs)(q.VY,{side:"right",children:[(0,i.jsx)(q.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:x?"Sort latest first":"Sort earliest first"})})]})})]})]})},"date"),(0,i.jsx)(eN.Z.th,{className:"py-2"},"actions")],body:null!==(d=null==B?void 0:B.map(e=>{var s,t,a,n,r,l,o,d,c;let u=(null!=A?A:[]).find(s=>s.gotrue_id===e.actor.id),m=U.find(e=>{var s;return(null==u?void 0:null===(s=u.role_ids)||void 0===s?void 0:s[0])===e.id}),h=null==Z?void 0:Z.find(s=>s.ref===e.target.metadata.project_ref),p=null==I?void 0:I.find(s=>s.slug===e.target.metadata.org_slug),x=(null===(s=e.action.metadata[0])||void 0===s?void 0:s.status)!==void 0,g=void 0===u?(0,i.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,i.jsx)("p",{children:"?"})}):(null==u?void 0:u.invited_id)||(null==u?void 0:u.username)===(null==u?void 0:u.primary_email)?(0,i.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,i.jsx)(t3.Z,{size:18,strokeWidth:2})}):(0,i.jsx)(t6(),{alt:null==u?void 0:u.username,src:"https://github.com/".concat(null!==(t=null==u?void 0:u.username)&&void 0!==t?t:"",".png?size=80"),width:"30",height:"30",className:"border rounded-full"});return(0,i.jsxs)(eN.Z.tr,{onClick:()=>w(e),className:"cursor-pointer hover:!bg-alternative transition duration-100",children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{children:g}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-foreground-light",children:null!==(a=null==u?void 0:u.username)&&void 0!==a?a:"-"}),m&&(0,i.jsx)("p",{className:"mt-0.5 text-xs text-foreground-light",children:null==m?void 0:m.name})]})]})}),(0,i.jsx)(eN.Z.td,{className:"max-w-[250px]",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[x&&(0,i.jsx)("p",{className:"bg-surface-200 rounded px-1 flex items-center justify-center text-xs font-mono border",children:e.action.metadata[0].status}),(0,i.jsx)("p",{className:"truncate",title:e.action.name,children:e.action.name})]})}),(0,i.jsxs)(eN.Z.td,{children:[(0,i.jsxs)("p",{className:"text-foreground-light max-w-[230px] truncate",title:null!==(r=null!==(n=null==h?void 0:h.name)&&void 0!==n?n:null==p?void 0:p.name)&&void 0!==r?r:"-",children:[(null==h?void 0:h.name)?"Project: ":(null==p?void 0:p.name)?"Organization: ":null,null!==(o=null!==(l=null==h?void 0:h.name)&&void 0!==l?l:null==p?void 0:p.name)&&void 0!==o?o:"Unknown"]}),(0,i.jsxs)("p",{className:"text-foreground-light text-xs mt-0.5 truncate",title:null!==(d=e.target.metadata.project_ref)&&void 0!==d?d:e.target.metadata.org_slug,children:[e.target.metadata.project_ref?"Ref: ":e.target.metadata.org_slug?"Slug: ":null,null!==(c=e.target.metadata.project_ref)&&void 0!==c?c:e.target.metadata.org_slug]})]}),(0,i.jsx)(eN.Z.td,{children:O()(e.occurred_at).format("DD MMM YYYY, HH:mm:ss")}),(0,i.jsx)(eN.Z.td,{align:"right",children:(0,i.jsx)(Y.z,{type:"default",children:"View details"})})]},e.occurred_at)}))&&void 0!==d?d:[]})]})]})}),(0,i.jsx)(t8.h,{selectedLog:N,onClose:()=>w(void 0)})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view organization audit logs"})})};let ao=e=>[e,"oauth-apps"],ad=e=>[e,"authorized-apps"];async function ac(e,s){let{slug:t}=e;if(!t)throw Error("Organization slug is required");let a=await (0,ae.U2)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps?type=authorized"),{signal:s});if(a.error)throw a.error;return a}let au=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(ad(s),e=>{let{signal:t}=e;return ac({slug:s},t)},{enabled:t&&void 0!==s,...a})};async function am(e,s){let{slug:t}=e;if(!t)throw Error("Organization slug is required");let a=await (0,ae.U2)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps?type=published"),{signal:s});if(a.error)throw a.error;return a}let ah=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(ao(s),e=>{let{signal:t}=e;return am({slug:s},t)},{enabled:t&&void 0!==s,...a})};var ap=t(53738),ax=t(62134),ag=e=>{let{app:s,onSelectRevoke:t}=e;return(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:s.icon?"url('".concat(s.icon,"')"):"none"},children:s.icon?"":"".concat(s.name[0])})}),(0,i.jsx)(eN.Z.td,{children:s.name}),(0,i.jsx)(eN.Z.td,{children:O()(s.authorized_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,i.jsx)(eN.Z.td,{align:"right",children:(0,i.jsx)(Y.z,{type:"default",icon:(0,i.jsx)(ax.Z,{}),className:"px-1",onClick:()=>t()})})]})};async function aj(e){let{id:s,slug:t}=e;if(!s)throw Error("OAuth app ID is required");if(!t)throw Error("Organization slug is required");let a=await (0,ae.$v)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps/").concat(s,"?type=published"));if(a.error)throw a.error;return a}let av=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>aj(e),{async onSuccess(s,t,n){let{slug:i}=t;await a.invalidateQueries(ao(i)),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to delete application: ".concat(e.message)):s(e,t,a)},...t})};var af=t(89689),ay=e=>{let{selectedApp:s,onClose:t}=e,{slug:a}=(0,r.UO)(),{mutate:n,isLoading:l}=av({onSuccess:()=>{m.ZP.success('Successfully deleted the app "'.concat(null==s?void 0:s.name,'"')),t()}}),o=async()=>a?(null==s?void 0:s.id)?void n({slug:a,id:null==s?void 0:s.id}):console.error("App ID is required"):console.error("Slug is required");return(0,i.jsxs)(eB.Z,{size:"medium",alignFooter:"right",header:"Confirm to delete ".concat(null==s?void 0:s.name),visible:void 0!==s,loading:l,onCancel:t,onConfirm:o,children:[(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)(ef.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:["Deleting ",null==s?void 0:s.name," will invalidate any access tokens from this application that were authorized by users."]})}),(0,i.jsx)(eB.Z.Content,{children:(0,i.jsx)("ul",{className:"space-y-5",children:(0,i.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,i.jsx)(af.Z,{w:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Before you remove this application, consider:"}),(0,i.jsx)("ul",{className:"space-y-2 mt-2",children:(0,i.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. It will no longer be available for use after deletion."})})]})]})})})]})},ab=t(76141),aN=t(7774),aw=t(42679),aS=t(65644),a_=t(3536),aC=t(2322),aZ=e=>{let{app:s,onSelectEdit:t,onSelectDelete:a}=e,[n,r]=(0,u.useState)(!1),l=(0,b.Xo)(c.KA.UPDATE,"approved_oauth_apps"),o=(0,b.Xo)(c.KA.DELETE,"approved_oauth_apps");return(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:s.icon?"url('".concat(s.icon,"')"):"none"},children:s.icon?"":"".concat(s.name[0])})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{title:s.name,className:"truncate",children:s.name})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("p",{className:"font-mono truncate w-[220px]",title:s.client_id,children:s.client_id}),(0,i.jsx)(Y.z,{type:"default",icon:n?(0,i.jsx)(ab.Z,{className:"text-brand",strokeWidth:3}):(0,i.jsx)(aN.Z,{}),className:"ml-2 px-1",onClick:()=>{(0,J.vQ)(s.client_id),r(!0),setTimeout(()=>{r(!1)},3e3)}})]})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("span",{className:"font-mono",title:s.client_secret_alias,children:[s.client_secret_alias,"..."]})}),(0,i.jsx)(eN.Z.td,{children:O()(s.created_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,i.jsx)(eN.Z.td,{align:"right",children:(0,i.jsxs)(eY.h_,{children:[(0,i.jsx)(eY.$F,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"default",icon:(0,i.jsx)(aw.Z,{}),className:"px-1"})}),(0,i.jsxs)(eY.AW,{align:"end",side:"bottom",children:[(0,i.jsxs)(aC.u,{children:[(0,i.jsx)(aC.aJ,{asChild:!0,children:(0,i.jsxs)(eY.Xi,{disabled:!l,className:"space-x-2 !pointer-events-auto",onClick:()=>{l&&t()},children:[(0,i.jsx)(aS.Z,{size:16}),(0,i.jsx)("p",{children:"Edit app"})]},"edit")}),!l&&(0,i.jsx)(aC._v,{side:"left",children:"You need additional permissions to edit apps"})]}),(0,i.jsx)(eY.VD,{}),(0,i.jsxs)(aC.u,{children:[(0,i.jsx)(aC.aJ,{asChild:!0,children:(0,i.jsxs)(eY.Xi,{disabled:!o,className:"space-x-2 !pointer-events-auto",onClick:()=>{o&&a()},children:[(0,i.jsx)(a_.Z,{size:16}),(0,i.jsx)("p",{children:"Delete app"})]},"delete")}),!o&&(0,i.jsx)(aC._v,{side:"left",children:"You need additional permissions to delete apps"})]})]})]})})]})};async function aI(e){let{slug:s,name:t,website:a,icon:n,scopes:i,redirect_uris:r}=e,l=await (0,ae.v_)("".concat(ej.T5,"/organizations/").concat(s,"/oauth/apps"),{name:t,website:a,icon:n,scopes:i,redirect_uris:r});if(l.error)throw l.error;return l}let aA=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>aI(e),{async onSuccess(s,t,n){let{slug:i}=t;await a.invalidateQueries(ao(i)),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to create OAuth application: ".concat(e.message)):s(e,t,a)},...t})};async function az(e){let{id:s,slug:t,name:a,website:n,icon:i,scopes:r,redirect_uris:l}=e;if(!s)throw Error("OAuth app ID is required");if(!t)throw Error("Organization slug is required");if(!a)throw Error("OAuth app name is required");if(!n)throw Error("OAuth app URL is required");if(!l||0===l.length)throw Error("Redirect URIs are required");let o=await (0,ae.gz)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps/").concat(s),{name:a,website:n,icon:i,scopes:r,redirect_uris:l});if(o.error)throw o.error;return o}let aE=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>az(e),{async onSuccess(s,t,n){let{slug:i}=t;await a.invalidateQueries(ao(i)),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update application: ".concat(e.message)):s(e,t,a)},...t})};var ak=t(27208);let aT=async function(e,s,t){let a=!(arguments.length>3)||void 0===arguments[3]||arguments[3],n=(0,ak.eI)("https://obuldanrptloktxcffvn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idWxkYW5ycHRsb2t0eGNmZnZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTg2MTQ2ODUsImV4cCI6MjAzNDE5MDY4NX0.NFt49g6DFkc1X5khCzN5p01iAVo2TMxlx88cY1V0E2M",{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:e=>void 0,setItem:(e,s)=>{},removeItem:e=>{}}}}),{data:i,error:r}=await n.storage.from(e).upload(s,t,{cacheControl:"3600"});if(r){console.error("Failed to upload:",r);return}if(i&&a){let{data:s}=await n.storage.from(e).getPublicUrl(i.path);return null==s?void 0:s.publicUrl}};var aP=t(74559),aO=t(97305),aR=t(41421),aL=t(43687);let aD=e=>{let{children:s,scopeName:t,scopes:a,onChange:n}=e;return(0,i.jsx)(eY.bO,{checked:a.includes(t),onCheckedChange:e=>{e?n([...a,t]):n([...a.filter(e=>e!==t)])},children:s})},aM=e=>{let{title:s,description:t,readScopeName:a,writeScopeName:n,scopes:r,setScopes:l}=e,o="Access: No access";return r.includes(a)&&(o="Access: Read-only"),r.includes(n)&&(o="Access: Write-only"),r.includes(a)&&r.includes(n)&&(o="Access: Read and write"),(0,i.jsxs)("div",{className:"flex flex-row justify-between p-4 border first:rounded-t last:rounded-b",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("span",{className:"text-foreground text-sm",children:s}),(0,i.jsx)("span",{className:"text-foreground-light text-xs",children:t})]}),(0,i.jsxs)(eY.h_,{children:[(0,i.jsx)(eY.$F,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"default",iconRight:(0,i.jsx)(aL.Z,{}),children:(0,i.jsx)("p",{children:o})})}),(0,i.jsxs)(eY.AW,{align:"end",children:[(0,i.jsx)(eY.Ju,{children:"Select an access level"}),(0,i.jsx)(eY.VD,{}),(0,i.jsx)(aD,{scopeName:a,scopes:r,onChange:l,children:"Read"}),(0,i.jsx)(aD,{scopeName:n,scopes:r,onChange:l,children:"Write"})]})]})]},s)},aU=e=>{let{scopes:s,setScopes:t}=e;return(0,i.jsxs)("div",{className:"-space-y-px",children:[(0,i.jsx)(aM,{title:"Auth",description:"Auth configurations and SSO providers.",readScopeName:c.YX.AUTH_READ,writeScopeName:c.YX.AUTH_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Database",description:"Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",readScopeName:c.YX.DATABASE_READ,writeScopeName:c.YX.DATABASE_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Domains",description:"Custom domains and vanity subdomains.",readScopeName:c.YX.DOMAINS_READ,writeScopeName:c.YX.DOMAINS_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Edge Functions",description:"Edge functions.",readScopeName:c.YX.EDGE_FUNCTIONS_READ,writeScopeName:c.YX.EDGE_FUNCTIONS_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Environment",description:"Environments/branches.",readScopeName:c.YX.ENVIRONMENT_READ,writeScopeName:c.YX.ENVIRONMENT_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Organizations",description:"Organizations and all its members.",readScopeName:c.YX.ORGANIZATIONS_READ,writeScopeName:c.YX.ORGANIZATIONS_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Projects",description:"Metadata, upgrade status, network restrictions and network bans.",readScopeName:c.YX.PROJECTS_READ,writeScopeName:c.YX.PROJECTS_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"REST",description:"PostgREST configurations.",readScopeName:c.YX.REST_READ,writeScopeName:c.YX.REST_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Secrets",description:"API keys, secrets and pgsodium configurations.",readScopeName:c.YX.SECRETS_READ,writeScopeName:c.YX.SECRETS_WRITE,scopes:s,setScopes:t}),(0,i.jsx)(aM,{title:"Storage",description:"Storage buckets and files.",readScopeName:c.YX.STORAGE_READ,writeScopeName:c.YX.STORAGE_WRITE,scopes:s,setScopes:t})]})};var aF=e=>{let{visible:s,selectedApp:t,onClose:a,onCreateSuccess:n}=e,{slug:l}=(0,r.UO)(),o=(0,u.useRef)(),{mutate:d}=aA({onSuccess:(e,s)=>{m.ZP.success('Successfully created OAuth app "'.concat(s.name,'"!')),a(),n(e),p(!1)},onError:e=>{m.ZP.error("Failed to create OAuth application: ".concat(e.message)),p(!1)}}),{mutate:c}=aE({onSuccess:(e,s)=>{m.ZP.success('Successfully updated OAuth app "'.concat(s.name,'"!')),a(),p(!1)},onError:e=>{m.ZP.error("Failed to update OAuth application: ".concat(e.message)),p(!1)}}),[h,p]=(0,u.useState)(!1),[x,g]=(0,u.useState)(!1),[j,v]=(0,u.useState)(),[f,y]=(0,u.useState)(),[b,N]=(0,u.useState)({}),[w,S]=(0,u.useState)([{id:(0,J.k$)(),value:""}]),[_,C]=(0,u.useState)([]);(0,u.useEffect)(()=>{s&&(N({}),p(!1),v(void 0),void 0!==t?(S(t.redirect_uris.map(e=>({id:(0,J.k$)(),value:e}))),C(t.scopes),y(null===t.icon?void 0:t.icon)):(S([{id:(0,J.k$)(),value:""}]),C([]),y(void 0)))},[s,t]);let Z=(e,s)=>{S(w.map(t=>t.id===e?{id:e,value:s}:t)),N({})},I=e=>{S(w.filter(s=>s.id!==e))},E=async e=>{e.persist();let[s]=e.target.files||e.dataTransfer.items;v(s),y(URL.createObjectURL(s)),e.target.value=""},k=async e=>{if(!l)return console.error("Slug is required");let s=w.filter(e=>e.value.length>0).map(e=>e.value);if(0===s.length){N({urls:"Please provide at least one URL"});return}N({}),p(!0);let{name:a,website:n}=e,i=void 0!==j?await aT("oauth-app-icons","".concat(l,"/").concat((0,J.k$)(),".png"),j):f;void 0===t?d({slug:l,name:a,website:n,redirect_uris:s,scopes:_,icon:i}):c({id:t.id,slug:l,name:a,website:n,redirect_uris:s,scopes:_,icon:void 0===i?null:i})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(eZ.ZP,{hideFooter:!0,size:"large",visible:s,header:void 0!==t?"Update OAuth application":"Publish a new OAuth application",onCancel:()=>a(),children:(0,i.jsx)(A.Z,{validateOnBlur:!0,className:"h-full",initialValues:{name:"",website:""},validate:e=>{let s={};return e.name||(s.name="Please provide a name for your application"),e.website||(s.website="Please provide a URL for your site"),(0,J.HH)(e.website)||(s.website="Please provide a valid URL for your site"),s},onSubmit:k,children:e=>{let{resetForm:n,values:r}=e;return(0,u.useEffect)(()=>{if(s&&void 0!==t){let e={name:t.name,website:t.website};n({values:e,initialValues:e})}},[s,t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"h-full flex flex-col",children:[(0,i.jsxs)("div",{className:"flex-grow",children:[(0,i.jsx)(eZ.ZP.Content,{children:(0,i.jsxs)("div",{className:"py-4 flex items-start justify-between gap-10",children:[(0,i.jsxs)("div",{className:"space-y-4 w-full",children:[(0,i.jsx)(z.Z,{id:"name",label:"Application name",descriptionText:(null==t?void 0:t.id)&&"ID: ".concat(t.id)}),(0,i.jsx)(z.Z,{id:"website",label:"Website URL",placeholder:"https://my-website.com"})]}),(0,i.jsxs)("div",{children:[void 0!==f?(0,i.jsx)("div",{className:(0,eA.cn)("shadow transition group relative","bg-center bg-cover bg-no-repeat","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center"),style:{backgroundImage:f?'url("'.concat(f,'")'):"none"},children:(0,i.jsx)("div",{className:"absolute bottom-1 right-1",children:(0,i.jsxs)(eY.h_,{children:[(0,i.jsx)(eY.$F,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"default",className:"px-1",children:(0,i.jsx)(aP.Z,{})})}),(0,i.jsxs)(eY.AW,{align:"end",side:"bottom",children:[(0,i.jsx)(eY.Xi,{onClick:()=>{o.current&&o.current.click()},children:(0,i.jsx)("p",{children:"Upload image"})},"upload"),(0,i.jsx)(eY.Xi,{onClick:()=>{v(void 0),y(void 0)},children:(0,i.jsx)("p",{children:"Remove image"})},"remove")]})]})})}):(0,i.jsxs)("div",{className:(0,eA.cn)("border border-strong transition opacity-75 hover:opacity-100","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center cursor-pointer"),onClick:()=>{o.current&&o.current.click()},children:[(0,i.jsx)(aO.Z,{size:18,strokeWidth:1.5,className:"text-foreground"}),(0,i.jsx)("p",{className:"text-xs text-foreground-light",children:"Upload logo"})]}),(0,i.jsx)("input",{multiple:!0,type:"file",ref:o,className:"hidden",accept:"image/png, image/jpeg",onChange:E})]})]})}),(0,i.jsx)(eZ.ZP.Separator,{}),(0,i.jsxs)(eZ.ZP.Content,{className:"py-4",children:[(0,i.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"prose text-sm",children:"Authorization callback URLs"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"All URLs must use HTTPS, except for localhost"})]}),(0,i.jsx)(Y.z,{onClick:()=>S(w.concat({id:(0,J.k$)(),value:""})),children:"Add URL"})]}),(0,i.jsxs)("div",{className:"space-y-2 pb-2",children:[w.map(e=>(0,i.jsx)(z.Z,{value:e.value,onChange:s=>Z(e.id,s.target.value),placeholder:"e.g https://my-website.com",actions:[w.length>1?(0,i.jsx)(Y.z,{type:"default",onClick:()=>I(e.id),children:"Remove"},"remove-url"):null]},e.id)),b.urls&&(0,i.jsx)("p",{className:"text-red-900 text-sm",children:b.urls})]})]}),(0,i.jsx)(eZ.ZP.Separator,{}),(0,i.jsxs)("div",{className:"p-6 ",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between space-x-4 pb-4",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("span",{className:"prose text-sm",children:"Application permissions"}),(0,i.jsx)("span",{className:"text-sm text-foreground-light",children:"The application permissions are organized in scopes and will be presented to the user when adding an app to their organization and all of its projects."})]}),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eI.Z,{}),children:(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/oauth-apps/oauth-scopes",target:"_blank",rel:"noreferrer",children:"Documentation"})})]}),(0,i.jsx)(aU,{scopes:_,setScopes:C})]})]}),(0,i.jsx)(eZ.ZP.Separator,{}),(0,i.jsx)(eZ.ZP.Content,{children:(0,i.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,i.jsx)(Y.z,{type:"default",onClick:()=>g(!0),disabled:0===r.name.length||0===r.website.length,children:"Preview consent for users"}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(Y.z,{type:"default",disabled:h,onClick:()=>a(),children:"Cancel"}),(0,i.jsx)(Y.z,{htmlType:"submit",loading:h,disabled:h,children:"Confirm"})]})]})})]}),(0,i.jsxs)(eB.Z,{hideFooter:!0,className:"!max-w-[600px]",visible:x,onCancel:()=>g(!1),children:[(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("p",{children:["Authorize API access for ",r.name]}),(0,i.jsx)(eT.C,{variant:"brand",children:"Preview"})]})}),(0,i.jsx)(eB.Z.Separator,{}),(0,i.jsxs)(eB.Z.Content,{children:[(0,i.jsx)(aR.Z,{icon:f||null,name:r.name,domain:r.website,scopes:_}),(0,i.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,i.jsx)("p",{className:"prose text-sm",children:"Select an organization to grant API access to"}),(0,i.jsx)("div",{className:"border border-control text-foreground-light rounded px-4 py-2 text-sm bg-surface-200",children:"Organizations that you have access to will be listed here"})]})]}),(0,i.jsx)(eB.Z.Separator,{}),(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"prose text-xs",children:"This is what your users will see when authorizing with your app"}),(0,i.jsx)(Y.z,{type:"default",onClick:()=>g(!1),children:"Close"})]})})]})]})}})})})};async function aY(e){let{id:s,slug:t}=e;if(!s)throw Error("App ID is required");if(!t)throw Error("Organization slug is required");let a=await (0,ae.v_)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps/").concat(s,"/revoke"),{});if(a.error)throw a.error;return a}let aG=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>aY(e),{async onSuccess(s,t,n){let{slug:i}=t;await a.invalidateQueries(ad(i)),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to revoke application: ".concat(e.message)):s(e,t,a)},...t})};var aB=e=>{let{selectedApp:s,onClose:t}=e,{slug:a}=(0,r.UO)(),{mutate:n,isLoading:l}=aG({onSuccess:()=>{m.ZP.success('Successfully revoked the app "'.concat(null==s?void 0:s.name,'"')),t()}}),o=async()=>a?(null==s?void 0:s.id)?void n({slug:a,id:null==s?void 0:s.id}):console.error("App ID is required"):console.error("Slug is required");return(0,i.jsxs)(eB.Z,{size:"medium",alignFooter:"right",header:"Confirm to revoke ".concat(null==s?void 0:s.name),visible:void 0!==s,loading:l,onCancel:t,onConfirm:o,children:[(0,i.jsx)(eB.Z.Content,{children:(0,i.jsxs)(ef.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:[null==s?void 0:s.name," application will no longer have access to your organization's settings and projects."]})}),(0,i.jsx)(eB.Z.Content,{children:(0,i.jsx)("ul",{className:"space-y-5",children:(0,i.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,i.jsx)(af.Z,{w:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Before you remove this app, consider:"}),(0,i.jsx)("ul",{className:"space-y-2 mt-2",children:(0,i.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. The application will no longer have access to your organization after being revoked."})})]})]})})})]})},aV=()=>{var e,s,t,a;let{slug:n}=(0,r.UO)(),[o,d]=(0,u.useState)(!1),[m,p]=(0,u.useState)(),[x,g]=(0,u.useState)(),[f,y]=(0,u.useState)(),[N,w]=(0,u.useState)(),S=(0,b.Xo)(c.KA.READ,"approved_oauth_apps"),_=(0,b.Xo)(c.KA.CREATE,"approved_oauth_apps"),{data:C,error:Z,isLoading:I,isSuccess:A,isError:E}=ah({slug:n},{enabled:S}),k=null==C?void 0:C.sort((e,s)=>Number(new Date(e.created_at))-Number(new Date(s.created_at))),{data:T,isLoading:P,isSuccess:O,isError:R}=au({slug:n}),L=null==T?void 0:T.sort((e,s)=>Number(new Date(e.authorized_at))-Number(new Date(s.authorized_at)));return S?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.gW,{children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Published Apps"}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"Build integrations that extend Supabase's functionality"})]}),(0,i.jsx)(e8.u,{disabled:!_,type:"primary",onClick:()=>d(!0),tooltip:{content:{side:"bottom",text:"You need additional permissions to create apps"}},children:"Add application"})]}),I&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),E&&(0,i.jsx)(h.Z,{error:Z,subject:"Failed to retrieve published OAuth apps"}),void 0!==m&&(0,i.jsxs)(ef.b,{withIcon:!0,variant:"success",title:"Successfully published a new application!",children:[(0,i.jsx)("div",{className:"absolute top-4 right-4",children:(0,i.jsx)(Y.z,{type:"text",icon:(0,i.jsx)(ap.Z,{size:18}),className:"px-1",onClick:()=>p(void 0)})}),(0,i.jsxs)("div",{className:"w-full space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Ensure that you store the client secret securely - you will not be able to see it again."}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(z.Z,{copy:!0,readOnly:!0,size:"small",label:"Client ID",className:"max-w-xl input-mono",value:m.client_id,onChange:()=>{}}),(0,i.jsx)(z.Z,{copy:!0,readOnly:!0,size:"small",label:"Client secret",className:"max-w-xl input-mono",value:m.client_secret,onChange:()=>{}})]})]})]}),A&&(0,i.jsx)(i.Fragment,{children:(null!==(e=null==C?void 0:C.length)&&void 0!==e?e:0)===0?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between mt-4",children:(0,i.jsx)("p",{className:"prose text-sm",children:"You do not have any published applications yet"})}):(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{className:"w-[30px]"},"icon"),(0,i.jsx)(eN.Z.th,{children:"Name"},"name"),(0,i.jsx)(eN.Z.th,{children:"Client ID"},"client-id"),(0,i.jsx)(eN.Z.th,{children:"Client Secret"},"client-secret"),(0,i.jsx)(eN.Z.th,{children:"Created at"},"created-at"),(0,i.jsx)(eN.Z.th,{},"delete-action")],body:null!==(s=null==k?void 0:k.map(e=>(0,i.jsx)(aZ,{app:e,onSelectEdit:()=>{d(!0),g(e)},onSelectDelete:()=>y(e)},e.id)))&&void 0!==s?s:[]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Authorized Apps"}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"Applications that have access to your organization's settings and projects"}),(0,i.jsxs)("div",{className:"mt-4",children:[P&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),R&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve authorized apps"}),O&&(0,i.jsx)(i.Fragment,{children:(null!==(t=T.length)&&void 0!==t?t:0)===0?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"You do not have any authorized applications yet"})}):(0,i.jsx)(eN.Z,{className:"mt-4",head:[(0,i.jsx)(eN.Z.th,{className:"w-[30px]"},"icon"),(0,i.jsx)(eN.Z.th,{children:"Name"},"name"),(0,i.jsx)(eN.Z.th,{children:"Authorized at"},"authorized-at"),(0,i.jsx)(eN.Z.th,{},"delete-action")],body:null!==(a=null==L?void 0:L.map(e=>(0,i.jsx)(ag,{app:e,onSelectRevoke:()=>w(e)},e.id)))&&void 0!==a?a:[]})})]})]})]}),(0,i.jsx)(aF,{visible:o,selectedApp:x,onClose:()=>{g(void 0),d(!1)},onCreateSuccess:p}),(0,i.jsx)(ay,{selectedApp:f,onClose:()=>y(void 0)}),(0,i.jsx)(aB,{selectedApp:N,onClose:()=>w(void 0)})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view OAuth apps"})})},aq=t(68806);async function aW(e){let{slug:s,gotrueId:t}=e,a=await (0,ae.$v)("".concat(ej.T5,"/organizations/").concat(s,"/members/").concat(t));if(a.error)throw a.error;return a}let aH=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>aW(e),{async onSuccess(s,t,n){let{slug:i}=t;await Promise.all([a.invalidateQueries(N.O.members(i)),a.invalidateQueries(N.O.roles(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to remove member: ".concat(e.message)):s(e,t,a)},...t})};var aX=t(96551),aK=t(74067),aQ=t(74138),aJ=t(1842),a$=t.n(aJ),a0=t(3507);async function a2(e){let{slug:s,email:t,roleId:a,projects:n}=e,i={email:t,role_id:a};void 0!==n&&(i.role_scoped_projects=n);let{data:r,error:l}=await (0,y.v_)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:s}},body:i});return l&&(0,y.S3)(l),r}let a1=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>a2(e),{async onSuccess(s,t,n){let{slug:i}=t;await Promise.all([a.invalidateQueries(a0.O.rolesV2(i)),a.invalidateQueries(N.O.members(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update member role: ".concat(e.message)):s(e,t,a)},...t})};async function a4(e,s){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:a,error:n}=await (0,y.U2)("/platform/organizations/{slug}/roles",{params:{path:{slug:t}},headers:{Version:"2"},signal:s});return n&&(0,y.S3)(n),a}let a3=function(e){let{slug:s}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(a0.O.rolesV2(s),e=>{let{signal:t}=e;return a4({slug:s},t)},{enabled:t&&void 0!==s,...a})};async function a5(e){let{slug:s,invitedEmail:t,ownerId:a,roleId:n}=e,i=await (0,ae.v_)("".concat(ej.T5,"/organizations/").concat(s,"/members/invite"),{invited_email:t,owner_id:a,role_id:n});if(i.error)throw i.error;return i}let a6=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>a5(e),{async onSuccess(s,t,n){let{slug:i}=t;await Promise.all([a.invalidateQueries(N.O.members(i)),a.invalidateQueries(N.O.roles(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to invite member: ".concat(e.message)):s(e,t,a)},...t})};var a8=t(41909),a7=t(93705);let a9=(e,s,t)=>{let{permissions:a,organizationSlug:n}=(0,b.Rc)(t,e,void 0!==t&&void 0!==e),i=[],r=[];return s&&e&&s.forEach(e=>{(0,b.G8)(a,c.KA.CREATE,"auth.subject_roles",{resource:{role_id:e.id}},n)&&i.push(e.id),(0,b.G8)(a,c.KA.DELETE,"auth.subject_roles",{resource:{role_id:e.id}},n)&&r.push(e.id)}),{rolesAddable:i,rolesRemovable:r}},ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(e=>{var t;let[a]=null!==(t=e.role_ids)&&void 0!==t?t:[],n=s.find(e=>e.id===a);return(null==n?void 0:n.name)==="Owner"&&!e.invited_at}).length>1},ns=()=>{var e,s;let{slug:t}=(0,r.UO)(),{profile:a}=(0,aK.Un)(),n=(0,er.l)(),{permissions:l}=(0,b.Rc)(),o=(0,eg.j)(t),[h,p]=(0,u.useState)(!1),{data:x}=(0,st.Sy)(),{data:g}=an({slug:t}),{data:j,isSuccess:v}=a3({slug:t}),f=(null!==(e=null==j?void 0:j.org_scoped_roles)&&void 0!==e?e:[]).sort((e,s)=>s.base_role_id-e.base_role_id),y=(null!=x?x:[]).filter(e=>e.organization_id===(null==n?void 0:n.id)),N=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:w,isSuccess:S}=(0,d.G)({orgSlug:t},{enabled:N}),_=null==w?void 0:w.plan,C=null==g?void 0:g.find(e=>e.gotrue_id===(null==a?void 0:a.gotrue_id)),Z=1===(null!==(s=null==C?void 0:C.role_ids)&&void 0!==s?s:[]).length&&f.some(e=>e.id===(null==C?void 0:C.role_ids[0])),{rolesAddable:I}=a9(null==n?void 0:n.slug,f,null!=l?l:[]),A=Z&&f.some(e=>{let{id:s}=e;return(0,b.G8)(l,c.KA.CREATE,"user_invites",{resource:{role_id:s}},null==n?void 0:n.slug)}),{mutate:z,isLoading:E}=a1(),{mutate:k,isLoading:T}=a6(),P=sP.Ry({email:sP.Z_().email("Must be a valid email address").min(1,"Email is required"),role:sP.Z_().min(1,"Role is required"),applyToOrg:sP.O7(),projectRef:sP.Z_()}),O=(0,sT.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,sE.F)(P),defaultValues:{email:"",role:"",applyToOrg:!0,projectRef:""}}),{applyToOrg:R}=O.watch(),D=async e=>{if(!t)return console.error("Slug is required");if((null==a?void 0:a.id)===void 0)return console.error("Profile ID required");let s=f.find(e=>"Developer"===e.name),n=(null!=g?g:[]).find(s=>s.primary_email===e.email.toLowerCase());if(void 0!==n)return n.invited_id?(0,m.ZP)("User has already been invited to this organization"):(0,m.ZP)("User is already in this organization");o?z({slug:t,email:e.email.toLowerCase(),roleId:Number(e.role),...!e.applyToOrg&&e.projectRef?{projects:[e.projectRef]}:{}},{onSuccess:()=>{var e;m.ZP.success("Successfully sent invitation to new member"),p(!h),O.reset({email:"",role:null!==(e=null==s?void 0:s.id.toString())&&void 0!==e?e:"",applyToOrg:!0,projectRef:""})}}):k({slug:t,invitedEmail:e.email.toLowerCase(),ownerId:a.id,roleId:Number(e.role)},{onSuccess:e=>{if(a$()(e))m.ZP.error("Failed to add member");else{var t;m.ZP.success("Successfully added new member"),p(!h),O.reset({email:"",role:null!==(t=null==s?void 0:s.id.toString())&&void 0!==t?t:"",applyToOrg:!0,projectRef:""})}}})};return(0,u.useEffect)(()=>{if(v&&h){let e=f.find(e=>"Developer"===e.name);void 0!==e&&O.setValue("role",e.id.toString())}},[v,h]),(0,u.useEffect)(()=>{if(R)O.setValue("projectRef","");else{let e=null==y?void 0:y[0];void 0!==e&&O.setValue("projectRef",e.ref)}},[R]),(0,i.jsxs)(a8.Vq,{open:h,onOpenChange:p,children:[(0,i.jsx)(a8.hg,{asChild:!0,children:(0,i.jsxs)(aC.u,{children:[(0,i.jsx)(aC.aJ,{asChild:!0,children:(0,i.jsx)(Y.z,{disabled:!A,className:"pointer-events-auto",onClick:()=>p(!0),children:"Invite"})}),!A&&(0,i.jsx)(aC._v,{side:"bottom",children:"You need additional permissions to invite a member to this organization"})]})}),(0,i.jsxs)(a8.cZ,{size:"medium",children:[(0,i.jsx)(a8.fK,{children:(0,i.jsx)(a8.$N,{children:"Invite a member to this organization"})}),(0,i.jsx)(a8.P3,{}),(0,i.jsx)(sU.l0,{...O,children:(0,i.jsxs)("form",{id:"organization-invitation",className:"flex flex-col gap-y-4",onSubmit:O.handleSubmit(D),children:[(0,i.jsxs)(a8.VO,{className:"flex flex-col gap-y-4 pb-2",children:[o&&(null==_?void 0:_.id)==="enterprise"&&(0,i.jsx)(sU.Wi,{name:"applyToOrg",control:O.control,render:e=>{let{field:s}=e;return(0,i.jsxs)(sU.xJ,{className:"flex items-center gap-x-4",children:[(0,i.jsx)(sU.NI,{children:(0,i.jsx)(a7.r,{checked:s.value,onCheckedChange:e=>O.setValue("applyToOrg",e)})}),(0,i.jsx)(sU.lX,{children:"Apply role to all projects in the organization"})]})}}),(0,i.jsx)(sU.Wi,{name:"role",control:O.control,render:e=>{var s,t;let{field:a}=e;return(0,i.jsxs)(sU.xJ,{className:"flex flex-col gap-y-2",children:[(0,i.jsx)(sU.lX,{children:"Member role"}),(0,i.jsx)(sU.NI,{children:(0,i.jsxs)(sF.Ph,{value:a.value,onValueChange:e=>O.setValue("role",e),children:[(0,i.jsx)(sF.i4,{className:"text-sm h-10 capitalize",children:null!==(t=null===(s=f.find(e=>e.id===Number(a.value)))||void 0===s?void 0:s.name)&&void 0!==t?t:"Unknown"}),(0,i.jsx)(sF.Bw,{children:(0,i.jsx)(sF.DI,{children:f.map(e=>{let s=I.includes(e.id);return(0,i.jsxs)(sF.Ql,{value:e.id.toString(),className:"text-sm [&>span:nth-child(2)]:w-full [&>span:nth-child(2)]:flex [&>span:nth-child(2)]:items-center [&>span:nth-child(2)]:justify-between",disabled:!s,children:[(0,i.jsx)("span",{children:e.name}),!s&&(0,i.jsx)("span",{children:"Additional permissions required to assign role"})]},e.id)})})})]})})]})}}),!R&&(0,i.jsx)(sU.Wi,{name:"projectRef",control:O.control,render:e=>{var s,t;let{field:a}=e;return(0,i.jsxs)(sU.xJ,{className:"flex flex-col gap-y-2",children:[(0,i.jsx)(sU.lX,{children:"Select a project"}),(0,i.jsx)(sU.NI,{children:(0,i.jsxs)(sF.Ph,{value:a.value,onValueChange:e=>O.setValue("projectRef",e),children:[(0,i.jsx)(sF.i4,{className:"text-sm h-10 capitalize text-left truncate max-w-[470px]",children:null!==(t=null===(s=y.find(e=>e.ref===a.value))||void 0===s?void 0:s.name)&&void 0!==t?t:"Unknown"}),(0,i.jsx)(sF.Bw,{children:(0,i.jsx)(sF.DI,{children:y.map(e=>(0,i.jsx)(sF.Ql,{value:e.ref,className:"text-sm",children:e.name},e.id))})})]})}),(0,i.jsx)(sU.pf,{children:"You can assign roles to multiple projects once the invite is accepted"})]})}}),(0,i.jsx)(sU.Wi,{name:"email",control:O.control,render:e=>{let{field:s}=e;return(0,i.jsxs)(sU.xJ,{className:"flex flex-col gap-y-2",children:[(0,i.jsx)(sU.lX,{children:"Email address"}),(0,i.jsx)(sU.NI,{children:(0,i.jsx)(sY.I,{autoFocus:!0,...s,autoComplete:"off",disabled:E||T,placeholder:"Enter email address"})}),(0,i.jsx)(sU.zG,{})]})}}),(0,i.jsx)(e7.Z,{defaultVisibility:!1,title:"Single Sign-on (SSO) login option available",hideCollapse:!1,description:(0,i.jsxs)("div",{className:"space-y-4 mb-1",children:[(0,i.jsx)("p",{children:"Supabase offers single sign-on (SSO) as a login option to provide additional account security for your team. This allows company administrators to enforce the use of an identity provider when logging into Supabase."}),(0,i.jsx)("p",{children:"This is only available for organizations on Team Plan or above."}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/sso",target:"_blank",rel:"noreferrer",children:"Learn more"})}),S&&((null==_?void 0:_.id)==="free"||(null==_?void 0:_.id)==="pro")&&(0,i.jsx)(Y.z,{asChild:!0,type:"default",children:(0,i.jsx)(L(),{href:"/org/".concat(t,"/billing?panel=subscriptionPlan"),children:"Upgrade to Team"})})]})]})})]}),(0,i.jsx)(a8.P3,{}),(0,i.jsx)(a8.VO,{className:"pt-0",children:(0,i.jsx)(Y.z,{block:!0,htmlType:"submit",loading:E||T,children:"Send invitation"})})]})})]})]})};var nt=t(66594),na=t(98611),nn=t(55446),ni=t(17747),nr=t(81384);function nl(e){let s=new Date(e);return!((new Date().valueOf()-s.valueOf())/1e3/60/60<24)}let no=e=>{if(!e)return"";let{username:s,primary_email:t,invited_id:a}=e||{};return void 0!==a?t:s||""};async function nd(e){let{slug:s,id:t}=e,{error:a}=await (0,y.IV)("/platform/organizations/{slug}/members/invitations/{id}",{params:{path:{slug:s,id:t}}});return a&&(0,y.S3)(a),!0}let nc=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>nd(e),{async onSuccess(s,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([a.invalidateQueries(a0.O.rolesV2(i)),a.invalidateQueries(N.O.members(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to delete invitation: ".concat(e.message)):s(e,t,a)},...t})};async function nu(e){let{slug:s,invitedId:t}=e,{data:a,error:n}=await (0,y.IV)("/platform/organizations/{slug}/members/invite",{params:{path:{slug:s},query:{invited_id:t}}});return n&&(0,y.S3)(n),a}let nm=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>nu(e),{async onSuccess(s,t,n){let{slug:i,invalidateDetail:r}=t;await Promise.all([...null==r||r?[a.invalidateQueries(N.O.members(i))]:[],a.invalidateQueries(N.O.roles(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to revoke invitation: ".concat(e.message)):s(e,t,a)},...t})};var nh=t(18149),np=t.n(nh),nx=t(7117),ng=t(61786),nj=t(90504),nv=t(19869);async function nf(e){let{slug:s,gotrueId:t,roleId:a,projects:n}=e,i={role_id:a};void 0!==n&&(i.role_scoped_projects=n);let{data:r,error:l}=await (0,y.r$)("/platform/organizations/{slug}/members/{gotrue_id}",{params:{path:{slug:s,gotrue_id:t}},body:i,headers:{Version:"2"}});return l&&(0,y.S3)(l),r}let ny=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>nf(e),{async onSuccess(s,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([a.invalidateQueries(a0.O.rolesV2(i)),a.invalidateQueries(N.O.members(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update member role: ".concat(e.message)):s(e,t,a)},...t})};async function nb(e){let{slug:s,gotrueId:t,roleId:a}=e,{data:n,error:i}=await (0,y.IV)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:s,gotrue_id:t,role_id:a.toString()}}});return i&&(0,y.S3)(i),n}let nN=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>nb(e),{async onSuccess(s,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([a.invalidateQueries(a0.O.rolesV2(i)),a.invalidateQueries(N.O.members(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to unassign member role: ".concat(e.message)):s(e,t,a)},...t})};async function nw(e){let{slug:s,gotrueId:t,roleId:a,roleName:n,projects:i}=e,{data:r,error:l}=await (0,y.gz)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:s,gotrue_id:t,role_id:a.toString()}},body:{name:n,role_scoped_projects:i}});return l&&(0,y.S3)(l),r}let nS=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,_.NL)();return(0,C.D)(e=>nw(e),{async onSuccess(s,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([a.invalidateQueries(a0.O.rolesV2(i)),a.invalidateQueries(N.O.members(i))]),await (null==e?void 0:e(s,t,n))},async onError(e,t,a){void 0===s?m.Am.error("Failed to update member role: ".concat(e.message)):s(e,t,a)},...t})};var n_=t(3440),nC=t.n(n_);let nZ=(e,s,t)=>{let{org_scoped_roles:a,project_scoped_roles:n}=s;return e.role_ids.map(e=>{let s=a.find(s=>s.id===e);if(void 0!==s)return{ref:void 0,roleId:s.id};let i=n.find(s=>s.id===e);if(void 0!==i){var r;return(null!==(r=null==i?void 0:i.project_ids)&&void 0!==r?r:[]).map(e=>t.find(s=>s.id===e)).map(e=>({ref:null==e?void 0:e.ref,projectId:null==e?void 0:e.id,roleId:i.id,baseRoleId:i.base_role_id}))}}).filter(Boolean).flat()},nI=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,a=[],n=[],i=[];return e.forEach(e=>{let t=s.find(s=>e.ref===s.ref);void 0===t?a.push(e):t.roleId!==e.roleId&&i.push({ref:t.ref,originalRole:e.roleId,originalBaseRole:e.baseRoleId,updatedRole:t.roleId})}),s.forEach(s=>{void 0===e.find(e=>s.ref===e.ref)&&n.push(s)}),{removed:a.map(e=>{var s;return{...e,projectId:null===(s=t.find(s=>s.ref===e.ref))||void 0===s?void 0:s.id}}),added:n.map(e=>{var s;return{...e,projectId:null===(s=t.find(s=>s.ref===e.ref))||void 0===s?void 0:s.id}}),updated:i.map(e=>{var s;return{...e,projectId:null===(s=t.find(s=>s.ref===e.ref))||void 0===s?void 0:s.id}})}},nA=(e,s)=>{let{removed:t,added:a,updated:n}=s,i=[],r=[],l=[],o=nC()(a,"roleId"),d=nC()(t,"roleId"),c=nC()(n,"originalRole"),u=nC()(n,"updatedRole"),m=e.filter(e=>{var s;return(null!==(s=null==e?void 0:e.project_ids)&&void 0!==s?s:[]).length>0}).map(e=>e.base_role_id);return e.forEach(e=>{var s,r,m,h,p,x,g,j;let v=e.project_ids;if(null===v)return i.push(e.id);let f=v.every(e=>{let s=t.map(e=>e.projectId).some(s=>s===e),a=n.map(e=>e.projectId).some(s=>s===e);return s||a}),y=a.some(s=>s.roleId===e.base_role_id),b=n.some(s=>s.updatedRole===e.base_role_id);if(f&&!y&&!b)return i.push(e.id);let N=null!==(p=null===(s=o[e.base_role_id])||void 0===s?void 0:s.map(e=>e.projectId))&&void 0!==p?p:[],w=null!==(x=null===(r=d[e.id])||void 0===r?void 0:r.map(e=>e.projectId))&&void 0!==x?x:[],S=null!==(g=null===(m=c[e.id])||void 0===m?void 0:m.map(e=>e.projectId))&&void 0!==g?g:[],_=null!==(j=null===(h=u[e.base_role_id])||void 0===h?void 0:h.map(e=>e.projectId))&&void 0!==j?j:[],C=v.filter(e=>!w.includes(e)).filter(e=>!S.includes(e)).concat(N).concat(_);np()(v,C)||l.push({roleId:e.id,projectIds:C.sort((e,s)=>e-s)})}),Object.keys(o).forEach(e=>{m.includes(Number(e))||r.push({roleId:Number(e),projectIds:o[e].map(e=>e.projectId).sort((e,s)=>e-s)})}),Object.keys(u).forEach(e=>{m.includes(Number(e))||r.push({roleId:Number(e),projectIds:u[e].map(e=>e.projectId).sort((e,s)=>e-s)})}),{toRemove:i.sort((e,s)=>e-s),toAssign:r,toUpdate:l}},nz=e=>{var s;let{visible:t,member:a,projectsRoleConfiguration:n,onClose:l}=e,{slug:o}=(0,r.UO)(),d=(0,_.NL)(),c=(0,er.l)(),{data:h}=(0,st.Sy)(),{data:p}=a3({slug:null==c?void 0:c.slug}),[x,g]=(0,u.useState)(!1),{mutateAsync:j}=ny(),{mutateAsync:v}=nN({onError:()=>{}}),{mutateAsync:f}=nS(),y=null!==(s=null==p?void 0:p.org_scoped_roles)&&void 0!==s?s:[],{org_scoped_roles:b,project_scoped_roles:w}=null!=p?p:{org_scoped_roles:[],project_scoped_roles:[]},S=(null!=h?h:[]).filter(e=>e.organization_id===(null==c?void 0:c.id)),C=nI(void 0!==p?nZ(a,p,null!=h?h:[]):[],n,null!=h?h:[]),Z=async()=>{if(void 0===o)return console.error("Slug is required");g(!0);let e=a.gotrue_id,s=a.role_ids.map(e=>[...b,...w].find(s=>s.id===e)).filter(Boolean);if(1===n.length&&void 0===n[0].ref)try{await j({slug:o,gotrueId:e,roleId:n[0].roleId}),m.ZP.success("Successfully updated role for ".concat(a.username)),l(!0);return}catch(e){return g(!1),m.ZP.error("Failed to update role: ".concat(e.message))}let{toRemove:t,toAssign:i,toUpdate:r}=nA(s,C);try{await Promise.all([...i.map(s=>{let{roleId:t,projectIds:a}=s;return j({slug:o,gotrueId:e,roleId:t,projects:a.map(e=>{var s;return null==h?void 0:null===(s=h.find(s=>s.id===e))||void 0===s?void 0:s.ref})})})]),await Promise.all([...t.map(s=>v({slug:o,gotrueId:e,roleId:s})),...r.map(s=>{var t;let{roleId:a,projectIds:n}=s;return f({slug:o,gotrueId:e,roleId:a,roleName:null===(t=w.find(e=>e.id===a))||void 0===t?void 0:t.name,projects:n.map(e=>{var s;return null==h?void 0:null===(s=h.find(s=>s.id===e))||void 0===s?void 0:s.ref})})})]),await Promise.all([d.invalidateQueries(a0.O.rolesV2(o)),d.invalidateQueries(N.O.members(o))]),m.ZP.success("Successfully updated role for ".concat(a.username)),l(!0)}catch(e){return g(!1),m.ZP.error("Failed to update role: ".concat(e.message))}};return(0,i.jsx)(aQ.Z,{size:"medium",visible:t,loading:x,title:"Confirm to change roles of member",confirmLabel:"Update roles",confirmLabelLoading:"Updating",onCancel:()=>l(),onConfirm:Z,children:(0,i.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["You are making the following changes to the role of"," ",(0,i.jsx)("span",{className:"text-foreground",children:a.username})," in the organization"," ",(0,i.jsx)("span",{className:"text-foreground",children:null==c?void 0:c.name}),":"]}),(0,i.jsxs)("div",{className:"flex flex-col gap-y-2",children:[0!==C.removed.length&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm",children:["Removing ",C.removed.length," role",C.removed.length>1?"s":""," for user:"]}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:C.removed.map((e,s)=>{var t,a,n;let r=null!==(t=b.find(s=>s.id===e.roleId))&&void 0!==t?t:w.find(s=>s.id===e.roleId),l=S.find(s=>s.ref===e.ref),o=(null!==(a=null==r?void 0:r.name)&&void 0!==a?a:"Unknown").split("_")[0];return(0,i.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,i.jsx)("span",{className:"text-foreground",children:o})," on"," ",(0,i.jsx)("span",{className:void 0!==l?"text-foreground":"",children:null!==(n=null==l?void 0:l.name)&&void 0!==n?n:"organization"})]},"update-".concat(s))})})]}),0!==C.added.length&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm",children:["Adding ",C.added.length," role",C.added.length>1?"s":""," for user:"]}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:C.added.map((e,s)=>{var t;let a=y.find(s=>s.id===e.roleId),n=S.find(s=>s.ref===e.ref);return(0,i.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,i.jsx)("span",{className:"text-foreground",children:null==a?void 0:a.name})," on"," ",(0,i.jsx)("span",{className:void 0!==n?"text-foreground":"",children:null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"organization"})]},"update-".concat(s))})})]}),0!==C.updated.length&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm",children:["Updating ",C.updated.length," role",C.updated.length>1?"s":""," for user:"]}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:C.updated.map((e,s)=>{var t,a,n;let r=null!==(t=b.find(s=>s.id===e.originalRole))&&void 0!==t?t:w.find(s=>s.id===e.originalRole),l=b.find(s=>s.id===e.updatedRole),o=S.find(s=>s.ref===e.ref),d=(null!==(a=null==r?void 0:r.name)&&void 0!==a?a:"Unknown").split("_")[0];return(0,i.jsxs)("li",{className:"text-sm text-foreground-light",children:["From ",(0,i.jsx)("span",{className:"text-foreground",children:d})," to"," ",(0,i.jsx)("span",{className:"text-foreground",children:null==l?void 0:l.name})," on"," ",(0,i.jsx)("span",{className:void 0!==o?"text-foreground":"",children:null!==(n=null==o?void 0:o.name)&&void 0!==n?n:"organization"})]},"update-".concat(s))})})]})]}),(0,i.jsx)("p",{className:"text-sm text-foreground",children:"By changing the role of this member their permissions will change."})]})})},nE=e=>{var s,t,a,n;let{visible:l,member:o,onClose:d}=e,{slug:c}=(0,r.UO)(),m=(0,er.l)(),h=(0,eg.j)(c),{data:p}=(0,st.Sy)(),{data:x}=(0,aX.j)(),{data:g,isSuccess:j}=a3({slug:c}),v=null!==(a=null==g?void 0:g.org_scoped_roles)&&void 0!==a?a:[],f=null!==(n=null==g?void 0:g.project_scoped_roles)&&void 0!==n?n:[],{rolesAddable:y,rolesRemovable:b}=a9(null==m?void 0:m.slug,v.concat(f),null!=x?x:[]),N=v.every(e=>!y.includes(e.id)),[w,S]=(0,u.useState)(!1),[_,C]=(0,u.useState)(!1),[Z,I]=(0,u.useState)([]),A=void 0!==g?nZ(o,g,null!=p?p:[]):[],z=(null!=p?p:[]).filter(e=>e.organization_id===(null==m?void 0:m.id)),E=1===Z.length&&(null===(s=Z[0])||void 0===s?void 0:s.ref)===void 0,k=Z.length>0,T=null===(t=v.find(e=>"Developer"===e.name))||void 0===t?void 0:t.id,P=["Owner","Administrator","Developer"].reduce((e,s,t)=>({...e,[s]:t}),{}),O=z.filter(e=>!Z.some(s=>s.ref===e.ref)),R=z.length-O.length,L=A.length!==O.length,D=e=>{I(Z.concat({ref:e,roleId:null!=T?T:v[0].id})),C(!1)},M=e=>{void 0!==e&&I(Z.filter(s=>s.ref!==e))},U=(e,s)=>{void 0!==s.ref?I(Z.map(t=>t.ref===s.ref?{ref:t.ref,projectId:t.projectId,roleId:Number(e)}:t)):I([{ref:void 0,roleId:Number(e)}])};return(0,u.useEffect)(()=>{l&&j&&I(nZ(o,g,null!=p?p:[]))},[l,j]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(nx.yo,{open:l,onOpenChange:()=>d(),children:(0,i.jsx)(nx.ue,{showClose:!1,size:"default",className:(0,eA.cn)("bg-surface-200 p-0 flex flex-row gap-0 !min-w-[400px]"),children:(0,i.jsxs)("div",{className:(0,eA.cn)("flex flex-col grow w-full"),children:[(0,i.jsxs)(nx.Tu,{className:(0,eA.cn)("py-3 flex flex-row justify-between gap-x-4 items-center border-b"),children:[(0,i.jsxs)("p",{className:"truncate",title:"Manage access for ".concat(o.username),children:["Manage access for ",o.username]}),(0,i.jsx)(Y.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/access-control",children:"Documentation"})})]}),(0,i.jsxs)(nx.DN,{className:"h-full overflow-auto flex flex-col gap-y-4",children:[h&&(0,i.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,i.jsx)(a7.r,{disabled:N,checked:E,onCheckedChange:()=>{var e,s,t;let a=null!==(t=null!==(s=null===(e=Z[0])||void 0===e?void 0:e.roleId)&&void 0!==s?s:T)&&void 0!==t?t:v[0].id;E?I(z.map(e=>({ref:e.ref,projectId:e.id,roleId:a}))):I([{ref:void 0,roleId:a}])}}),(0,i.jsx)("p",{className:"text-sm",children:"Apply roles to all projects in the organization"})]}),0===Z.length&&(0,i.jsxs)(ey.bZ,{children:[(0,i.jsx)(e0.aN,{}),(0,i.jsx)(ey.Cd,{children:"Team members need to be assigned at least one role"}),(0,i.jsx)(ey.X,{children:"You may not remove all roles from a team member"})]}),!E&&Z.length>0&&Z.length!==z.length&&(0,i.jsxs)(ey.bZ,{children:[(0,i.jsx)(ey.Cd,{children:L?"This member will only have access to ".concat(R," project").concat(R>1?"s":""):"This member only has access to ".concat(R," project").concat(R>1?"s":"")}),(0,i.jsxs)(ey.X,{children:[o.username," ",L?"will":"does"," not have access to the following ",O.length," project",O.length>1?"s":"",":",(0,i.jsx)("ul",{className:"list-disc pl-6",children:O.map(e=>(0,i.jsx)("li",{children:e.name},e.id))})]})]}),(0,i.jsx)("div",{className:"flex flex-col gap-y-2",children:Z.sort((e,s)=>{var t,a;return(null!==(t=null==e?void 0:e.projectId)&&void 0!==t?t:0)-(null!==(a=null==s?void 0:s.projectId)&&void 0!==a?a:0)}).map(e=>{var s,t,a,n,r;let l=void 0===e.ref?"All projects":null==p?void 0:null===(s=p.find(s=>s.ref===e.ref))||void 0===s?void 0:s.name,o=v.find(s=>void 0!==e.baseRoleId?s.id===e.baseRoleId:s.id===e.roleId),d=b.includes(null!==(t=null==o?void 0:o.id)&&void 0!==t?t:0);return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"text-sm",children:l}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2",children:[N?(0,i.jsxs)(aC.u,{children:[(0,i.jsx)(aC.aJ,{asChild:!0,children:(0,i.jsx)("div",{className:"flex items-center justify-between rounded-md border border-button bg-button px-3 py-2 text-sm h-10 w-56 text-foreground-light",children:null!==(a=null==o?void 0:o.name)&&void 0!==a?a:"Unknown"})}),(0,i.jsx)(aC._v,{side:"bottom",children:"Additional permissions required to update role"})]}):(0,i.jsxs)(sF.Ph,{value:(null!==(n=null==e?void 0:e.baseRoleId)&&void 0!==n?n:e.roleId).toString(),onValueChange:s=>U(s,e),children:[(0,i.jsx)(sF.i4,{className:(0,eA.cn)("text-sm h-10 w-56",(null==o?void 0:o.name)===void 0&&"text-foreground-light"),children:null!==(r=null==o?void 0:o.name)&&void 0!==r?r:"Please select a role"}),(0,i.jsx)(sF.Bw,{children:(0,i.jsx)(sF.DI,{children:(null!=v?v:[]).sort((e,s)=>P[e.name]-P[s.name]).map(e=>{let s=y.includes(e.id);return(0,i.jsx)(sF.Ql,{value:e.id.toString(),className:"text-sm",disabled:!s,children:e.name},e.id)})})})]}),!E&&(0,i.jsxs)(aC.u,{children:[(0,i.jsx)(aC.aJ,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"text",disabled:!d,className:"px-1",icon:(0,i.jsx)(sk.Z,{size:14}),onClick:()=>M(null==e?void 0:e.ref)})}),!d&&(0,i.jsx)(aC._v,{side:"bottom",children:"Additional permission required to remove role from member"})]})]})]},"".concat(e.ref,"-").concat(e.roleId))})}),!E&&(0,i.jsxs)(ng.J2,{open:_,onOpenChange:C,modal:!1,children:[(0,i.jsx)(ng.xo,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"default",className:"w-min",children:"Assign role to project"})}),(0,i.jsx)(ng.yk,{className:"p-0",side:"bottom",align:"start",children:(0,i.jsxs)(nj.mY,{children:[(0,i.jsx)(nj.sZ,{placeholder:"Find project..."}),(0,i.jsxs)(nj.e8,{children:[(0,i.jsx)(nj.rb,{children:"No projects found"}),(0,i.jsx)(nj.fu,{children:(0,i.jsx)(nv.x,{className:(p||[]).length>7?"h-[210px]":"",children:z.map(e=>{let s=Z.some(s=>s.ref===e.ref);return(0,i.jsxs)(nj.di,{disabled:s,className:"cursor-pointer w-full justify-between",onSelect:()=>D(e.ref),onClick:()=>D(e.ref),children:[(0,i.jsx)("p",{className:"truncate",children:e.name}),s&&(0,i.jsx)("p",{className:"w-[45%] text-right",children:"Already assigned"})]},e.ref)})})})]})]})})]})]}),(0,i.jsxs)(nx.FF,{className:"flex items-center !justify-end px-5 py-4 w-full border-t",children:[(0,i.jsx)(Y.z,{type:"default",disabled:!1,onClick:()=>d(),children:"Cancel"}),(0,i.jsx)(Y.z,{loading:!1,disabled:!k,onClick:()=>{np()(Z,A)?d():S(!0)},children:"Save roles"})]})]})})}),(0,i.jsx)(nz,{visible:w,member:o,projectsRoleConfiguration:Z,onClose:e=>{S(!1),e&&d()}})]})},nk=e=>{var s,t,a,n,l;let{member:d}=e,{slug:h}=(0,r.UO)(),{profile:p}=(0,aK.Un)(),[x,g]=(0,u.useState)(!1),[j,v]=(0,u.useState)(!1),f=(0,o.N)("organization_members:delete"),y=(0,er.l)(),{data:N}=(0,aX.j)(),{data:w}=(0,st.Sy)(),{data:S}=an({slug:h}),{data:_}=a3({slug:h}),C=(0,eg.j)(h),Z=null!==(t=null==_?void 0:_.org_scoped_roles)&&void 0!==t?t:[],I=null!==(a=null==_?void 0:_.project_scoped_roles)&&void 0!==a?a:[],A=!!d.invited_id,z=null==S?void 0:S.find(e=>e.gotrue_id===(null==p?void 0:p.gotrue_id)),E=1===(null!==(n=null==z?void 0:z.role_ids)&&void 0!==n?n:[]).length&&Z.some(e=>e.id===(null==z?void 0:z.role_ids[0])),{rolesRemovable:k}=a9(null==y?void 0:y.slug,Z.concat(I),null!=N?N:[]),T=null!==(l=null===(s=d.role_ids)||void 0===s?void 0:s[0])&&void 0!==l?l:-1,P=d.role_ids.every(e=>k.includes(e)),O=(0,b.Xo)(c.KA.CREATE,"user_invites",{resource:{role_id:T}})&&E,R=(0,b.Xo)(c.KA.DELETE,"user_invites",{resource:{role_id:T}})&&E,{mutate:L,isLoading:D}=aH({onSuccess:()=>{m.ZP.success("Successfully removed ".concat(d.primary_email)),v(!1)}}),{mutate:M,isLoading:U}=a1({onSuccess:()=>{m.ZP.success("Resent the invitation.")},onError:e=>{m.ZP.error("Failed to resend invitation: ".concat(e.message))}}),{mutate:F,isLoading:G}=a6({onSuccess:()=>{m.ZP.success("Resent the invitation")},onError:e=>{m.ZP.error("Failed to resend the invidation: ".concat(e.message))}}),{mutate:B,isLoading:V}=nc(),{mutate:q}=nm(),W=D||V||U,H=()=>h?d.gotrue_id?void L({slug:h,gotrueId:d.gotrue_id}):console.error("gotrue_id is required"):console.error("slug is required"),X=e=>{var s;let t=(null!==(s=null==e?void 0:e.role_ids)&&void 0!==s?s:[])[0],a=e.invited_id;return h?a?void(C?B({slug:h,id:a,skipInvalidation:!0},{onSuccess:()=>{if(!e.primary_email)return m.ZP.error("Email is required");let s=I.find(e=>e.id===t);if(void 0!==s){var a;let t=(null!==(a=null==s?void 0:s.project_ids)&&void 0!==a?a:[]).map(e=>{var s;return null==w?void 0:null===(s=w.find(s=>s.id===e))||void 0===s?void 0:s.ref}).filter(Boolean);M({slug:h,email:e.primary_email,roleId:s.base_role_id,projects:t})}else M({slug:h,email:e.primary_email,roleId:t})}}):q({slug:h,invitedId:a,invalidateDetail:!1},{onSuccess:()=>{F({slug:h,invitedEmail:e.primary_email,ownerId:a,roleId:t})}})):console.error("Member invited ID is required"):console.error("Slug is required")},K=e=>{let s=e.invited_id;return h?s?void(C?B({slug:h,id:s},{onSuccess:()=>m.ZP.success("Successfully revoked the invitation.")}):q({slug:h,invitedId:s},{onSuccess:()=>m.ZP.success("Successfully revoked the invitation.")})):console.error("Member invited ID is required"):console.error("Slug is required")};return P&&(!A||O||R)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-end gap-x-2",children:[(0,i.jsx)(e8.u,{type:"default",disabled:A||!P,onClick:()=>g(!0),tooltip:{content:{side:"bottom",text:A?"Role can only be changed after the user has accepted the invite":P?void 0:"You need additional permissions to manage this team member"}},children:"Manage access"}),(0,i.jsxs)(eY.h_,{children:[(0,i.jsx)(eY.$F,{asChild:!0,children:(0,i.jsx)(Y.z,{type:"text",className:"px-1.5",disabled:W,loading:W,icon:(0,i.jsx)(aw.Z,{})})}),(0,i.jsx)(eY.AW,{side:"bottom",align:"end",children:(0,i.jsx)(i.Fragment,{children:A?(0,i.jsxs)(i.Fragment,{children:[R&&(0,i.jsx)(eY.Xi,{onClick:()=>K(d),children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Cancel invitation"}),(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Revoke this invitation."})]})}),O&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eY.VD,{}),(0,i.jsx)(eY.Xi,{onClick:()=>X(d),children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Resend invitation"}),(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Invites expire after 24hrs."})]})})]})]}):f&&(0,i.jsxs)(eY.Xi,{className:"space-x-2 items-start",disabled:!P,onClick:()=>{v(!0)},children:[(0,i.jsx)(a_.Z,{size:16}),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Remove member"}),!P&&(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Additional permissions required"})]})]})})})]})]}),(0,i.jsx)(aQ.Z,{visible:j,loading:D,title:"Confirm to remove",confirmLabel:"Remove",onCancel:()=>v(!1),onConfirm:()=>{H()},children:(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to remove ",d.primary_email]})}),(0,i.jsx)(nE,{visible:x,member:d,onClose:()=>g(!1)})]}):(0,i.jsx)("div",{className:"flex items-center justify-end",children:(0,i.jsx)(e8.u,{disabled:!0,type:"text",className:"px-1.5",icon:(0,i.jsx)(aw.Z,{size:18}),tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this team member"}}})})},nT=e=>{var s;let{member:t}=e,{slug:a}=(0,r.UO)(),{profile:n}=(0,aK.Un)(),{data:l}=(0,st.Sy)(),o=(0,er.l)(),[d,c]=(0,u.useState)(!1),m=(0,eg.j)(a),{data:h,isLoading:p}=a3({slug:null==o?void 0:o.slug}),x=t.gotrue_id==(null==n?void 0:n.gotrue_id),g=!!t.invited_id,j=t.username===t.primary_email,v=!!(null===(s=t.primary_email)||void 0===s?void 0:s.endsWith("customer.fly.io")),f=t.role_ids.filter(e=>{var s,t,a;let n=[...null!==(s=null==h?void 0:h.org_scoped_roles)&&void 0!==s?s:[],...null!==(t=null==h?void 0:h.project_scoped_roles)&&void 0!==t?t:[]].find(s=>s.id===e);return(null==n?void 0:n.project_ids)!==null&&0===(null!==(a=null==n?void 0:n.project_ids)&&void 0!==a?a:[]).map(e=>{var s,t;return null!==(t=null==l?void 0:null===(s=l.find(s=>s.id===e))||void 0===s?void 0:s.name)&&void 0!==t?t:""}).filter(e=>e.length>0).length}).length>0;return(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{children:g||j||v||d?(0,i.jsx)("div",{className:"w-[40px] h-[40px] bg-surface-100 border border-overlay rounded-full text-foreground-lighter flex items-center justify-center",children:(0,i.jsx)(t3.Z,{size:20,strokeWidth:1.5})}):(0,i.jsx)(t6(),{alt:t.username,src:"https://github.com/".concat(t.username,".png?size=80"),width:"40",height:"40",className:"border rounded-full",onError:()=>{c(!0)}})}),(0,i.jsxs)("div",{className:"flex item-center gap-x-2",children:[void 0===g?(0,i.jsx)("p",{className:"text-foreground-light truncate",children:t.primary_email}):(0,i.jsx)("p",{className:"text-foreground truncate",children:no(t)}),t.primary_email===(null==n?void 0:n.primary_email)&&(0,i.jsx)(eT.C,{color:"scale",children:"You"})]})]})}),(0,i.jsx)(eN.Z.td,{children:g&&t.invited_at&&(0,i.jsx)(eT.C,{variant:nl(t.invited_at)?"destructive":"warning",children:nl(t.invited_at)?"Expired":"Invited"})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("div",{className:"flex items-center justify-center",children:t.mfa_enabled?(0,i.jsx)(ab.Z,{className:"text-brand",strokeWidth:2,size:20}):(0,i.jsx)(sk.Z,{className:"text-foreground-light",strokeWidth:1.5,size:20})})}),(0,i.jsx)(eN.Z.td,{className:"max-w-64",children:p?(0,i.jsx)(nr.Z,{className:"w-32"}):f?(0,i.jsx)(ni.Z,{strokeWidth:1.5,size:20}):t.role_ids.map(e=>{var s,t,a,n,r;let o=(null!==(s=null==h?void 0:h.org_scoped_roles)&&void 0!==s?s:[]).find(s=>s.id===e),d=(null!==(t=null==h?void 0:h.project_scoped_roles)&&void 0!==t?t:[]).find(s=>s.id===e),c=o||d,u=(null!==(a=null==c?void 0:c.name)&&void 0!==a?a:"").split("_")[0],p=(null==c?void 0:c.project_ids)===null?null!==(n=null==l?void 0:l.map(e=>e.name))&&void 0!==n?n:[]:(null!==(r=null==c?void 0:c.project_ids)&&void 0!==r?r:[]).map(e=>{var s,t;return null!==(t=null==l?void 0:null===(s=l.find(s=>s.id===e))||void 0===s?void 0:s.name)&&void 0!==t?t:""}).filter(e=>e.length>0);return 0===p.length?null:(0,i.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,i.jsx)("p",{children:u}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"•"}),1===p.length?(0,i.jsx)("span",{className:"text-foreground truncate",title:p[0],children:p[0]}):(0,i.jsxs)(aC.u,{children:[(0,i.jsx)(aC.aJ,{asChild:!0,children:(0,i.jsx)("span",{className:"text-foreground",children:(null==c?void 0:c.project_ids)===null?"Organization":"".concat(p.length," project").concat(p.length>1?"s":"")})}),(0,i.jsxs)(aC._v,{side:"bottom",className:"flex flex-col gap-y-1",children:[null==p?void 0:p.slice(0,2).map(e=>(0,i.jsx)("span",{children:e},e)),p.length>2&&(0,i.jsxs)("span",{children:["And ",p.length-2," other project",p.length>4?"s":""]})]})]})]})]},"role-".concat(e))})}),(0,i.jsx)(eN.Z.td,{children:!x&&(0,i.jsx)(nk,{member:t})})]})};var nP=e=>{let{searchString:s}=e,{slug:t}=(0,r.UO)(),{profile:a}=(0,aK.Un)(),{data:n,error:l,isLoading:o,isError:d,isSuccess:c}=an({slug:t}),{error:u,isError:m}=a3({slug:t}),p=null!=n?n:[],x=(s?p.filter(e=>{var t,a;return e.invited_at?null===(t=e.primary_email)||void 0===t?void 0:t.includes(s):e.gotrue_id?e.username.includes(s)||(null===(a=e.primary_email)||void 0===a?void 0:a.includes(s)):void 0}):p).slice().sort((e,s)=>e.primary_email===(null==a?void 0:a.primary_email)?-1:e.username.localeCompare(s.username));return(0,i.jsxs)(i.Fragment,{children:[o&&(0,i.jsx)(v.A,{}),d&&(0,i.jsx)(h.Z,{error:l,subject:"Failed to retrieve organization members"}),m&&(0,i.jsx)(h.Z,{error:u,subject:"Failed to retrieve organization roles"}),c&&(0,i.jsx)("div",{className:"rounded w-full",children:(0,i.jsx)(nn.Z,{active:!x,children:(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{children:"User"},"header-user"),(0,i.jsx)(eN.Z.th,{className:"w-24"},"header-status"),(0,i.jsx)(eN.Z.th,{className:"text-center w-32",children:"Enabled MFA"},"header-mfa"),(0,i.jsxs)(eN.Z.th,{className:"flex items-center space-x-1",children:[(0,i.jsx)("span",{children:"Role"}),(0,i.jsxs)(aC.u,{children:[(0,i.jsx)(aC.aJ,{asChild:!0,children:(0,i.jsx)(Y.z,{asChild:!0,type:"text",className:"px-1",children:(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/access-control",children:(0,i.jsx)(nt.Z,{size:14,className:"text-foreground-light"})})})}),(0,i.jsx)(aC._v,{side:"bottom",children:"How to configure access control?"})]})]},"header-role"),(0,i.jsx)(eN.Z.th,{},"header-action")],body:[...x.map(e=>(0,i.jsx)(nT,{member:e},e.gotrue_id)),...s.length>0&&0===x.length?[(0,i.jsx)(eN.Z.tr,{className:"bg-panel-secondary-light",children:(0,i.jsx)(eN.Z.td,{colSpan:12,children:(0,i.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,i.jsx)(na.Z,{size:16,strokeWidth:2}),(0,i.jsxs)("p",{className:"text-foreground-light",children:['No users matched the search query "',s,'"']})]})})},"no-results")]:[],(0,i.jsx)(eN.Z.tr,{className:"bg-panel-secondary-light",children:(0,i.jsx)(eN.Z.td,{colSpan:12,children:(0,i.jsxs)("p",{className:"text-foreground-light",children:[s?"".concat(x.length," of "):"",p.length||"0"," ",1==p.length?"user":"users"]})})},"footer")]})})})]})},nO=()=>{var e;let{slug:s}=(0,r.UO)(),{organizationMembersCreate:t,organizationMembersDelete:a}=(0,o.N)(["organization_members:create","organization_members:delete"]),{profile:n}=(0,aK.Un)(),d=(0,er.l)(),c=null==d?void 0:d.is_owner,{data:h}=(0,aX.j)(),{data:p}=ar({slug:s}),{data:x}=an({slug:s}),g=null!==(e=null==p?void 0:p.roles)&&void 0!==e?e:[],{rolesAddable:j}=a9(null==d?void 0:d.slug,g,null!=h?h:[]),[v,f]=(0,u.useState)(!1),[y,b]=(0,u.useState)(""),N=j.length>0,w=!c||c&&ne(x,g),{mutate:S}=aH({onSuccess:()=>{var e;f(!1),C(!1),null===(e=window)||void 0===e||e.location.replace("/")},onError:e=>{f(!1),m.ZP.error("Failed to leave organization: ".concat(null==e?void 0:e.message))}}),[_,C]=(0,u.useState)(!1),Z=async()=>{if(!s)return console.error("Org slug is required");f(!0),S({slug:s,gotrueId:n.gotrue_id})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.gW,{children:(0,i.jsxs)(l.tM,{children:[(0,i.jsxs)(l.Wv,{className:"justify-between",children:[(0,i.jsx)(z.Z,{icon:(0,i.jsx)(aq.Z,{size:12}),size:"small",value:y,onChange:e=>b(e.target.value),name:"email",id:"email",placeholder:"Filter members"}),(0,i.jsxs)(l.ur,{children:[t&&N&&void 0!==n&&void 0!==d&&(0,i.jsx)(ns,{}),a&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e8.u,{type:"default",loading:v,disabled:!w,tooltip:{content:{side:"bottom",text:w?void 0:"An organization requires at least 1 owner"}},onClick:()=>C(!0),children:"Leave team"})})]})]}),(0,i.jsx)(l.Lc,{className:"w-full",children:(0,i.jsx)(nP,{searchString:y})})]})}),(0,i.jsx)(aQ.Z,{visible:_,title:"Are you sure?",confirmLabel:"Leave",onCancel:()=>C(!1),onConfirm:()=>{Z()},children:(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to leave this organization? This is permanent."})})]})},nR=()=>(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Data Processing Addendum (DPA)"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,i.jsx)("p",{children:"All organizations can access and use our DPA as part of their GDPR compliance. This is only to access the document. Please ignore this if you have sent the signed document to us."}),(0,i.jsxs)("p",{children:["Please review these details and add data specific to user processing where required. Sign and return the signed DPA document to"," ",(0,i.jsx)("a",{href:"mailto:privacy@supabase.com",target:"_blank",className:"text-brand hover:text-brand",children:"privacy@supabase.com"})," ","for the document to be considered executed."]})]})]}),(0,i.jsx)(l.Lc,{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+DPA+231211.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,i.jsx)(Y.z,{type:"default",iconRight:(0,i.jsx)(eI.Z,{}),children:"View DPA"})})})]}),nL=()=>(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Transfer Impact Assessment (TIA)"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"All organizations can access and use our TIA as part of their GDPR-compliant data transfer process."})})]}),(0,i.jsx)(l.Lc,{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+TIA+240510.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,i.jsx)(Y.z,{type:"default",iconRight:(0,i.jsx)(eI.Z,{}),children:"View TIA"})})})]}),nD=t(17913);async function nM(e,s){let{orgSlug:t,docType:a}=e;if(!t)throw Error("orgSlug is required");if("standard-security-questionnaire"===a){let{data:e,error:a}=await (0,y.U2)("/platform/organizations/{slug}/documents/standard-security-questionnaire",{params:{path:{slug:t}},signal:s});return a&&(0,y.S3)(a),e}if("soc2-type-2-report"===a){let{data:e,error:a}=await (0,y.U2)("/platform/organizations/{slug}/documents/soc2-type-2-report",{params:{path:{slug:t}},signal:s});if(a)throw a;return e}}var nU=()=>{let{slug:e}=(0,r.UO)(),s=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:t,error:a,isLoading:n,isError:o,isSuccess:u}=(0,d.G)({orgSlug:e},{enabled:s}),p=null==t?void 0:t.plan,x=async e=>{try{let s=await nM({orgSlug:e,docType:"standard-security-questionnaire"});(null==s?void 0:s.fileUrl)&&window.open(s.fileUrl,"_blank")}catch(e){m.ZP.error("Failed to download Security Questionnaire: ".concat(e.message))}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Standard Security Questionnaire"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"Organizations on Team Plan or above have access to our standard security questionnaire."})})]}),(0,i.jsx)(l.Lc,{children:s?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),o&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:a}),u&&(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==p?void 0:p.id)==="free"||(null==p?void 0:p.id)==="pro"?(0,i.jsx)(L(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,i.jsx)(Y.z,{type:"default",children:"Upgrade to Team"})}):(0,i.jsx)(Y.z,{type:"default",icon:(0,i.jsx)(nD.Z,{}),onClick:()=>{e&&x(e)},children:"Download Questionnaire"})})]}):(0,i.jsx)(j.Z,{resourceText:"access our security questionnaire"})})]})})},nF=()=>{let{slug:e}=(0,r.UO)(),s=(0,b.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:t,error:a,isLoading:n,isError:o,isSuccess:p}=(0,d.G)({orgSlug:e},{enabled:s}),x=null==t?void 0:t.plan,[g,f]=(0,u.useState)(!1),y=async e=>{try{let s=await nM({orgSlug:e,docType:"soc2-type-2-report"});(null==s?void 0:s.fileUrl)&&window.open(s.fileUrl,"_blank"),f(!1)}catch(e){m.ZP.error("Failed to download SOC2 report: ".concat(e.message))}};return(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"SOC2 Type 2"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"Organizations on Team Plan or above have access to our most recent SOC2 Type 2 report."})})]}),(0,i.jsxs)(l.Lc,{children:[s?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(v.Z,{className:"w-3/4"}),(0,i.jsx)(v.Z,{className:"w-1/2"})]}),o&&(0,i.jsx)(h.Z,{subject:"Failed to retrieve subscription",error:a}),p&&(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==x?void 0:x.id)==="free"||(null==x?void 0:x.id)==="pro"?(0,i.jsx)(L(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,i.jsx)(Y.z,{type:"default",children:"Upgrade to Team"})}):(0,i.jsx)(Y.z,{type:"default",icon:(0,i.jsx)(nD.Z,{}),onClick:()=>f(!0),children:"Download SOC2 Type 2 Report"})})]}):(0,i.jsx)(j.Z,{resourceText:"access our SOC2 Type 2 report"}),(0,i.jsx)(aQ.Z,{visible:g,size:"large",title:"Non-Disclosure Agreement to access Supabase's SOC2 Report",confirmLabel:"I agree",confirmLabelLoading:"Downloading",onCancel:()=>f(!1),onConfirm:()=>{e&&y(e)},children:(0,i.jsxs)("ol",{className:"list-decimal list-inside text-sm text-foreground-light pl-30",children:[(0,i.jsx)("li",{children:"The information that you are about to access is confidential."}),(0,i.jsx)("li",{children:'Your access to our SOC 2 materials is governed by confidentiality obligations contained in the agreement between Supabase, Inc ("Supabase", "we", "our" or "us") and the Supabase customer that has authorized you to access our platform to obtain this information (our "Customer").'}),(0,i.jsx)("li",{children:"You must ensure that you treat the information in our SOC 2 materials in accordance with those confidentiality obligations, as communicated to you by the Customer."}),(0,i.jsxs)("li",{children:['By clicking "I agree" below or otherwise accessing our SOC 2 materials, you:',(0,i.jsxs)("ol",{className:"list-[lower-roman] list-inside pl-4",children:[(0,i.jsx)("li",{children:"acknowledge that you have read and understood this Confidentiality Notice;"}),(0,i.jsx)("li",{children:"confirm that you have been authorized by the Customer to access this information, and your use of our SOC 2 materials is subject to the confidentiality obligations owed by the Customer to us."})]})]}),(0,i.jsx)("li",{children:"This Confidentiality Notice does not substitute or supersede any agreement between us and the Customer, or any internal rules or policies that the Customer requires you to comply with in your access to and use of confidential information. However, your failure to comply with this Confidentiality Notice may be used to determine whether the Customer has complied with its confidentiality obligations to us."})]})})]})]})},nY=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"HIPAA"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,i.jsx)("p",{children:"This is only for HIPAA requests. Please ignore this if you already have HIPAA enabled."}),(0,i.jsx)("p",{children:"Organizations on the Team Plan or above are eligible for a paid HIPAA compliance add-on. You can submit a request here and we will get back to you on the pricing and process for your use case."}),(0,i.jsx)("p",{children:"Organizations on the Free or Pro Plan can also submit a request for HIPAA. Note that you are still required to upgrade to the Team Plan after your request is approved."})]})]}),(0,i.jsx)(l.Lc,{children:(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://forms.supabase.com/hipaa2",target:"_blank",rel:"noreferrer noopener",children:(0,i.jsx)(Y.z,{type:"default",iconRight:(0,i.jsx)(eI.Z,{}),children:"Request HIPAA"})})})})]})}),nG=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{id:"dpa",children:(0,i.jsx)(nR,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"tia",children:(0,i.jsx)(nL,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"soc2",children:(0,i.jsx)(nF,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"hipaa",children:(0,i.jsx)(nY,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"security-questionnaire",children:(0,i.jsx)(nU,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{children:(0,i.jsx)(l.jX,{children:(0,i.jsxs)("p",{className:"sticky space-y-6 top-12 text-sm text-foreground-light m-0 whitespace-nowrap",children:[(0,i.jsx)(L(),{href:"/support/new",className:"hover:underline",children:"Submit a support request"})," ","if you require additional documents for financial or tax reasons, such as a W-9 form."]})})})]})},46666:function(e,s,t){t.d(s,{E:function(){return d}});var a=t(52322),n=t(2784),i=t(10012),r=t(19869),l=t(12934),o=t(32079);let d=e=>{let{options:s=[],activeOptions:t=[],valueKey:d,labelKey:c,name:u="default",variant:m="rectangular",onSaveFilters:h,disabled:p}=e,[x,g]=(0,n.useState)(!1),[j,v]=(0,n.useState)([]),f=t.map(e=>{let t=s.find(s=>s[d]===e);return t&&t[c]?t[c]:""});return(0,a.jsx)(i.Z,{side:"bottom",align:"start",disabled:p,open:x,onOpenChange:()=>g(!x),header:(0,a.jsxs)("div",{className:"prose text-xs",children:["Select ",u.toLowerCase()]}),overlay:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"space-y-4 min-w-[170px]",children:(0,a.jsx)(r.x,{className:s.length>7?"h-[205px]":"",children:(0,a.jsx)(l.Z.Group,{className:"px-3 py-3",id:"projects",onChange:e=>{let s=e.target.value;j.includes(s)?v(j.filter(e=>e!==s)):v(j.concat(s))},options:s.map(e=>({value:e[d],label:e[c],defaultChecked:t.includes(e[d])}))})})}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,a.jsx)(o.z,{size:"tiny",type:"default",onClick:()=>{h([]),g(!1)},children:"Clear"}),(0,a.jsx)(o.z,{type:"primary",onClick:()=>{h(j),g(!1)},children:"Save"})]})]}),children:(0,a.jsx)(o.z,{asChild:!0,type:t.length>0?"default":"dashed",onClick:()=>g(!1),className:"rounded"===m?"rounded-full":"",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:u}),t.length>0&&(0,a.jsx)("span",{className:"mr-1",children:":"}),t.length>=3?(0,a.jsxs)("span",{children:[f[0]," and ",t.length-1," others"]}):t.length>0?(0,a.jsx)("span",{children:f.join(", ")}):null]})})})}},67873:function(e,s,t){t.d(s,{DO:function(){return d},Tq:function(){return l},by:function(){return r},iL:function(){return o},m9:function(){return c}});var a=t(52322),n=t(2784),i=t(54383);let r=e=>{let{children:s,header:t,footer:n}=e;return(0,a.jsxs)(l,{children:[t&&(0,a.jsx)(o,{children:t}),(0,a.jsx)(d,{className:"divide-y",children:s}),n&&(0,a.jsx)(c,{children:n})]})},l=(0,n.forwardRef)((e,s)=>{let{children:t,...n}=e;return(0,a.jsx)("div",{ref:s,...n,className:(0,i.cn)("bg-surface-100 border overflow-hidden rounded-md shadow",n.className),children:t})});l.displayName=l.displayName;let o=(0,n.forwardRef)((e,s)=>{let{children:t,...n}=e;return(0,a.jsx)("div",{ref:s,...n,className:(0,i.cn)("border-default border-b px-8 py-4",n.className),children:t})});o.displayName=o.displayName;let d=(0,n.forwardRef)((e,s)=>{let{children:t,...n}=e;return(0,a.jsx)("div",{ref:s,...n,className:(0,i.cn)("divide-border flex flex-col gap-0",n.className),children:t})});d.displayName=d.displayName;let c=(0,n.forwardRef)((e,s)=>{let{children:t,...n}=e;return(0,a.jsx)("div",{ref:s,...n,className:(0,i.cn)("border-t",n.className),children:t})});c.displayName=c.displayName},4787:function(e,s,t){t.d(s,{B4:function(){return o},S0:function(){return r},hj:function(){return i}});var a=t(52322),n=t(2784);let i=e=>{let{children:s,id:t,header:n,disabled:i,className:r}=e;return(0,a.jsxs)("div",{id:t,className:["grid grid-cols-12 gap-6 px-8 py-8","".concat(i?" opacity-30":" opacity-100"),"".concat(r)].join(" "),children:[n,s]})},r=e=>{let{children:s,className:t="",description:n}=e;return void 0!==n?(0,a.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(t),children:[(0,a.jsx)("label",{className:"text-foreground text-sm",children:s}),n]}):(0,a.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(t),children:s})},l=()=>(0,a.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,a.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,a.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,a.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),o=e=>{let{children:s,loading:t=!0,fullWidth:i,className:r}=e;return(0,a.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(i&&"!col-span-12","\n        ").concat(r,"\n      "),children:t?n.Children.map(s,()=>(0,a.jsx)(l,{})):s})}},61531:function(e,s,t){var a=t(52322),n=t(39097),i=t.n(n),r=t(2784),l=t(84797),o=t(4582),d=t(32079),c=t(32830);s.Z=e=>{let{icon:s,title:t,description:n,url:u,urlLabel:m="Read more",defaultVisibility:h=!1,hideCollapse:p=!1,button:x,className:g="",block:j=!1}=e,[v,f]=(0,r.useState)(h);return(0,a.jsx)("div",{className:"".concat(j?"block w-full":"","\n      block w-full rounded border bg-surface-200 py-3 ").concat(g),children:(0,a.jsxs)("div",{className:"flex flex-col px-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[s&&(0,a.jsx)("span",{className:"text-foreground-lighter",children:s}),(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsx)("h5",{className:"text-sm text-foreground",children:t})})]}),n&&!p?(0,a.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>f(!v),children:v?(0,a.jsx)(l.Z,{size:14,strokeWidth:1.5}):(0,a.jsx)(o.Z,{size:14,strokeWidth:1.5})}):null]}),(n||u||x)&&(0,a.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(v?"mt-3":""),style:{maxHeight:v?500:0},children:[(0,a.jsx)("div",{className:"text-foreground-light text-sm",children:n}),u&&(0,a.jsx)("div",{children:(0,a.jsx)(d.z,{asChild:!0,type:"default",icon:(0,a.jsx)(c.Z,{}),children:(0,a.jsx)(i(),{href:u,target:"_blank",rel:"noreferrer",children:m})})}),x&&(0,a.jsx)("div",{children:x})]})]})})}},29887:function(e,s,t){t.d(s,{S:function(){return o}});var a=t(48228),n=t(62202),i=t(88354),r=t(99248);async function l(e){let{projectRef:s,orgSlug:t,reasons:a,message:n,exitAction:l}=e,o=await (0,i.v_)("".concat(r.T5,"/feedback/downgrade"),{...void 0!==s&&{projectRef:s},...void 0!==t&&{orgSlug:t},reasons:a,additionalFeedback:n,exitAction:l});if(o.error)throw o.error;return o}let o=function(){let{onError:e,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.D)(e=>l(e),{async onError(s,t,a){void 0===e?n.ZP.error("Failed to submit exit survey: ".concat(s.message)):e(s,t,a)},...s})}},17436:function(e,s,t){t.d(s,{Y:function(){return a}});let a={overdueInvoices:()=>["invoices","overdue"],invoice:e=>["invoice",e],list:(e,s)=>["invoices",e,s],count:e=>["invoices",e,"count"],projectInvoices:(e,s)=>["invoices",e,s],projectInvoicesCount:e=>["invoices",e,"count"],orgUpcomingPreview:e=>["invoices",e,"upcoming-preview"]}},3507:function(e,s,t){t.d(s,{O:function(){return a}});let a={rolesV2:e=>["organization-members",e,"roles-v2"],invitations:e=>["organization-members",e,"invitations"],invitation:(e,s)=>["organization-members",e,"invitations",s],token:(e,s)=>["organization-members",e,"token",s]}},78388:function(e,s,t){t.d(s,{T:function(){return c}});var a=t(85945),n=t(48228),i=t(62202),r=t(31696),l=t(28414),o=t(91160);async function d(e){let{name:s,kind:t,size:a,tier:n,payment_method:i}=e,{data:l,error:o}=await (0,r.v_)("/platform/organizations",{body:{name:s,kind:t,size:a,tier:n,payment_method:i}});return o&&(0,r.S3)(o),l}let c=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,a.NL)();return(0,n.D)(e=>d(e),{async onSuccess(s,t,a){await Promise.all([r.invalidateQueries(o.O.list()),r.invalidateQueries(l.F.list())]),await (null==e?void 0:e(s,t,a))},async onError(e,t,a){void 0===s?i.Am.error("Failed to create organization: ".concat(e.message)):s(e,t,a)},...t})}},11774:function(e,s,t){t.d(s,{Wu:function(){return r}});var a=t(9162),n=t(4741);let i=(0,a.sj)({panelKey:void 0,setPanelKey:e=>{i.panelKey=e}}),r=e=>(0,n.R)(i,e)},12934:function(e,s,t){t.d(s,{Z:function(){return c}});var a=t(52322),n=t(2784),i=t(25001),r=t(46318),l=t(70780);let o=(0,n.createContext)({parentCallback:e=>{},parentSize:""});function d(e){let{className:s,id:t="",name:n="",label:i,afterLabel:d,beforeLabel:c,description:u,checked:m,value:h,onChange:p,onBlur:x,size:g="medium",disabled:j=!1,...v}=e,{formContextOnChange:f,values:y,handleBlur:b}=(0,l.G)(),N=(0,r.Z)("checkbox");return(0,a.jsx)(o.Consumer,{children:e=>{let{parentCallback:r,parentSize:l}=e,o=t||n||(i?i.toLowerCase().replace(/^[^A-Z0-9]+/gi,"").replace(/ /g,"-"):void 0);g=l||g;let w=n||o,S=null!=m?m:void 0,_=[N.container];return s&&_.push(s),y&&void 0===m&&(S=y[t||n]),(0,a.jsxs)("div",{className:_.join(" "),children:[(0,a.jsx)("input",{id:o,name:w,type:"checkbox",className:[N.base,N.size[g]].join(" "),onChange:function(e){r&&r(e),p&&p(e),f&&f(e)},onBlur:function(e){b&&setTimeout(()=>{b(e)},100),x&&x(e)},checked:S,value:h||o,disabled:j,...v}),(0,a.jsxs)("label",{className:[N.label.base,N.label[g]].join(" "),htmlFor:o,children:[(0,a.jsxs)("span",{children:[c&&(0,a.jsx)("span",{className:[N.label_before.base,N.label_before[g]].join(" "),children:c}),i,d&&(0,a.jsx)("span",{className:[N.label_after.base,N.label_after[g]].join(" "),children:d})]}),u&&(0,a.jsx)("p",{className:[N.description.base,N.description[g]].join(" "),children:u})]})]})}})}d.Group=function(e){let{id:s,layout:t="vertical",error:n,descriptionText:l,label:c,afterLabel:u,beforeLabel:m,labelOptional:h,children:p,className:x,options:g,onChange:j,size:v="medium"}=e,f=(0,r.Z)("checkbox");return(0,a.jsx)(i.l,{label:c,afterLabel:u,beforeLabel:m,labelOptional:h,layout:t,id:s,error:n,descriptionText:l,className:x,size:v,children:(0,a.jsx)(o.Provider,{value:{parentCallback:e=>{j&&j(e)},parentSize:v},children:(0,a.jsx)("div",{className:f.group,children:g?g.map(e=>(0,a.jsx)(d,{id:e.id,value:e.value,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,checked:e.checked,name:e.name,description:e.description,defaultChecked:e.defaultChecked},e.id)):p})})})};var c=d},11992:function(e,s,t){var a=t(52322),n=t(69557);t(2784);var i=t(46318);let r=e=>{let{open:s,children:t,className:i,...r}=e;return(0,a.jsx)(n.fC,{asChild:r.asChild,defaultOpen:r.defaultOpen,open:s,onOpenChange:r.onOpenChange,disabled:r.disabled,className:i,children:t})};r.Trigger=function(e){let{children:s,asChild:t}=e;return(0,a.jsx)(n.xz,{asChild:t,children:s})},r.Content=function(e){let{asChild:s,children:t,className:r}=e,l=(0,i.Z)("collapsible");return(0,a.jsx)(n.VY,{asChild:s,className:[l.content,r].join(" "),children:t})},s.ZP=r},20758:function(e,s,t){var a=t(52322);t(2784);var n=t(7342),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},74559:function(e,s,t){var a=t(52322);t(2784);var n=t(49670),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},62795:function(e,s,t){var a=t(52322);t(2784);var n=t(70177),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},49639:function(e,s,t){var a=t(52322);t(2784);var n=t(19804),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},89689:function(e,s,t){var a=t(52322);t(2784);var n=t(5152),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},82:function(e,s,t){var a=t(52322);t(2784);var n=t(13667),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},25633:function(e,s,t){var a=t(52322);t(2784);var n=t(70523),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},62134:function(e,s,t){var a=t(52322);t(2784);var n=t(59461),i=t(59073);s.Z=function(e){return(0,a.jsx)(i.Z,{icon:n.Z,...e})}},62949:function(e,s,t){t.d(s,{Bw:function(){return f},DI:function(){return h},Ph:function(){return m},Ql:function(){return b},U$:function(){return N},i4:function(){return g},ki:function(){return p},n5:function(){return y}});var a=t(52322),n=t(38947),i=t(78232),r=t(20670),l=t(76141),o=t(2784),d=t(54383),c=t(10929),u=t(75109);let m=n.fC,h=n.ZA,p=n.B4,x=(0,c.j)("",{variants:{size:{...u.Ld}},defaultVariants:{size:u.Rc}}),g=o.forwardRef((e,s)=>{let{className:t,children:r,size:l,...o}=e;return(0,a.jsxs)(n.xz,{ref:s,className:(0,d.cn)("flex w-full items-center justify-between rounded-md border border-button bg-button text-xs ring-offset-background-control placeholder:text-foreground-muted focus:outline-none ring-border-control focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",x({size:l}),t),...o,children:[r,(0,a.jsx)(n.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 text-foreground-muted"})})]})});g.displayName=n.xz.displayName;let j=o.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(n.u_,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",t),...i,children:(0,a.jsx)(r.Z,{className:"h-4 w-4"})})});j.displayName=n.u_.displayName;let v=o.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.$G,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",t),...r,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});v.displayName=n.$G.displayName;let f=o.forwardRef((e,s)=>{let{className:t,children:i,position:r="popper",...l}=e;return(0,a.jsx)(n.h_,{children:(0,a.jsxs)(n.VY,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-overlay text-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...l,children:[(0,a.jsx)(j,{}),(0,a.jsx)(n.l_,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,a.jsx)(v,{})]})})});f.displayName=n.VY.displayName;let y=o.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(n.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-xs text-foreground-lighter/75 uppercase tracking-wider font-mono",t),...i})});y.displayName=n.__.displayName;let b=o.forwardRef((e,s)=>{let{className:t,children:i,...r}=e;return(0,a.jsxs)(n.ck,{ref:s,className:(0,d.cn)("group","relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-xs outline-none focus:bg-overlay-hover text-foreground-light focus:text-foreground data-[state=checked]:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{className:"h-3.5 w-3.5 bg-foreground rounded-full flex justify-center items-center",children:(0,a.jsx)(l.Z,{className:"h-2 w-2 text-background-overlay",strokeWidth:6})})}),(0,a.jsx)(n.eT,{children:i})]})});b.displayName=n.ck.displayName;let N=o.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(n.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-border-overlay",t),...i})});N.displayName=n.Z0.displayName},7117:function(e,s,t){t.d(s,{DN:function(){return j},Ei:function(){return y},FF:function(){return v},Tu:function(){return g},bC:function(){return f},sw:function(){return c},ue:function(){return x},yo:function(){return d}});var a=t(52322),n=t(70241),i=t(10929),r=t(2784),l=t(8609),o=t(54383);let d=n.fC;n.xz;let c=n.x8,u=(0,i.j)("fixed inset-0 z-50 flex",{variants:{side:{top:"items-start",bottom:"items-end",left:"justify-start",right:"justify-end"}},defaultVariants:{side:"right"}}),m=e=>{let{side:s,children:t,...i}=e;return(0,a.jsx)(n.h_,{...i,children:(0,a.jsx)("div",{className:u({side:s}),children:t})})};m.displayName=n.h_.displayName;let h=r.forwardRef((e,s)=>{let{className:t,children:i,...r}=e;return(0,a.jsx)(n.aV,{className:(0,o.cn)("fixed inset-0 z-50 bg-alternative/90 backdrop-blur-sm transition-all duration-100 data-[state=closed]:animate-out data-[state=closed]:fade-out data-[state=open]:fade-in",t),...r,ref:s})});h.displayName=n.aV.displayName;let p=(0,i.j)("fixed z-50 scale-100 gap-4 bg-studio opacity-100 shadow-lg",{variants:{side:{top:"animate-in slide-in-from-top w-full duration-300 border-b",bottom:"animate-in slide-in-from-bottom w-full duration-300 border-t",left:"animate-in slide-in-from-left h-full duration-300 border-r",right:"animate-in slide-in-from-right h-full duration-300 border-l"},size:{content:"",default:"",sm:"",lg:"",xl:"",xxl:"",full:""}},compoundVariants:[{side:["top","bottom"],size:"content",class:"max-h-screen"},{side:["top","bottom"],size:"default",class:"h-1/3"},{side:["top","bottom"],size:"sm",class:"h-1/4"},{side:["top","bottom"],size:"lg",class:"h-1/2"},{side:["top","bottom"],size:"xl",class:"h-5/6"},{side:["top","bottom"],size:"full",class:"h-screen"},{side:["right","left"],size:"content",class:"max-w-screen"},{side:["right","left"],size:"default",class:"w-1/3"},{side:["right","left"],size:"sm",class:"w-1/4"},{side:["right","left"],size:"lg",class:"w-1/2"},{side:["right","left"],size:"xl",class:"w-4/6"},{side:["right","left"],size:"xxl",class:"w-5/6"},{side:["right","left"],size:"full",class:"w-screen"}],defaultVariants:{side:"right",size:"default"}}),x=r.forwardRef((e,s)=>{let{side:t,size:i,className:r,children:d,showClose:c=!0,...u}=e;return(0,a.jsxs)(m,{side:t,children:[(0,a.jsx)(h,{}),(0,a.jsxs)(n.VY,{ref:s,className:(0,o.cn)(p({side:t,size:i}),r),...u,children:[d,c?(0,a.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]}):null]})]})});x.displayName=n.VY.displayName;let g=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("px-5 py-4 text-center sm:text-left border-b",s),...t})};g.displayName="SheetHeader";let j=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("px-content py-content",s),...t})};j.displayName="SheetSection";let v=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("px-5 py-3 border-t w-full","flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};v.displayName="SheetFooter";let f=r.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(n.Dx,{ref:s,className:(0,o.cn)("text-base text-foreground",t),...i})});f.displayName=n.Dx.displayName;let y=r.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(n.dk,{ref:s,className:(0,o.cn)("text-sm text-foreground-muted",t),...i})});y.displayName=n.dk.displayName}}]);