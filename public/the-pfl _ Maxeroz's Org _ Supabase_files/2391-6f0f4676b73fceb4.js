(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2391],{65338:function(e){e.exports=function(e,r,t,n){for(var i=-1,s=null==e?0:e.length;++i<s;){var o=e[i];r(n,o,t(o),e)}return n}},12825:function(e,r,t){var n=t(24303);e.exports=function(e,r,t,i){return n(e,function(e,n,s){r(i,e,t(e),s)}),i}},13940:function(e,r,t){var n=t(83043);e.exports=function(e,r,t){"__proto__"==r&&n?n(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}},24303:function(e,r,t){var n=t(26548),i=t(92019)(n);e.exports=i},15308:function(e,r,t){var n=t(55463)();e.exports=n},26548:function(e,r,t){var n=t(15308),i=t(90249);e.exports=function(e,r){return e&&n(e,r,i)}},36740:function(e,r,t){var n=t(65338),i=t(12825),s=t(68286),o=t(86152);e.exports=function(e,r){return function(t,a){var c=o(t)?n:i,l=r?r():{};return c(t,e,s(a,2),l)}}},92019:function(e,r,t){var n=t(67878);e.exports=function(e,r){return function(t,i){if(null==t)return t;if(!n(t))return e(t,i);for(var s=t.length,o=r?s:-1,a=Object(t);(r?o--:++o<s)&&!1!==i(a[o],o,a););return t}}},55463:function(e){e.exports=function(e){return function(r,t,n){for(var i=-1,s=Object(r),o=n(r),a=o.length;a--;){var c=o[e?a:++i];if(!1===t(s[c],c,s))break}return r}}},83043:function(e,r,t){var n=t(38761),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},3440:function(e,r,t){var n=t(13940),i=t(36740),s=Object.prototype.hasOwnProperty,o=i(function(e,r,t){s.call(e,t)?e[t].push(r):n(e,t,[r])});e.exports=o},3610:function(e,r,t){"use strict";t.d(r,{l:function(){return E}});var n=t(52322),i=t(3440),s=t.n(i),o=t(39097),a=t.n(o),c=t(56006),l=t(89777),u=t(61660),d=t(9915),g=t(36492),f=t(31696),p=t(17436);async function h(e){let{data:r,error:t}=await (0,f.U2)("/platform/stripe/invoices/overdue",{signal:e});return t&&(0,f.S3)(t),r}let v=function(){let{enabled:e=!0,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,g.a)(p.Y.overdueInvoices(),e=>{let{signal:r}=e;return h(r)},{enabled:e,...r})};var x=t(31310),j=t(96551),m=t(26198),y=t(43683),b=t(40654),_=t(99248),w=t(82955),N=t(89404),L=t(54383),C=t(32079),Z=t(40412),S=t(60008),E=e=>{let{search:r,rewriteHref:t,filterStatus:i,resetFilterStatus:o}=e,{data:a,isLoading:c,isSuccess:u}=(0,x.tl)(),{data:d,isLoading:g,isSuccess:f,isError:p,error:h}=(0,m.Sy)(),{isLoading:b,isError:w,error:N}=(0,j.j)(),{data:Z}=(0,y.q)(),{data:E}=v({enabled:_.Qy}),I=s()(d,"organization_id"),k=!!_.Qy&&b,A=void 0!==i&&2!==i.length,T=r.length>0&&f&&0===d.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())||e.ref.includes(r.toLowerCase())).length,O=A&&f&&0===d.filter(e=>i.includes(e.status)).length;return c?(0,n.jsxs)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:[(0,n.jsx)(S.Z,{}),(0,n.jsx)(S.Z,{})]}):T?(0,n.jsx)(l.Z,{searchString:r}):O?(0,n.jsxs)("div",{className:(0,L.cn)("bg-surface-100 border border-default px-6 py-4 rounded flex items-center justify-between"),children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:0===i.length?"No projects found":"No ".concat("INACTIVE"===i[0]?"paused":"active"," projects found")}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Your search for projects with the specified status did not return any results"})]}),void 0!==o&&(0,n.jsx)(C.z,{type:"default",onClick:()=>o(),children:"Reset filter"})]}):u&&a&&(null==a?void 0:a.length)>0?(0,n.jsx)(n.Fragment,{children:null==a?void 0:a.map(e=>(0,n.jsx)(P,{organization:e,projects:I[e.id],overdueInvoices:(null!=E?E:[]).filter(r=>r.organization_id===e.id),resourceWarnings:null!=Z?Z:[],rewriteHref:t,isLoadingPermissions:k,isErrorPermissions:w,permissionsError:N,isLoadingProjects:g,isErrorProjects:p,projectsError:h,search:r,filterStatus:i},e.slug))}):(0,n.jsx)(z,{slug:""})};let P=e=>{let{organization:r,projects:t,overdueInvoices:i,resourceWarnings:s,isLoadingPermissions:o,isErrorPermissions:l,permissionsError:g,isLoadingProjects:f,isErrorProjects:p,projectsError:h,rewriteHref:v,search:x,filterStatus:j}=e,m=!t||0===t.length,y=[...t||[]].sort((e,r)=>e.name.localeCompare(r.name)),b=x.length>0?y.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())||e.ref.includes(x.toLowerCase())):y,N=void 0!==j?j.includes(_.S.ACTIVE_HEALTHY)?b:b.filter(e=>j.includes(e.status)):b,{data:L}=(0,d.T)({orgSlug:null==r?void 0:r.slug}),{data:E}=(0,u.q)({organizationId:null==r?void 0:r.id}),P=null==E?void 0:E.map(e=>{var r,t,n,i,s;return{id:String(e.id),added_by:{id:String(null===(r=e.user)||void 0===r?void 0:r.id),primary_email:null!==(i=null===(t=e.user)||void 0===t?void 0:t.primary_email)&&void 0!==i?i:"",username:null!==(s=null===(n=e.user)||void 0===n?void 0:n.username)&&void 0!==s?s:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}}}),I=null==L?void 0:L.filter(e=>"Vercel"===e.integration.name).flatMap(e=>e.connections);return(x.length>0||void 0!==j&&2!==j.length)&&0===N.length?null:(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex space-x-4 items-center",children:[(0,n.jsx)("h4",{className:"text-lg flex items-center",children:r.name}),!!i.length&&(0,n.jsx)("div",{children:(0,n.jsx)(C.z,{asChild:!0,type:"danger",children:(0,n.jsx)(a(),{href:"/org/".concat(r.slug,"/invoices"),children:"Outstanding Invoices"})})}),(null==r?void 0:r.restriction_status)==="grace_period"&&(0,n.jsx)("div",{children:(0,n.jsx)(C.z,{asChild:!0,type:"warning",children:(0,n.jsx)(a(),{href:"/org/".concat(r.slug,"/billing"),children:"Grace Period"})})}),(null==r?void 0:r.restriction_status)==="grace_period_over"&&(0,n.jsx)("div",{children:(0,n.jsx)(C.z,{asChild:!0,type:"warning",children:(0,n.jsx)(a(),{href:"/org/".concat(r.slug,"/billing"),children:"Grace Period Over"})})}),(null==r?void 0:r.restriction_status)==="restricted"&&(0,n.jsx)("div",{children:(0,n.jsx)(C.z,{asChild:!0,type:"danger",children:(0,n.jsx)(a(),{href:"/org/".concat(r.slug,"/billing"),children:"Services Restricted"})})})]}),o||f?(0,n.jsxs)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:[(0,n.jsx)(S.Z,{}),(0,n.jsx)(S.Z,{})]}):(0,n.jsx)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:l?(0,n.jsx)("div",{className:"col-span-3",children:(0,n.jsx)(c.Z,{subject:"Failed to retrieve permissions for your account",error:g})}):p?(0,n.jsx)("div",{className:"col-span-3",children:(0,n.jsx)(c.Z,{subject:"Failed to retrieve projects under ".concat(name),error:h})}):m?(0,n.jsx)(z,{slug:r.slug}):null==N?void 0:N.map(e=>(0,n.jsx)(Z.Z,{project:e,rewriteHref:v?v(e.ref):void 0,resourceWarnings:s.find(r=>r.project===e.ref),githubIntegration:null==P?void 0:P.find(r=>r.supabase_project_ref===e.ref),vercelIntegration:null==I?void 0:I.find(r=>r.supabase_project_ref===e.ref)},(0,w.pZ)(5)))})]},r.slug)},z=e=>{let{slug:r}=e,t=(0,b.N)("projects:create");return(0,n.jsxs)("div",{className:"col-span-4 space-y-4 rounded-lg border border-dashed p-6 text-center",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{children:"No projects"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Get started by creating a new project."})]}),t&&(0,n.jsx)(C.z,{asChild:!0,icon:(0,n.jsx)(N.Z,{}),children:(0,n.jsx)(a(),{href:"/new/".concat(r),children:"New Project"})})]})}},89777:function(e,r,t){"use strict";var n=t(52322),i=t(54383),s=t(32079);r.Z=e=>{let{searchString:r,onResetFilter:t,className:o}=e;return(0,n.jsxs)("div",{className:(0,i.cn)("bg-surface-100 border border-default px-6 py-4 rounded flex items-center justify-between",o),children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',r,'" did not return any results']})]}),void 0!==t&&(0,n.jsx)(s.z,{type:"default",onClick:()=>t(),children:"Reset filter"})]})}},17436:function(e,r,t){"use strict";t.d(r,{Y:function(){return n}});let n={overdueInvoices:()=>["invoices","overdue"],invoice:e=>["invoice",e],list:(e,r)=>["invoices",e,r],count:e=>["invoices",e,"count"],projectInvoices:(e,r)=>["invoices",e,r],projectInvoicesCount:e=>["invoices",e,"count"],orgUpcomingPreview:e=>["invoices",e,"upcoming-preview"]}},70295:function(e,r,t){"use strict";t.d(r,{S:function(){return o},V:function(){return a}});var n=t(36492),i=t(97295),s=t(71392);async function o(){let{error:e,data:r}=await i.I8.mfa.getAuthenticatorAssuranceLevel();if(e)throw e;return r}let a=function(){let{enabled:e=!0,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.a)(s.c.aaLevel(),()=>o(),{staleTime:18e5,...r})}},99445:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n={usage:e=>["projects",e,"usage"],orgUsage:(e,r,t,n)=>["organizations",e,"usage",r,t,n],resourceWarnings:()=>["projects","resource-warnings"]}},43683:function(e,r,t){"use strict";t.d(r,{q:function(){return c}});var n=t(36492),i=t(99959),s=t(31696),o=t(99445);async function a(e){let{data:r,error:t}=await (0,s.U2)("/platform/projects-resource-warnings",{signal:e});return t&&(0,s.S3)(t),r}let c=function(){let{enabled:e=!0,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.a)(o.Z.resourceWarnings(),e=>{let{signal:r}=e;return a(r)},{enabled:i.Qy&&e,staleTime:18e5,...r})}},3373:function(e,r,t){"use strict";t.d(r,{Q:function(){return d}});var n=t(52322),i=t(5632),s=t(2784),o=t(62202),a=t(96551),c=t(70295),l=t(33750),u=t(99248);function d(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useHighestAAL:!0};if(!u.Qy)return e;let t=t=>{let u=(0,i.useRouter)(),{isLoading:d,session:g}=(0,l.aC)(),{isLoading:f,data:p}=(0,c.V)({onError(e){o.ZP.error("Failed to fetch authenticator assurance level: ".concat(e.message,". Try refreshing your browser, or reach out to us via a support ticket if the issue persists"))}});(0,a.j)({onError(e){o.ZP.error("Failed to fetch permissions: ".concat(e.message,". Try refreshing your browser, or reach out to us via a support ticket if the issue persists"))}});let h=!!g,v=!d&&!f;return(0,s.useEffect)(()=>{let e=!r.useHighestAAL||(null==p?void 0:p.currentLevel)===(null==p?void 0:p.nextLevel);if(v&&(!h||!e)){let e=new URLSearchParams(location.search),r=location.pathname;r=r.replace("/dashboard",""),e.set("returnTo",r),u.push("/sign-in?".concat(e.toString()))}},[g,d,u,p,v,h]),(0,n.jsx)(e,{...t})};return t.displayName="withAuth(".concat(e.displayName,")"),"getLayout"in e&&"function"==typeof e.getLayout&&(t.getLayout=e.getLayout),t}},89404:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(52186).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}}]);